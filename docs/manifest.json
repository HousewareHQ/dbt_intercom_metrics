{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v5.json", "dbt_version": "1.1.1", "generated_at": "2022-07-05T12:22:55.790172Z", "invocation_id": "bfcb0a1e-3b21-4893-a31a-980ab48d7b99", "env": {}, "project_id": "01b94640821fca5324c7f668d43e84ea", "user_id": "d7b0c1e1-cc6f-47cb-b495-16a6a0fac84b", "send_anonymous_usage_stats": true, "adapter_type": "snowflake"}, "nodes": {"model.intercom_metrics.intercom__main_conversations": {"raw_sql": "with conversation_history as (\r\n    select *\r\n    from {{ var(\"conversation_history\") }}\r\n)\r\n\r\nselect *,\r\n    (case when conversation_history.conversation_rating_value > {{var('good_rating_threshold',5)}} then 1 else 0 end) as is_conversation_rating_positive,\r\n    (case when conversation_history.state = 'closed' then 1 else 0 end) as is_conversation_closed,\r\n    (DATEDIFF(minute,first_contact_reply_created_at, updated_at)) as reply_time_in_minutes,\r\n    (reply_time_in_minutes/60) as reply_time_in_hours\r\nfrom conversation_history", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.intercom_source.stg_intercom__conversation_history"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "intercom__main_conversations"], "unique_id": "model.intercom_metrics.intercom__main_conversations", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "intercom__main_conversations.sql", "original_file_path": "models\\intercom__main_conversations.sql", "name": "intercom__main_conversations", "alias": "intercom__main_conversations", "checksum": {"name": "sha256", "checksum": "178efd0f55d7697a95ac8376b42c80d3d314f6890b0ba4ef9a4a7297a4369d61"}, "tags": [], "refs": [["stg_intercom__conversation_history"]], "sources": [], "description": "Intercom conversations data enriched with response time and conversation status", "columns": {"conversation_id": {"name": "conversation_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_id": {"name": "assignee_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_type": {"name": "assignee_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_value": {"name": "conversation_rating_value", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_remark": {"name": "conversation_rating_remark", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_created_at": {"name": "first_contact_reply_created_at", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_type": {"name": "first_contact_reply_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "is_read": {"name": "is_read", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_id": {"name": "source_author_id", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_type": {"name": "source_author_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_delivered_as": {"name": "source_delivered_as", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_type": {"name": "source_type", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_subject": {"name": "source_subject", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "state": {"name": "state", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "waiting_since": {"name": "waiting_since", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "snoozed_until": {"name": "snoozed_until", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_name": {"name": "sla_name", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_status": {"name": "sla_status", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_is_positive": {"name": "conversation_rating_is_positive", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_is_closed": {"name": "conversation_is_closed", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "reply_time_in_hours": {"name": "reply_time_in_hours", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\intercom__main_conversations.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.771586, "compiled_sql": "with conversation_history as (\n    select *\n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_history\n)\n\nselect *,\n    (case when conversation_history.conversation_rating_value > 5 then 1 else 0 end) as is_conversation_rating_positive,\n    (case when conversation_history.state = 'closed' then 1 else 0 end) as is_conversation_closed,\n    (DATEDIFF(minute,first_contact_reply_created_at, updated_at)) as reply_time_in_minutes,\n    (reply_time_in_minutes/60) as reply_time_in_hours\nfrom conversation_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__main_conversations"}, "model.intercom_metrics.intercom__average_resolution_time_in_hours": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__average_resolution_time_in_hours',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__average_resolution_time_in_hours"], "unique_id": "model.intercom_metrics.intercom__average_resolution_time_in_hours", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__average_resolution_time_in_hours.sql", "original_file_path": "models\\metrics\\intercom__average_resolution_time_in_hours.sql", "name": "intercom__average_resolution_time_in_hours", "alias": "intercom__average_resolution_time_in_hours", "checksum": {"name": "sha256", "checksum": "c2874c6a8d15c69b44cb3cb5b00f73824e34c402c576c58147a9f4b0ac90206a"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__average_resolution_time_in_hours": {"name": "intercom__average_resolution_time_in_hours", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__average_resolution_time_in_hours.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7880166, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        reply_time_in_hours as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n        and source_delivered_as = 'customer_initiated'\n        and state = 'closed'\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    avg(source_query.property_to_aggregate)\n as intercom__average_resolution_time_in_hours,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__average_resolution_time_in_hours, 0) as intercom__average_resolution_time_in_hours\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__average_resolution_time_in_hours"}, "model.intercom_metrics.intercom__average_response_time_in_hours": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__average_response_time_in_hours',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__average_response_time_in_hours"], "unique_id": "model.intercom_metrics.intercom__average_response_time_in_hours", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__average_response_time_in_hours.sql", "original_file_path": "models\\metrics\\intercom__average_response_time_in_hours.sql", "name": "intercom__average_response_time_in_hours", "alias": "intercom__average_response_time_in_hours", "checksum": {"name": "sha256", "checksum": "56198f6a66b10f63bae09f5995cca0b362881a03b9bdc362d0d2f91f4dc8e12a"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__average_response_time_in_hours": {"name": "intercom__average_response_time_in_hours", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__average_response_time_in_hours.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7880166, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        reply_time_in_hours as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n        and source_delivered_as = 'customer_initiated'\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    avg(source_query.property_to_aggregate)\n as intercom__average_response_time_in_hours,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__average_response_time_in_hours, 0) as intercom__average_response_time_in_hours\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__average_response_time_in_hours"}, "model.intercom_metrics.intercom__monthly_average_ticket_volume": {"raw_sql": "-- depends_on: {{ ref('intercom__monthly_ticket_volume') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_average_ticket_volume',\r\n    grain='year',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__monthly_ticket_volume", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_average_ticket_volume"], "unique_id": "model.intercom_metrics.intercom__monthly_average_ticket_volume", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_average_ticket_volume.sql", "original_file_path": "models\\metrics\\intercom__monthly_average_ticket_volume.sql", "name": "intercom__monthly_average_ticket_volume", "alias": "intercom__monthly_average_ticket_volume", "checksum": {"name": "sha256", "checksum": "c11ba2a913975385ba5667e7a42344eb81a914a50dc8aaa7898755b9040d71b4"}, "tags": [], "refs": [["intercom__monthly_ticket_volume"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Average number of tickets recieved every month", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_average_ticket_volume": {"name": "intercom__monthly_average_ticket_volume", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_average_ticket_volume.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.771586, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__monthly_ticket_volume\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(period as date)) as date) as date_day,\n        \n        intercom__monthly_ticket_volume as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__monthly_ticket_volume\n    where 1=1\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_year as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    avg(source_query.property_to_aggregate)\n as intercom__monthly_average_ticket_volume,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_average_ticket_volume, 0) as intercom__monthly_average_ticket_volume\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_average_ticket_volume"}, "model.intercom_metrics.intercom__monthly_closed_tickets": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_closed_tickets',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_closed_tickets"], "unique_id": "model.intercom_metrics.intercom__monthly_closed_tickets", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_closed_tickets.sql", "original_file_path": "models\\metrics\\intercom__monthly_closed_tickets.sql", "name": "intercom__monthly_closed_tickets", "alias": "intercom__monthly_closed_tickets", "checksum": {"name": "sha256", "checksum": "5e6ee9e7abfaaba5ba3a97829ee4cfe57c0029f481d12e4dc909a23b7c1cf0e5"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Number of tickets closed monthly", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_closed_tickets": {"name": "intercom__monthly_closed_tickets", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_closed_tickets.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7880166, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        state as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n        and state = 'closed'\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    count(source_query.property_to_aggregate)\n as intercom__monthly_closed_tickets,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_closed_tickets, 0) as intercom__monthly_closed_tickets\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_closed_tickets"}, "model.intercom_metrics.intercom__monthly_csat_score": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_csat_score',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_csat_score"], "unique_id": "model.intercom_metrics.intercom__monthly_csat_score", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_csat_score.sql", "original_file_path": "models\\metrics\\intercom__monthly_csat_score.sql", "name": "intercom__monthly_csat_score", "alias": "intercom__monthly_csat_score", "checksum": {"name": "sha256", "checksum": "8be1c2324d1fb000d673090201be3b21da500e6ec7601a5eda8e7b5758e80ac2"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Percentage of positive ratings defining customer satisfaction score", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_csat_score": {"name": "intercom__monthly_csat_score", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_csat_score.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.771586, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        is_conversation_rating_positive as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    avg(source_query.property_to_aggregate)\n as intercom__monthly_csat_score,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_csat_score, 0) as intercom__monthly_csat_score\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_csat_score"}, "model.intercom_metrics.intercom__monthly_customer_initiated_conversations": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_customer_initiated_conversations',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_customer_initiated_conversations"], "unique_id": "model.intercom_metrics.intercom__monthly_customer_initiated_conversations", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_customer_initiated_conversations.sql", "original_file_path": "models\\metrics\\intercom__monthly_customer_initiated_conversations.sql", "name": "intercom__monthly_customer_initiated_conversations", "alias": "intercom__monthly_customer_initiated_conversations", "checksum": {"name": "sha256", "checksum": "3c20b7928f62617f6eb0947b419f62dbc9f8bb6db70165aa7c5d590b3e39149b"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Number of conversations customer have initiated monthly", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_customer_initiated_conversations": {"name": "intercom__monthly_customer_initiated_conversations", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_customer_initiated_conversations.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.771586, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        conversation_id as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n        and source_delivered_as = 'customer_initiated'\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    count(distinct source_query.property_to_aggregate)\n as intercom__monthly_customer_initiated_conversations,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_customer_initiated_conversations, 0) as intercom__monthly_customer_initiated_conversations\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_customer_initiated_conversations"}, "model.intercom_metrics.intercom__monthly_open_tickets": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_open_tickets',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_open_tickets"], "unique_id": "model.intercom_metrics.intercom__monthly_open_tickets", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_open_tickets.sql", "original_file_path": "models\\metrics\\intercom__monthly_open_tickets.sql", "name": "intercom__monthly_open_tickets", "alias": "intercom__monthly_open_tickets", "checksum": {"name": "sha256", "checksum": "c1f4fa1d51e2481f030b1d880c807dd8e9512422a504a746d854a074b6d7fc9b"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Number of monthly open tickets", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_open_tickets": {"name": "intercom__monthly_open_tickets", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_open_tickets.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7861328, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        state as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n        and state = 'open'\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    count(source_query.property_to_aggregate)\n as intercom__monthly_open_tickets,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_open_tickets, 0) as intercom__monthly_open_tickets\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_open_tickets"}, "model.intercom_metrics.intercom__monthly_resolution_rate": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_resolution_rate',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_resolution_rate"], "unique_id": "model.intercom_metrics.intercom__monthly_resolution_rate", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_resolution_rate.sql", "original_file_path": "models\\metrics\\intercom__monthly_resolution_rate.sql", "name": "intercom__monthly_resolution_rate", "alias": "intercom__monthly_resolution_rate", "checksum": {"name": "sha256", "checksum": "ee757da0e83fe594e73d0dfabcef0159e24056e9916a75b08e16e98710b90414"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Percentage of tickets closed monthly", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_resolution_rate": {"name": "intercom__monthly_resolution_rate", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_resolution_rate.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7880166, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(created_at as date)) as date) as date_day,\n        \n        is_conversation_closed as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    avg(source_query.property_to_aggregate)\n as intercom__monthly_resolution_rate,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_resolution_rate, 0) as intercom__monthly_resolution_rate\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_resolution_rate"}, "model.intercom_metrics.intercom__monthly_ticket_volume": {"raw_sql": "-- depends_on: {{ ref('intercom__main_conversations') }}\r\n\r\n\r\n\r\n\r\n{{ config(materialized = 'table') }}\r\n\r\nselect *\r\nfrom {{ metrics.metric(\r\n    metric_name='intercom__monthly_ticket_volume',\r\n    grain='month',\r\n    dimensions=[],\r\n    secondary_calculations=[]\r\n) }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.metrics.metric"], "nodes": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["intercom_metrics", "metrics", "intercom__monthly_ticket_volume"], "unique_id": "model.intercom_metrics.intercom__monthly_ticket_volume", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\intercom__monthly_ticket_volume.sql", "original_file_path": "models\\metrics\\intercom__monthly_ticket_volume.sql", "name": "intercom__monthly_ticket_volume", "alias": "intercom__monthly_ticket_volume", "checksum": {"name": "sha256", "checksum": "0484d9290262dc9b875626c699d00dad2c30437e2403b64b4d40e26c8fb7017e"}, "tags": [], "refs": [["intercom__main_conversations"], ["dbt_metrics_default_calendar"]], "sources": [], "description": "Number of intercom tickets generated monthly", "columns": {"period": {"name": "period", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "intercom__monthly_ticket_volume": {"name": "intercom__monthly_ticket_volume", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\intercom_metrics\\models\\metrics\\intercom__monthly_ticket_volume.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7880166, "compiled_sql": "-- depends_on: houseware_metrics.TRANSFORMED.intercom__main_conversations\n\n\n\n\n\n\nselect *\nfrom -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n    (with source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast(date_trunc('day', cast(CREATED_AT as date)) as date) as date_day,\n        \n        conversation_id as property_to_aggregate\n\n    from houseware_metrics.TRANSFORMED.intercom__main_conversations\n    where 1=1\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_month as period, \n        \n        \n        date_day\n     from houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar\n ),\n\nspine as (\n\n    select *\n    from spine__time\n\n),\n\njoined as (\n    select \n        spine.period,\n        \n        \n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n    count(distinct source_query.property_to_aggregate)\n as intercom__monthly_ticket_volume,\n        boolor_agg(source_query.date_day is not null) as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    \n    group by 1\n\n),\n\nbounded as (\n    select \n        *,\n         min(case when has_data then period end) over ()  as lower_bound,\n         max(case when has_data then period end) over ()  as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        \n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        \n        , coalesce(intercom__monthly_ticket_volume, 0) as intercom__monthly_ticket_volume\n        \n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by 1\n)\n\nselect * from final\n\n) metric_subq", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.intercom__monthly_ticket_volume"}, "model.intercom_source.stg_intercom__admin": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__admin_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__admin_tmp')),\n                staging_columns=get_admin_columns()\n            )\n        }}\n    from base\n),\n\nfinal as (\n    \n    select \n        id as admin_id,\n        name,\n        job_title,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_admin_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__admin_tmp", "model.intercom_source.stg_intercom__admin_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__admin"], "unique_id": "model.intercom_source.stg_intercom__admin", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__admin.sql", "original_file_path": "models\\stg_intercom__admin.sql", "name": "stg_intercom__admin", "alias": "stg_intercom__admin", "checksum": {"name": "sha256", "checksum": "e068e0e07c389132e13545c8c9b670523ef44b3bcb81522fc5905d843983c36e"}, "tags": [], "refs": [["stg_intercom__admin_tmp"], ["stg_intercom__admin_tmp"]], "sources": [], "description": "Table containing information related to admins. Admins are the teammate accounts that have access to a workspace.", "columns": {"admin_id": {"name": "admin_id", "description": "The unique identifier representing the admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "job_title": {"name": "job_title", "description": "The admin job title.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__admin.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.8804238, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__admin_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    job_title\n    \n as \n    \n    job_title\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as admin_id,\n        name,\n        job_title,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__admin"}, "model.intercom_source.stg_intercom__company_history": {"raw_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_contact_company', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__company_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__company_history_tmp')),\n                staging_columns=get_company_history_columns()\n            )\n        }}\n\n        --The below script allows for pass through columns.\n        {% if var('intercom__company_history_pass_through_columns') %}\n        ,\n        {{ var('intercom__company_history_pass_through_columns') | join (\", \")}}\n\n        {% endif %}    \n    from base\n),\n\nfinal as (\n    \n    select \n        id as company_id,\n        name as company_name,\n        website,\n        industry,\n        created_at,\n        updated_at,\n        user_count,\n        session_count,\n        monthly_spend,\n        plan_id,\n        plan_name,\n        _fivetran_deleted\n\n        --The below script allows for pass through columns.\n        {% if var('intercom__company_history_pass_through_columns') %}\n        ,\n        {{ var('intercom__company_history_pass_through_columns') | join (\", \")}}\n\n        {% endif %}\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_company_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__company_history_tmp", "model.intercom_source.stg_intercom__company_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__company_history"], "unique_id": "model.intercom_source.stg_intercom__company_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__company_history.sql", "original_file_path": "models\\stg_intercom__company_history.sql", "name": "stg_intercom__company_history", "alias": "stg_intercom__company_history", "checksum": {"name": "sha256", "checksum": "250640a13d01bfe9cd93e305a5038fd206da59e330b02e12fc40137dcf0420e8"}, "tags": [], "refs": [["stg_intercom__company_history_tmp"], ["stg_intercom__company_history_tmp"]], "sources": [], "description": "Table containing historical information about companies which have been created within Intercom.", "columns": {"company_id": {"name": "company_id", "description": "The unique identifier representing the Intercom defined company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "company_name": {"name": "company_name", "description": "The name of the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "website": {"name": "website", "description": "The website associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "industry": {"name": "industry", "description": "The defined industry the company operates in.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the company was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The time the company was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "user_count": {"name": "user_count", "description": "The total count of users associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "session_count": {"name": "session_count", "description": "The total count of conversation sessions associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "monthly_spend": {"name": "monthly_spend", "description": "How much revenue the company generates for your business.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "plan_id": {"name": "plan_id", "description": "Unique identifier representing the company plan.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "plan_name": {"name": "plan_name", "description": "The name of the plan you have associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__company_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.8960516, "compiled_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    industry\n    \n as \n    \n    industry\n    \n, \n    \n    \n    monthly_spend\n    \n as \n    \n    monthly_spend\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    plan_id\n    \n as \n    \n    plan_id\n    \n, \n    \n    \n    plan_name\n    \n as \n    \n    plan_name\n    \n, \n    \n    \n    session_count\n    \n as \n    \n    session_count\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    user_count\n    \n as \n    \n    user_count\n    \n, \n    \n    \n    website\n    \n as \n    \n    website\n    \n\n\n\n\n        --The below script allows for pass through columns.\n            \n    from base\n),\n\nfinal as (\n    \n    select \n        id as company_id,\n        name as company_name,\n        website,\n        industry,\n        created_at,\n        updated_at,\n        user_count,\n        session_count,\n        monthly_spend,\n        plan_id,\n        plan_name,\n        _fivetran_deleted\n\n        --The below script allows for pass through columns.\n        \n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_history"}, "model.intercom_source.stg_intercom__company_tag_history": {"raw_sql": "--To disable this model, set the intercom__using_company_tags variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_company_tags', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__company_tag_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__company_tag_history_tmp')),\n                staging_columns=get_company_tag_history_columns()\n            )\n        }}   \n    from base\n),\n\nfinal as (\n    \n    select \n        company_id,\n        company_updated_at,\n        tag_id,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_company_tag_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__company_tag_history_tmp", "model.intercom_source.stg_intercom__company_tag_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__company_tag_history"], "unique_id": "model.intercom_source.stg_intercom__company_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__company_tag_history.sql", "original_file_path": "models\\stg_intercom__company_tag_history.sql", "name": "stg_intercom__company_tag_history", "alias": "stg_intercom__company_tag_history", "checksum": {"name": "sha256", "checksum": "79513f96136e4111ac65ee63618b6bc14a25f87b4930b3ca0259a812dfc47d7a"}, "tags": [], "refs": [["stg_intercom__company_tag_history_tmp"], ["stg_intercom__company_tag_history_tmp"]], "sources": [], "description": "Mapping table for tags associated with companies.", "columns": {"company_id": {"name": "company_id", "description": "The unique identifier related to the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "company_updated_at": {"name": "company_updated_at", "description": "The date the company was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__company_tag_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.8960516, "compiled_sql": "--To disable this model, set the intercom__using_company_tags variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_tag_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n        \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as \n    varchar\n) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as \n    varchar\n) as \n    \n    company_id\n    \n , \n    cast(null as \n    timestamp_ntz\n) as \n    \n    company_updated_at\n    \n , \n    cast(null as \n    int\n) as \n    \n    tag_id\n    \n \n\n   \n    from base\n),\n\nfinal as (\n    \n    select \n        company_id,\n        company_updated_at,\n        tag_id,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_tag_history"}, "model.intercom_source.stg_intercom__contact_company_history": {"raw_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_contact_company', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__contact_company_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__contact_company_history_tmp')),\n                staging_columns=get_contact_company_history_columns()\n            )\n        }}   \n    from base\n),\n\nfinal as (\n    \n    select \n        company_id,\n        contact_id,\n        contact_updated_at\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_contact_company_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__contact_company_history_tmp", "model.intercom_source.stg_intercom__contact_company_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__contact_company_history"], "unique_id": "model.intercom_source.stg_intercom__contact_company_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__contact_company_history.sql", "original_file_path": "models\\stg_intercom__contact_company_history.sql", "name": "stg_intercom__contact_company_history", "alias": "stg_intercom__contact_company_history", "checksum": {"name": "sha256", "checksum": "35931001d810bc4d49d58912b4b0b2ad4e7dcaa3288246db5329cbb5514e7ae4"}, "tags": [], "refs": [["stg_intercom__contact_company_history_tmp"], ["stg_intercom__contact_company_history_tmp"]], "sources": [], "description": "Mapping table for contacts associated with companies.", "columns": {"company_id": {"name": "company_id", "description": "The unique identifier related to the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_id": {"name": "contact_id", "description": "The unique identifier related to the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_updated_at": {"name": "contact_updated_at", "description": "The time the contact was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__contact_company_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.8960516, "compiled_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_company_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_updated_at\n    \n as \n    \n    contact_updated_at\n    \n\n\n   \n    from base\n),\n\nfinal as (\n    \n    select \n        company_id,\n        contact_id,\n        contact_updated_at\n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_company_history"}, "model.intercom_source.stg_intercom__contact_history": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__contact_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__contact_history_tmp')),\n                staging_columns=get_contact_history_columns()\n            )\n        }}\n        \n        --The below script allows for pass through columns.\n        {% if var('intercom__contact_history_pass_through_columns') %}\n        ,\n        {{ var('intercom__contact_history_pass_through_columns') | join (\", \")}}\n\n        {% endif %}\n    from base\n),\n\nfinal as (\n    \n    select \n        id as contact_id,\n        admin_id,\n        created_at,\n        updated_at,\n        signed_up_at,\n        name as contact_name, \n        role as contact_role,\n        email as contact_email,\n        last_replied_at,\n        last_email_clicked_at,\n        last_email_opened_at,\n        last_contacted_at,\n        unsubscribed_from_emails as is_unsubscribed_from_emails\n\n        --The below script allows for pass through columns.\n        {% if var('intercom__contact_history_pass_through_columns') %}\n        ,\n        {{ var('intercom__contact_history_pass_through_columns') | join (\", \")}}\n\n        {% endif %}\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_contact_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__contact_history_tmp", "model.intercom_source.stg_intercom__contact_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__contact_history"], "unique_id": "model.intercom_source.stg_intercom__contact_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__contact_history.sql", "original_file_path": "models\\stg_intercom__contact_history.sql", "name": "stg_intercom__contact_history", "alias": "stg_intercom__contact_history", "checksum": {"name": "sha256", "checksum": "faf401ffbe24fb4382f67534a56a63d357ab4f405a475372d877f5e48843e679"}, "tags": [], "refs": [["stg_intercom__contact_history_tmp"], ["stg_intercom__contact_history_tmp"]], "sources": [], "description": "Table which provides historical details on contacts within Intercom.", "columns": {"contact_id": {"name": "contact_id", "description": "The unique identifier for the contact which is given by Intercom.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "admin_id": {"name": "admin_id", "description": "The unique identifier representing the admin which has been assigned ownership of the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time when the contact was created within Intercom.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The time when the contact was last updated.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "signed_up_at": {"name": "signed_up_at", "description": "The time the contact signed up.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_name": {"name": "contact_name", "description": "The name of the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_role": {"name": "contact_role", "description": "The role of the contact (will either be user or lead).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_email": {"name": "contact_email", "description": "The contacts email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_replied_at": {"name": "last_replied_at", "description": "The time when the contact last messaged in.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_contacted_at": {"name": "last_contacted_at", "description": "The time when the contact was last messaged.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_email_clicked_at": {"name": "last_email_clicked_at", "description": "The time when the contact last clicked a link in an email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_email_opened_at": {"name": "last_email_opened_at", "description": "The time when a contact last opened an email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "is_unsubscribed_from_emails": {"name": "is_unsubscribed_from_emails", "description": "Boolean indicating whether the contact has unsubscribed from emails.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__contact_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.8960516, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    admin_id\n    \n as \n    \n    admin_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_contacted_at\n    \n as \n    \n    last_contacted_at\n    \n, \n    \n    \n    last_email_clicked_at\n    \n as \n    \n    last_email_clicked_at\n    \n, \n    \n    \n    last_email_opened_at\n    \n as \n    \n    last_email_opened_at\n    \n, \n    \n    \n    last_replied_at\n    \n as \n    \n    last_replied_at\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    role\n    \n as \n    \n    role\n    \n, \n    \n    \n    signed_up_at\n    \n as \n    \n    signed_up_at\n    \n, \n    \n    \n    unsubscribed_from_emails\n    \n as \n    \n    unsubscribed_from_emails\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n        \n        --The below script allows for pass through columns.\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        id as contact_id,\n        admin_id,\n        created_at,\n        updated_at,\n        signed_up_at,\n        name as contact_name, \n        role as contact_role,\n        email as contact_email,\n        last_replied_at,\n        last_email_clicked_at,\n        last_email_opened_at,\n        last_contacted_at,\n        unsubscribed_from_emails as is_unsubscribed_from_emails\n\n        --The below script allows for pass through columns.\n        \n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_history"}, "model.intercom_source.stg_intercom__contact_tag_history": {"raw_sql": "--To disable this model, set the intercom__using_contact_tags variable within your dbt_project.yml file to False. \n{{ config(enabled=var('intercom__using_contact_tags', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__contact_tag_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__contact_tag_history_tmp')),\n                staging_columns=get_contact_tag_history_columns()\n            )\n        }} \n    from base\n),\n\nfinal as (\n    \n    select \n        contact_id,\n        contact_updated_at,\n        tag_id\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_contact_tag_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__contact_tag_history_tmp", "model.intercom_source.stg_intercom__contact_tag_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__contact_tag_history"], "unique_id": "model.intercom_source.stg_intercom__contact_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__contact_tag_history.sql", "original_file_path": "models\\stg_intercom__contact_tag_history.sql", "name": "stg_intercom__contact_tag_history", "alias": "stg_intercom__contact_tag_history", "checksum": {"name": "sha256", "checksum": "60003c48464b793e5e582bb2ea9735a84dc195789f8800f4c0ed642430684a54"}, "tags": [], "refs": [["stg_intercom__contact_tag_history_tmp"], ["stg_intercom__contact_tag_history_tmp"]], "sources": [], "description": "Mapping table for tags associated with contacts.", "columns": {"contact_id": {"name": "contact_id", "description": "The unique identifier related to the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_updated_at": {"name": "contact_updated_at", "description": "The date the contact was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__contact_tag_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.8960516, "compiled_sql": "--To disable this model, set the intercom__using_contact_tags variable within your dbt_project.yml file to False. \n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_tag_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_updated_at\n    \n as \n    \n    contact_updated_at\n    \n, \n    \n    \n    tag_id\n    \n as \n    \n    tag_id\n    \n\n\n \n    from base\n),\n\nfinal as (\n    \n    select \n        contact_id,\n        contact_updated_at,\n        tag_id\n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_tag_history"}, "model.intercom_source.stg_intercom__conversation_contact_history": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__conversation_contact_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__conversation_contact_history_tmp')),\n                staging_columns=get_conversation_contact_history_columns()\n            )\n        }}\n    from base\n),\n\nfinal as (\n    \n    select \n        contact_id,\n        conversation_id,\n        conversation_updated_at  \n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_conversation_contact_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__conversation_contact_history_tmp", "model.intercom_source.stg_intercom__conversation_contact_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__conversation_contact_history"], "unique_id": "model.intercom_source.stg_intercom__conversation_contact_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__conversation_contact_history.sql", "original_file_path": "models\\stg_intercom__conversation_contact_history.sql", "name": "stg_intercom__conversation_contact_history", "alias": "stg_intercom__conversation_contact_history", "checksum": {"name": "sha256", "checksum": "214bce6ce7a335430b7e9b5e56bb0bc4325219359e0cddb26c1c656954ede862"}, "tags": [], "refs": [["stg_intercom__conversation_contact_history_tmp"], ["stg_intercom__conversation_contact_history_tmp"]], "sources": [], "description": "Mapping table for contacts associated with a conversation.", "columns": {"contact_id": {"name": "contact_id", "description": "The unique identifier for the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_id": {"name": "conversation_id", "description": "The unique identifier for the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_updated_at": {"name": "conversation_updated_at", "description": "Time the conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__conversation_contact_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.9116747, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_contact_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n    \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    conversation_id\n    \n as \n    \n    conversation_id\n    \n, \n    \n    \n    conversation_updated_at\n    \n as \n    \n    conversation_updated_at\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        contact_id,\n        conversation_id,\n        conversation_updated_at  \n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_contact_history"}, "model.intercom_source.stg_intercom__conversation_history": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__conversation_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__conversation_history_tmp')),\n                staging_columns=get_conversation_history_columns()\n            )\n        }}\n    from base\n),\n\nfinal as (\n    \n    select \n        id as conversation_id,\n        created_at,\n        assignee_id,\n        assignee_type,\n        conversation_rating_value,\n        conversation_rating_remark,\n        first_contact_reply_created_at,\n        first_contact_reply_type,\n        read as is_read,\n        source_author_id,\n        source_author_type,\n        source_delivered_as,\n        source_type,\n        source_subject,\n        state,\n        updated_at,\n        waiting_since,\n        snoozed_until,\n        sla_name,\n        sla_status\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_conversation_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__conversation_history_tmp", "model.intercom_source.stg_intercom__conversation_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__conversation_history"], "unique_id": "model.intercom_source.stg_intercom__conversation_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__conversation_history.sql", "original_file_path": "models\\stg_intercom__conversation_history.sql", "name": "stg_intercom__conversation_history", "alias": "stg_intercom__conversation_history", "checksum": {"name": "sha256", "checksum": "d1f303335ac953789ce37044cf5c7547f3449483a7b1c7ff91564a5bdcc848ba"}, "tags": [], "refs": [["stg_intercom__conversation_history_tmp"], ["stg_intercom__conversation_history_tmp"]], "sources": [], "description": "Table containing the historical records of each conversation. Conversations are created when a contact replies to an outbound message, or when one admin directly sends a message to a single contact.", "columns": {"conversation_id": {"name": "conversation_id", "description": "The id representing the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the conversation was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_id": {"name": "assignee_id", "description": "The id of the user assigned to the conversation. If it is not assigned to a user it will return null.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_type": {"name": "assignee_type", "description": "The type of user the conversation is assigned to. If it is not assigned to a user it will return null.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_value": {"name": "conversation_rating_value", "description": "An optional field for the customer to rate the conversation which will be between 1 and 5.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_remark": {"name": "conversation_rating_remark", "description": "An optional field to add a remark to correspond to the number rating.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_created_at": {"name": "first_contact_reply_created_at", "description": "Time of the first text conversation part from a contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_type": {"name": "first_contact_reply_type", "description": "The type of communication in which the first contact reply was.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "is_read": {"name": "is_read", "description": "Boolean indicating whether the conversation message has been read.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_id": {"name": "source_author_id", "description": "id of the individual who authored the first message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_type": {"name": "source_author_type", "description": "The type of individual who authored the first message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_delivered_as": {"name": "source_delivered_as", "description": "How the conversation was initially delivered to the responder.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_type": {"name": "source_type", "description": "The type of conversation. This includes conversation, push, facebook, twitter and email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_subject": {"name": "source_subject", "description": "The subject of the conversation created by the initiator.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "state": {"name": "state", "description": "The current state of the conversation (open or close).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The date the conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "waiting_since": {"name": "waiting_since", "description": "The last time a contact responded to an admin. The time a customer started waiting for a response. Set to null if the last reply is from an admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "snoozed_until": {"name": "snoozed_until", "description": "If set, this is the time in the future when this conversation will be marked as open.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_name": {"name": "sla_name", "description": "The name of the SLA as given by the teammate when it was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_status": {"name": "sla_status", "description": "One of \u201chit\u201d, \u201dmissed\u201d, or \u201ccancelled\u201d.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__conversation_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.9116747, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    assignee_id\n    \n as \n    \n    assignee_id\n    \n, \n    \n    \n    assignee_type\n    \n as \n    \n    assignee_type\n    \n, \n    \n    \n    conversation_rating_remark\n    \n as \n    \n    conversation_rating_remark\n    \n, \n    \n    \n    conversation_rating_value\n    \n as \n    \n    conversation_rating_value\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    first_contact_reply_created_at\n    \n as \n    \n    first_contact_reply_created_at\n    \n, \n    \n    \n    first_contact_reply_type\n    \n as \n    \n    first_contact_reply_type\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    read\n    \n as \n    \n    read\n    \n, \n    \n    \n    sla_name\n    \n as \n    \n    sla_name\n    \n, \n    \n    \n    sla_status\n    \n as \n    \n    sla_status\n    \n, \n    \n    \n    snoozed_until\n    \n as \n    \n    snoozed_until\n    \n, \n    \n    \n    source_author_id\n    \n as \n    \n    source_author_id\n    \n, \n    \n    \n    source_author_type\n    \n as \n    \n    source_author_type\n    \n, \n    \n    \n    source_body\n    \n as \n    \n    source_body\n    \n, \n    \n    \n    source_delivered_as\n    \n as \n    \n    source_delivered_as\n    \n, \n    \n    \n    source_subject\n    \n as \n    \n    source_subject\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    waiting_since\n    \n as \n    \n    waiting_since\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as conversation_id,\n        created_at,\n        assignee_id,\n        assignee_type,\n        conversation_rating_value,\n        conversation_rating_remark,\n        first_contact_reply_created_at,\n        first_contact_reply_type,\n        read as is_read,\n        source_author_id,\n        source_author_type,\n        source_delivered_as,\n        source_type,\n        source_subject,\n        state,\n        updated_at,\n        waiting_since,\n        snoozed_until,\n        sla_name,\n        sla_status\n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_history"}, "model.intercom_source.stg_intercom__conversation_part_history": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__conversation_part_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__conversation_part_history_tmp')),\n                staging_columns=get_conversation_part_history_columns()\n            )\n        }}       \n    from base\n),\n\nfinal as (\n    \n    select \n        id as conversation_part_id,\n        part_type,\n        conversation_id,\n        author_id,\n        author_type,\n        created_at,\n        assigned_to_id,\n        assigned_to_type,\n        conversation_updated_at,\n        updated_at\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_conversation_part_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__conversation_part_history_tmp", "model.intercom_source.stg_intercom__conversation_part_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__conversation_part_history"], "unique_id": "model.intercom_source.stg_intercom__conversation_part_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__conversation_part_history.sql", "original_file_path": "models\\stg_intercom__conversation_part_history.sql", "name": "stg_intercom__conversation_part_history", "alias": "stg_intercom__conversation_part_history", "checksum": {"name": "sha256", "checksum": "0022f7febd0ccbfde0fc2dedfb46df6d5c47cc79ec77ca1c958478f1734e80a1"}, "tags": [], "refs": [["stg_intercom__conversation_part_history_tmp"], ["stg_intercom__conversation_part_history_tmp"]], "sources": [], "description": "Table containing data related to the individual parts of a single conversation.", "columns": {"conversation_part_id": {"name": "conversation_part_id", "description": "The id representing the conversation part.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "part_type": {"name": "part_type", "description": "The type of conversation part.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_id": {"name": "conversation_id", "description": "The id representing the parent conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "author_id": {"name": "author_id", "description": "The id representing the individual that sent the message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "author_type": {"name": "author_type", "description": "The type of individual that sent the message (user, admin, or bot).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the conversation part was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assigned_to_id": {"name": "assigned_to_id", "description": "The id of the admin that was assigned the conversation by this conversation_part (null if there has been no change in assignment).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assigned_to_type": {"name": "assigned_to_type", "description": "The type of the individual which the conversation part is assigned.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_updated_at": {"name": "conversation_updated_at", "description": "The time the parent conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The time the conversation part was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__conversation_part_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.9116747, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_part_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    assigned_to_id\n    \n as \n    \n    assigned_to_id\n    \n, \n    \n    \n    assigned_to_type\n    \n as \n    \n    assigned_to_type\n    \n, \n    \n    \n    author_id\n    \n as \n    \n    author_id\n    \n, \n    \n    \n    author_type\n    \n as \n    \n    author_type\n    \n, \n    \n    \n    conversation_id\n    \n as \n    \n    conversation_id\n    \n, \n    \n    \n    conversation_updated_at\n    \n as \n    \n    conversation_updated_at\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    part_type\n    \n as \n    \n    part_type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n       \n    from base\n),\n\nfinal as (\n    \n    select \n        id as conversation_part_id,\n        part_type,\n        conversation_id,\n        author_id,\n        author_type,\n        created_at,\n        assigned_to_id,\n        assigned_to_type,\n        conversation_updated_at,\n        updated_at\n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_part_history"}, "model.intercom_source.stg_intercom__conversation_tag_history": {"raw_sql": "--To disable this model, set the intercom__using_conversation_tags variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_conversation_tags', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__conversation_tag_history_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__conversation_tag_history_tmp')),\n                staging_columns=get_conversation_tag_history_columns()\n            )\n        }}\n    from base\n),\n\nfinal as (\n    \n    select \n        conversation_id,\n        tag_id\n    from fields\n)\n\nselect * \nfrom final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_conversation_tag_history_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__conversation_tag_history_tmp", "model.intercom_source.stg_intercom__conversation_tag_history_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__conversation_tag_history"], "unique_id": "model.intercom_source.stg_intercom__conversation_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__conversation_tag_history.sql", "original_file_path": "models\\stg_intercom__conversation_tag_history.sql", "name": "stg_intercom__conversation_tag_history", "alias": "stg_intercom__conversation_tag_history", "checksum": {"name": "sha256", "checksum": "3c8323d474f5b66fefbe09accaf7d58dd85a7dd6c1e9dcca83f040b77ecdd9c6"}, "tags": [], "refs": [["stg_intercom__conversation_tag_history_tmp"], ["stg_intercom__conversation_tag_history_tmp"]], "sources": [], "description": "Mapping table for tags associated with conversations.", "columns": {"conversation_id": {"name": "conversation_id", "description": "The unique identifier related to the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__conversation_tag_history.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.9116747, "compiled_sql": "--To disable this model, set the intercom__using_conversation_tags variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_tag_history_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    cast(null as \n    int\n) as \n    \n    conversation_id\n    \n , \n    cast(null as \n    timestamp_ntz\n) as \n    \n    conversation_updated_at\n    \n , \n    cast(null as \n    int\n) as \n    \n    tag_id\n    \n \n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        conversation_id,\n        tag_id\n    from fields\n)\n\nselect * \nfrom final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_tag_history"}, "model.intercom_source.stg_intercom__tag": {"raw_sql": "with base as (\n\n    select * \n    from {{ ref('stg_intercom__tag_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__tag_tmp')),\n                staging_columns=get_tag_columns()\n            )\n        }}\n    from base\n),\n\nfinal as (\n    \n    select \n        id as tag_id,\n        trim(name) as name,\n        _fivetran_deleted\n    from fields\n)\n\nselect *\nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_tag_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__tag_tmp", "model.intercom_source.stg_intercom__tag_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__tag"], "unique_id": "model.intercom_source.stg_intercom__tag", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__tag.sql", "original_file_path": "models\\stg_intercom__tag.sql", "name": "stg_intercom__tag", "alias": "stg_intercom__tag", "checksum": {"name": "sha256", "checksum": "4cd405b9f403ad6ebc8014e38d0532d44f231b216c94756f9684bcb4ee48521b"}, "tags": [], "refs": [["stg_intercom__tag_tmp"], ["stg_intercom__tag_tmp"]], "sources": [], "description": "Table consisting of tags which allow you to label your contacts, companies, or conversations.", "columns": {"tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__tag.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table"}, "created_at": 1657023779.9116747, "compiled_sql": "with base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__tag_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as tag_id,\n        trim(name) as name,\n        _fivetran_deleted\n    from fields\n)\n\nselect *\nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__tag"}, "model.intercom_source.stg_intercom__team": {"raw_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_team', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__team_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__team_tmp')),\n                staging_columns=get_team_columns()\n            )\n        }}   \n    from base\n),\n\nfinal as (\n    \n    select \n        id as team_id,\n        name,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_team_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__team_tmp", "model.intercom_source.stg_intercom__team_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__team"], "unique_id": "model.intercom_source.stg_intercom__team", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__team.sql", "original_file_path": "models\\stg_intercom__team.sql", "name": "stg_intercom__team", "alias": "stg_intercom__team", "checksum": {"name": "sha256", "checksum": "6af956077eab829d97249545ea557aa15c15b083c0cc1af4707b6a135b50632b"}, "tags": [], "refs": [["stg_intercom__team_tmp"], ["stg_intercom__team_tmp"]], "sources": [], "description": "Table containing teams which are made up of groups of admin in Intercom.", "columns": {"team_id": {"name": "team_id", "description": "The unique identifier of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__team.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.9273007, "compiled_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n   \n    from base\n),\n\nfinal as (\n    \n    select \n        id as team_id,\n        name,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team"}, "model.intercom_source.stg_intercom__team_admin": {"raw_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_team', True)) }}\n\nwith base as (\n\n    select * \n    from {{ ref('stg_intercom__team_admin_tmp') }}\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        {{\n            fivetran_utils.fill_staging_columns(\n                source_columns=adapter.get_columns_in_relation(ref('stg_intercom__team_admin_tmp')),\n                staging_columns=get_team_admin_columns()\n            )\n        }}   \n    from base\n),\n\nfinal as (\n    \n    select \n        admin_id,\n        team_id,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.intercom_source.get_team_admin_columns", "macro.fivetran_utils.fill_staging_columns"], "nodes": ["model.intercom_source.stg_intercom__team_admin_tmp", "model.intercom_source.stg_intercom__team_admin_tmp"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "stg_intercom__team_admin"], "unique_id": "model.intercom_source.stg_intercom__team_admin", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "stg_intercom__team_admin.sql", "original_file_path": "models\\stg_intercom__team_admin.sql", "name": "stg_intercom__team_admin", "alias": "stg_intercom__team_admin", "checksum": {"name": "sha256", "checksum": "a06ea36a87f1231fd98030efb74d8a4839bed1e392d72d3a56957fafc1ddc420"}, "tags": [], "refs": [["stg_intercom__team_admin_tmp"], ["stg_intercom__team_admin_tmp"]], "sources": [], "description": "Mapping table for admins associated with teams.", "columns": {"team_id": {"name": "team_id", "description": "The unique identifier of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "admin_id": {"name": "admin_id", "description": "The unique identifier of the admin associate with the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_source://models\\stg_intercom.yml", "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom__team_admin.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "table", "enabled": true}, "created_at": 1657023779.9273007, "compiled_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n\n\nwith base as (\n\n    select * \n    from houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_admin_tmp\n\n),\n\nfields as (\n\n    select\n    /*\n    The below macro is used to generate the correct SQL for package staging models. It takes a list of columns \n    that are expected/needed (staging_columns from dbt_intercom_source/models/tmp/) and compares it with columns \n    in the source (source_columns from dbt_intercom_source/macros/).\n    For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).\n    */\n\n        \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as \n    timestamp_ntz\n) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as \n    varchar\n) as \n    \n    admin_id\n    \n , \n    cast(null as \n    int\n) as \n    \n    team_id\n    \n \n\n   \n    from base\n),\n\nfinal as (\n    \n    select \n        admin_id,\n        team_id,\n        _fivetran_deleted\n    from fields\n)\n\nselect * \nfrom final\nwhere not coalesce(_fivetran_deleted, false)", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_admin"}, "model.intercom_source.stg_intercom__admin_tmp": {"raw_sql": "select * \nfrom {{ var('admin') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.admin"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__admin_tmp"], "unique_id": "model.intercom_source.stg_intercom__admin_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__admin_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__admin_tmp.sql", "name": "stg_intercom__admin_tmp", "alias": "stg_intercom__admin_tmp", "checksum": {"name": "sha256", "checksum": "a0b6ab88455771e6376e49872c5cd4c2ed56c27581272ff2b27614ace367d486"}, "tags": [], "refs": [], "sources": [["intercom", "admin"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__admin_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.5116298, "compiled_sql": "select * \nfrom houseware_metrics.intercom.admin", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__admin_tmp"}, "model.intercom_source.stg_intercom__company_history_tmp": {"raw_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_contact_company', True)) }}\n\nselect * \nfrom {{ var('company_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.company_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__company_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__company_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__company_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__company_history_tmp.sql", "name": "stg_intercom__company_history_tmp", "alias": "stg_intercom__company_history_tmp", "checksum": {"name": "sha256", "checksum": "ddca2f278b8eaa300dbd4b159a802f04f43c41e624603f370bf6c0fc5ca4c7f1"}, "tags": [], "refs": [], "sources": [["intercom", "company_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__company_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.5149426, "compiled_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.company_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_history_tmp"}, "model.intercom_source.stg_intercom__company_tag_history_tmp": {"raw_sql": "--To disable this model, set the intercom__using_company_tags variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_company_tags', True)) }}\n\nselect * \nfrom {{ var('company_tag_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.company_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__company_tag_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__company_tag_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__company_tag_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__company_tag_history_tmp.sql", "name": "stg_intercom__company_tag_history_tmp", "alias": "stg_intercom__company_tag_history_tmp", "checksum": {"name": "sha256", "checksum": "688c4cea6815132b9259286f7fae9e45fd9b1f077502c91ba9f75338882eef33"}, "tags": [], "refs": [], "sources": [["intercom", "company_tag_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__company_tag_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.5292678, "compiled_sql": "--To disable this model, set the intercom__using_company_tags variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.company_tag_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_tag_history_tmp"}, "model.intercom_source.stg_intercom__contact_company_history_tmp": {"raw_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_contact_company', True)) }}\n\nselect * \nfrom {{ var('contact_company_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.contact_company_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__contact_company_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__contact_company_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__contact_company_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__contact_company_history_tmp.sql", "name": "stg_intercom__contact_company_history_tmp", "alias": "stg_intercom__contact_company_history_tmp", "checksum": {"name": "sha256", "checksum": "41e5306b8f271966f5868262e04f9526ecede5300ec449b3adb045688f702620"}, "tags": [], "refs": [], "sources": [["intercom", "contact_company_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__contact_company_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.5400455, "compiled_sql": "--To disable this model, set the intercom__using_contact_company variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.contact_company_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_company_history_tmp"}, "model.intercom_source.stg_intercom__contact_history_tmp": {"raw_sql": "select * \nfrom {{ var('contact_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.contact_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__contact_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__contact_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__contact_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__contact_history_tmp.sql", "name": "stg_intercom__contact_history_tmp", "alias": "stg_intercom__contact_history_tmp", "checksum": {"name": "sha256", "checksum": "bc33acecdab0eda03d8b7c943f0e4475877349945377ba9a1200fe6257758613"}, "tags": [], "refs": [], "sources": [["intercom", "contact_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__contact_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.5571039, "compiled_sql": "select * \nfrom houseware_metrics.intercom.contact_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_history_tmp"}, "model.intercom_source.stg_intercom__contact_tag_history_tmp": {"raw_sql": "--To disable this model, set the intercom__using_contact_tags variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_contact_tags', True)) }}\n\nselect * \nfrom {{ var('contact_tag_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.contact_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__contact_tag_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__contact_tag_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__contact_tag_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__contact_tag_history_tmp.sql", "name": "stg_intercom__contact_tag_history_tmp", "alias": "stg_intercom__contact_tag_history_tmp", "checksum": {"name": "sha256", "checksum": "200fadc1d9977cc739087422c4f56ea2ff3b491aed1c9d03e6f6fb391e7aa8dd"}, "tags": [], "refs": [], "sources": [["intercom", "contact_tag_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__contact_tag_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.559128, "compiled_sql": "--To disable this model, set the intercom__using_contact_tags variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.contact_tag_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_tag_history_tmp"}, "model.intercom_source.stg_intercom__conversation_contact_history_tmp": {"raw_sql": "select * \nfrom {{ var('conversation_contact_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.conversation_contact_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__conversation_contact_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__conversation_contact_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__conversation_contact_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__conversation_contact_history_tmp.sql", "name": "stg_intercom__conversation_contact_history_tmp", "alias": "stg_intercom__conversation_contact_history_tmp", "checksum": {"name": "sha256", "checksum": "9d2f1b818b4fed265b3b382bfb9b396d6c5ea4576a7d8e436de7946d807e48ee"}, "tags": [], "refs": [], "sources": [["intercom", "conversation_contact_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__conversation_contact_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.5728104, "compiled_sql": "select * \nfrom houseware_metrics.intercom.conversation_contact_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_contact_history_tmp"}, "model.intercom_source.stg_intercom__conversation_history_tmp": {"raw_sql": "select * \nfrom {{ var('conversation_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.conversation_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__conversation_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__conversation_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__conversation_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__conversation_history_tmp.sql", "name": "stg_intercom__conversation_history_tmp", "alias": "stg_intercom__conversation_history_tmp", "checksum": {"name": "sha256", "checksum": "6bf4dde37255b2b1fe413b187157425d28ed9182a4d76382035d0e3422844764"}, "tags": [], "refs": [], "sources": [["intercom", "conversation_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__conversation_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.587823, "compiled_sql": "select * \nfrom houseware_metrics.intercom.conversation_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_history_tmp"}, "model.intercom_source.stg_intercom__conversation_part_history_tmp": {"raw_sql": "select * \nfrom {{ var('conversation_part_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.conversation_part_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__conversation_part_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__conversation_part_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__conversation_part_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__conversation_part_history_tmp.sql", "name": "stg_intercom__conversation_part_history_tmp", "alias": "stg_intercom__conversation_part_history_tmp", "checksum": {"name": "sha256", "checksum": "96fcc2ace025a9d0b850d27328c13e3a2db947a150599c549678d3a47f188bf8"}, "tags": [], "refs": [], "sources": [["intercom", "conversation_part_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__conversation_part_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.587823, "compiled_sql": "select * \nfrom houseware_metrics.intercom.conversation_part_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_part_history_tmp"}, "model.intercom_source.stg_intercom__conversation_tag_history_tmp": {"raw_sql": "--To disable this model, set the intercom__using_conversation_tags variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_conversation_tags', True)) }}\n\nselect * \nfrom {{ var('conversation_tag_history') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.conversation_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__conversation_tag_history_tmp"], "unique_id": "model.intercom_source.stg_intercom__conversation_tag_history_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__conversation_tag_history_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__conversation_tag_history_tmp.sql", "name": "stg_intercom__conversation_tag_history_tmp", "alias": "stg_intercom__conversation_tag_history_tmp", "checksum": {"name": "sha256", "checksum": "d66d8484584bbf5128af0c435af942865a590629dcae8709de0e1f419ab77252"}, "tags": [], "refs": [], "sources": [["intercom", "conversation_tag_history"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__conversation_tag_history_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.603461, "compiled_sql": "--To disable this model, set the intercom__using_conversation_tags variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.conversation_tag_history", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_tag_history_tmp"}, "model.intercom_source.stg_intercom__tag_tmp": {"raw_sql": "select * \nfrom {{ var('tag') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.tag"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__tag_tmp"], "unique_id": "model.intercom_source.stg_intercom__tag_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__tag_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__tag_tmp.sql", "name": "stg_intercom__tag_tmp", "alias": "stg_intercom__tag_tmp", "checksum": {"name": "sha256", "checksum": "c394a64eb436d4592c23e4c1876d4e001907bdf6de6fa1267f9bd47c83678711"}, "tags": [], "refs": [], "sources": [["intercom", "tag"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__tag_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view"}, "created_at": 1657023779.6211207, "compiled_sql": "select * \nfrom houseware_metrics.intercom.tag", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__tag_tmp"}, "model.intercom_source.stg_intercom__team_admin_tmp": {"raw_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_team', True)) }}\n\nselect * \nfrom {{ var('team_admin') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.team_admin"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__team_admin_tmp"], "unique_id": "model.intercom_source.stg_intercom__team_admin_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__team_admin_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__team_admin_tmp.sql", "name": "stg_intercom__team_admin_tmp", "alias": "stg_intercom__team_admin_tmp", "checksum": {"name": "sha256", "checksum": "42360ac3d5c81ea07669541e66c355757d35d9bbab6ae0a40916dca3bd30369e"}, "tags": [], "refs": [], "sources": [["intercom", "team_admin"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__team_admin_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.623022, "compiled_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.team_admin", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_admin_tmp"}, "model.intercom_source.stg_intercom__team_tmp": {"raw_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n{{ config(enabled=var('intercom__using_team', True)) }}\n\nselect * \nfrom {{ var('team') }}", "compiled": true, "resource_type": "model", "depends_on": {"macros": [], "nodes": ["source.intercom_source.intercom.team"]}, "config": {"enabled": true, "alias": null, "schema": "stg_intercom", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED_stg_intercom", "fqn": ["intercom_source", "tmp", "stg_intercom__team_tmp"], "unique_id": "model.intercom_source.stg_intercom__team_tmp", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "tmp\\stg_intercom__team_tmp.sql", "original_file_path": "models\\tmp\\stg_intercom__team_tmp.sql", "name": "stg_intercom__team_tmp", "alias": "stg_intercom__team_tmp", "checksum": {"name": "sha256", "checksum": "36b6ef36c2c79b97d92597b8c7112c190bdc68bce9677891cc1c3def3246c7c6"}, "tags": [], "refs": [], "sources": [["intercom", "team"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\tmp\\stg_intercom__team_tmp.sql", "build_path": null, "deferred": false, "unrendered_config": {"schema": "stg_intercom", "materialized": "view", "enabled": true}, "created_at": 1657023779.6351502, "compiled_sql": "--To disable this model, set the intercom__using_team variable within your dbt_project.yml file to False.\n\n\nselect * \nfrom houseware_metrics.intercom.team", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_tmp"}, "model.metrics.dbt_metrics_default_calendar": {"raw_sql": "{{ config(materialized='table') }}\n\nwith days as (\n    {{ dbt_utils.date_spine(\n    datepart=\"day\",\n    start_date=\"cast('2010-01-01' as date)\",\n    end_date=\"cast('2030-01-01' as date)\"\n   )\n    }}\n),\n\nfinal as (\n    select \n        cast(date_day as date) as date_day,\n        cast({{ dbt_utils.date_trunc('week', 'date_day') }} as date) as date_week,\n        cast({{ dbt_utils.date_trunc('month', 'date_day') }} as date) as date_month,\n        cast({{ dbt_utils.date_trunc('quarter', 'date_day') }} as date) as date_quarter,\n        cast({{ dbt_utils.date_trunc('year', 'date_day') }} as date) as date_year\n    from days\n)\n\nselect * from final", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.date_spine", "macro.dbt_utils.date_trunc"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "houseware_metrics", "schema": "TRANSFORMED", "fqn": ["metrics", "dbt_metrics_default_calendar"], "unique_id": "model.metrics.dbt_metrics_default_calendar", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "dbt_metrics_default_calendar.sql", "original_file_path": "models\\dbt_metrics_default_calendar.sql", "name": "dbt_metrics_default_calendar", "alias": "dbt_metrics_default_calendar", "checksum": {"name": "sha256", "checksum": "d075b848564ef9dec2fbc519fc651567240f496e37edabeccd96fb7f38888018"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {"date_day": {"name": "date_day", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "date_week": {"name": "date_week", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "date_month": {"name": "date_month", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "date_quarter": {"name": "date_quarter", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}, "date_year": {"name": "date_year", "description": "", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "docs": {"show": true}, "patch_path": "intercom_metrics://models\\schema.yml", "compiled_path": "target\\compiled\\metrics\\models\\dbt_metrics_default_calendar.sql", "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table"}, "created_at": 1657023779.7622375, "compiled_sql": "\n\nwith days as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 7305\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2010-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2030-01-01' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select \n        cast(date_day as date) as date_day,\n        cast(date_trunc('week', date_day) as date) as date_week,\n        cast(date_trunc('month', date_day) as date) as date_month,\n        cast(date_trunc('quarter', date_day) as date) as date_quarter,\n        cast(date_trunc('year', date_day) as date) as date_year\n    from days\n)\n\nselect * from final", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "houseware_metrics.TRANSFORMED.dbt_metrics_default_calendar"}, "test.intercom_source.not_null_stg_intercom__admin_admin_id.8630313ad7": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "admin_id", "model": "{{ get_where_subquery(ref('stg_intercom__admin')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__admin"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__admin_admin_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__admin_admin_id.8630313ad7", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__admin_admin_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__admin_admin_id", "alias": "not_null_stg_intercom__admin_admin_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__admin"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__admin_admin_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9273007, "compiled_sql": "\n    \n    \n\n\n\nselect admin_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__admin\nwhere admin_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "admin_id", "file_key_name": "models.stg_intercom__admin"}, "test.intercom_source.unique_stg_intercom__admin_admin_id.10ac4663c1": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "admin_id", "model": "{{ get_where_subquery(ref('stg_intercom__admin')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__admin"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "unique_stg_intercom__admin_admin_id"], "unique_id": "test.intercom_source.unique_stg_intercom__admin_admin_id.10ac4663c1", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "unique_stg_intercom__admin_admin_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "unique_stg_intercom__admin_admin_id", "alias": "unique_stg_intercom__admin_admin_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__admin"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\unique_stg_intercom__admin_admin_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9273007, "compiled_sql": "\n    \n    \n\nselect\n    admin_id as unique_field,\n    count(*) as n_records\n\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__admin\nwhere admin_id is not null\ngroup by admin_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "admin_id", "file_key_name": "models.stg_intercom__admin"}, "test.intercom_source.not_null_stg_intercom__company_history_company_id.29e68d8641": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "company_id", "model": "{{ get_where_subquery(ref('stg_intercom__company_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__company_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__company_history_company_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__company_history_company_id.29e68d8641", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__company_history_company_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__company_history_company_id", "alias": "not_null_stg_intercom__company_history_company_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__company_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__company_history_company_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9273007, "compiled_sql": "\n    \n    \n\n\n\nselect company_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_history\nwhere company_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "company_id", "file_key_name": "models.stg_intercom__company_history"}, "test.intercom_source.unique_stg_intercom__company_history_company_id.5978446e98": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "company_id", "model": "{{ get_where_subquery(ref('stg_intercom__company_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__company_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "unique_stg_intercom__company_history_company_id"], "unique_id": "test.intercom_source.unique_stg_intercom__company_history_company_id.5978446e98", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "unique_stg_intercom__company_history_company_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "unique_stg_intercom__company_history_company_id", "alias": "unique_stg_intercom__company_history_company_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__company_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\unique_stg_intercom__company_history_company_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_history\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "company_id", "file_key_name": "models.stg_intercom__company_history"}, "test.intercom_source.not_null_stg_intercom__company_tag_history_company_id.7ce26b3077": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "company_id", "model": "{{ get_where_subquery(ref('stg_intercom__company_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__company_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__company_tag_history_company_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__company_tag_history_company_id.7ce26b3077", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__company_tag_history_company_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__company_tag_history_company_id", "alias": "not_null_stg_intercom__company_tag_history_company_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__company_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__company_tag_history_company_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect company_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_tag_history\nwhere company_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "company_id", "file_key_name": "models.stg_intercom__company_tag_history"}, "test.intercom_source.not_null_stg_intercom__company_tag_history_tag_id.a71b043180": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "tag_id", "model": "{{ get_where_subquery(ref('stg_intercom__company_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__company_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__company_tag_history_tag_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__company_tag_history_tag_id.a71b043180", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__company_tag_history_tag_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__company_tag_history_tag_id", "alias": "not_null_stg_intercom__company_tag_history_tag_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__company_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__company_tag_history_tag_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect tag_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__company_tag_history\nwhere tag_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "tag_id", "file_key_name": "models.stg_intercom__company_tag_history"}, "test.intercom_source.not_null_stg_intercom__contact_company_history_company_id.ba3e617037": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "company_id", "model": "{{ get_where_subquery(ref('stg_intercom__contact_company_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__contact_company_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__contact_company_history_company_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__contact_company_history_company_id.ba3e617037", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__contact_company_history_company_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__contact_company_history_company_id", "alias": "not_null_stg_intercom__contact_company_history_company_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__contact_company_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__contact_company_history_company_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect company_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_company_history\nwhere company_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "company_id", "file_key_name": "models.stg_intercom__contact_company_history"}, "test.intercom_source.not_null_stg_intercom__contact_company_history_contact_id.5e389a0d84": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "contact_id", "model": "{{ get_where_subquery(ref('stg_intercom__contact_company_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__contact_company_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__contact_company_history_contact_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__contact_company_history_contact_id.5e389a0d84", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__contact_company_history_contact_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__contact_company_history_contact_id", "alias": "not_null_stg_intercom__contact_company_history_contact_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__contact_company_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__contact_company_history_contact_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect contact_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_company_history\nwhere contact_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "contact_id", "file_key_name": "models.stg_intercom__contact_company_history"}, "test.intercom_source.not_null_stg_intercom__contact_history_contact_id.433f831acf": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "contact_id", "model": "{{ get_where_subquery(ref('stg_intercom__contact_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__contact_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__contact_history_contact_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__contact_history_contact_id.433f831acf", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__contact_history_contact_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__contact_history_contact_id", "alias": "not_null_stg_intercom__contact_history_contact_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__contact_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__contact_history_contact_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect contact_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_history\nwhere contact_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "contact_id", "file_key_name": "models.stg_intercom__contact_history"}, "test.intercom_source.not_null_stg_intercom__contact_tag_history_contact_id.80f3693f49": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "contact_id", "model": "{{ get_where_subquery(ref('stg_intercom__contact_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__contact_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__contact_tag_history_contact_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__contact_tag_history_contact_id.80f3693f49", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__contact_tag_history_contact_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__contact_tag_history_contact_id", "alias": "not_null_stg_intercom__contact_tag_history_contact_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__contact_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__contact_tag_history_contact_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect contact_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_tag_history\nwhere contact_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "contact_id", "file_key_name": "models.stg_intercom__contact_tag_history"}, "test.intercom_source.not_null_stg_intercom__contact_tag_history_tag_id.24a4c9df63": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "tag_id", "model": "{{ get_where_subquery(ref('stg_intercom__contact_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__contact_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__contact_tag_history_tag_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__contact_tag_history_tag_id.24a4c9df63", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__contact_tag_history_tag_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__contact_tag_history_tag_id", "alias": "not_null_stg_intercom__contact_tag_history_tag_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__contact_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__contact_tag_history_tag_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9429367, "compiled_sql": "\n    \n    \n\n\n\nselect tag_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__contact_tag_history\nwhere tag_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "tag_id", "file_key_name": "models.stg_intercom__contact_tag_history"}, "test.intercom_source.not_null_stg_intercom__conversation_contact_history_contact_id.faa2dd69f0": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "contact_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_contact_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_contact_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_contact_history_contact_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_contact_history_contact_id.faa2dd69f0", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__conversation_contact_history_contact_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_contact_history_contact_id", "alias": "not_null_stg_intercom__conversation_contact_history_contact_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_contact_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__conversation_contact_history_contact_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect contact_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_contact_history\nwhere contact_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "contact_id", "file_key_name": "models.stg_intercom__conversation_contact_history"}, "test.intercom_source.not_null_stg_intercom__conversation_contact_history_conversation_id.6619b609cf": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a\") }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "conversation_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_contact_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_contact_history"]}, "config": {"enabled": true, "alias": "not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_contact_history_conversation_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_contact_history_conversation_id.6619b609cf", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_contact_history_conversation_id", "alias": "not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_contact_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_intercom__convers_d02c0924e7c5ab61bbeabd18aede5b2a"}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect conversation_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_contact_history\nwhere conversation_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "conversation_id", "file_key_name": "models.stg_intercom__conversation_contact_history"}, "test.intercom_source.not_null_stg_intercom__conversation_history_conversation_id.947be5d87e": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "conversation_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_history_conversation_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_history_conversation_id.947be5d87e", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__conversation_history_conversation_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_history_conversation_id", "alias": "not_null_stg_intercom__conversation_history_conversation_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__conversation_history_conversation_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect conversation_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_history\nwhere conversation_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "conversation_id", "file_key_name": "models.stg_intercom__conversation_history"}, "test.intercom_source.not_null_stg_intercom__conversation_part_history_conversation_part_id.53df1b68d4": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(alias=\"not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385\") }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "conversation_part_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_part_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_part_history"]}, "config": {"enabled": true, "alias": "not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385", "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_part_history_conversation_part_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_part_history_conversation_part_id.53df1b68d4", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_part_history_conversation_part_id", "alias": "not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_part_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385.sql", "build_path": null, "deferred": false, "unrendered_config": {"alias": "not_null_stg_intercom__convers_7d7e8ffe4c2506ce9378da1e8358c385"}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect conversation_part_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_part_history\nwhere conversation_part_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "conversation_part_id", "file_key_name": "models.stg_intercom__conversation_part_history"}, "test.intercom_source.not_null_stg_intercom__conversation_tag_history_conversation_id.2b897a1922": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "conversation_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_tag_history_conversation_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_tag_history_conversation_id.2b897a1922", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__conversation_tag_history_conversation_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_tag_history_conversation_id", "alias": "not_null_stg_intercom__conversation_tag_history_conversation_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__conversation_tag_history_conversation_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect conversation_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_tag_history\nwhere conversation_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "conversation_id", "file_key_name": "models.stg_intercom__conversation_tag_history"}, "test.intercom_source.not_null_stg_intercom__conversation_tag_history_tag_id.11ffc3e16e": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "tag_id", "model": "{{ get_where_subquery(ref('stg_intercom__conversation_tag_history')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__conversation_tag_history"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__conversation_tag_history_tag_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__conversation_tag_history_tag_id.11ffc3e16e", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__conversation_tag_history_tag_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__conversation_tag_history_tag_id", "alias": "not_null_stg_intercom__conversation_tag_history_tag_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__conversation_tag_history"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__conversation_tag_history_tag_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect tag_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__conversation_tag_history\nwhere tag_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "tag_id", "file_key_name": "models.stg_intercom__conversation_tag_history"}, "test.intercom_source.not_null_stg_intercom__team_admin_team_id.11bddbf17b": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "team_id", "model": "{{ get_where_subquery(ref('stg_intercom__team_admin')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__team_admin"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__team_admin_team_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__team_admin_team_id.11bddbf17b", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__team_admin_team_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__team_admin_team_id", "alias": "not_null_stg_intercom__team_admin_team_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__team_admin"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__team_admin_team_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9585502, "compiled_sql": "\n    \n    \n\n\n\nselect team_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team_admin\nwhere team_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "team_id", "file_key_name": "models.stg_intercom__team_admin"}, "test.intercom_source.not_null_stg_intercom__team_team_id.f6f47bb6ae": {"raw_sql": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "not_null", "kwargs": {"column_name": "team_id", "model": "{{ get_where_subquery(ref('stg_intercom__team')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__team"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "not_null_stg_intercom__team_team_id"], "unique_id": "test.intercom_source.not_null_stg_intercom__team_team_id.f6f47bb6ae", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "not_null_stg_intercom__team_team_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "not_null_stg_intercom__team_team_id", "alias": "not_null_stg_intercom__team_team_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__team"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\not_null_stg_intercom__team_team_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9741755, "compiled_sql": "\n    \n    \n\n\n\nselect team_id\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team\nwhere team_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "team_id", "file_key_name": "models.stg_intercom__team"}, "test.intercom_source.unique_stg_intercom__team_team_id.41ec840e13": {"raw_sql": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "test_metadata": {"name": "unique", "kwargs": {"column_name": "team_id", "model": "{{ get_where_subquery(ref('stg_intercom__team')) }}"}, "namespace": null}, "compiled": true, "resource_type": "test", "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["model.intercom_source.stg_intercom__team"]}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "materialized": "test", "severity": "ERROR", "store_failures": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "database": "houseware_metrics", "schema": "TRANSFORMED_dbt_test__audit", "fqn": ["intercom_source", "unique_stg_intercom__team_team_id"], "unique_id": "test.intercom_source.unique_stg_intercom__team_team_id.41ec840e13", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "unique_stg_intercom__team_team_id.sql", "original_file_path": "models\\stg_intercom.yml", "name": "unique_stg_intercom__team_team_id", "alias": "unique_stg_intercom__team_team_id", "checksum": {"name": "none", "checksum": ""}, "tags": [], "refs": [["stg_intercom__team"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target\\compiled\\intercom_source\\models\\stg_intercom.yml\\unique_stg_intercom__team_team_id.sql", "build_path": null, "deferred": false, "unrendered_config": {}, "created_at": 1657023779.9741755, "compiled_sql": "\n    \n    \n\nselect\n    team_id as unique_field,\n    count(*) as n_records\n\nfrom houseware_metrics.TRANSFORMED_stg_intercom.stg_intercom__team\nwhere team_id is not null\ngroup by team_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": null, "column_name": "team_id", "file_key_name": "models.stg_intercom__team"}}, "sources": {"source.intercom_source.intercom.admin": {"fqn": ["intercom_source", "intercom", "admin"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.admin", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "admin", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "admin", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": null, "external": null, "description": "Table containing information related to admins. Admins are the teammate accounts that have access to a workspace.", "columns": {"id": {"name": "id", "description": "The unique identifier representing the admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "job_title": {"name": "job_title", "description": "The admin job title.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.admin", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.company_history": {"fqn": ["intercom_source", "intercom", "company_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.company_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "company_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "company_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table containing historical information about companies which have been created within Intercom.", "columns": {"id": {"name": "id", "description": "The unique identifier representing the Intercom defined company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "company_id": {"name": "company_id", "description": "The custom identifier representing the Intercom defined company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "website": {"name": "website", "description": "The website associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "industry": {"name": "industry", "description": "The defined industry the company operates in.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the company was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The time the company was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "user_count": {"name": "user_count", "description": "The total count of users associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "session_count": {"name": "session_count", "description": "The total count of conversation sessions associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "monthly_spend": {"name": "monthly_spend", "description": "How much revenue the company generates for your business.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "plan_id": {"name": "plan_id", "description": "Unique identifier representing the company plan.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "plan_name": {"name": "plan_name", "description": "The name of the plan you have associated with the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.company_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.company_tag_history": {"fqn": ["intercom_source", "intercom", "company_tag_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.company_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "company_tag_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "company_tag_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for tags associated with companies.", "columns": {"company_id": {"name": "company_id", "description": "The unique identifier related to the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "company_updated_at": {"name": "company_updated_at", "description": "The date the company was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.company_tag_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.contact_company_history": {"fqn": ["intercom_source", "intercom", "contact_company_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.contact_company_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "contact_company_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "contact_company_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for contacts associated with companies.", "columns": {"company_id": {"name": "company_id", "description": "The unique identifier related to the company.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_id": {"name": "contact_id", "description": "The unique identifier related to the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_updated_at": {"name": "contact_updated_at", "description": "The time the contact was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.contact_company_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.contact_history": {"fqn": ["intercom_source", "intercom", "contact_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.contact_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "contact_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "contact_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table which provides historical details on contacts within Intercom.", "columns": {"id": {"name": "id", "description": "The unique identifier for the contact which is given by Intercom.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "admin_id": {"name": "admin_id", "description": "The unique identifier representing the admin which has been assigned ownership of the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time when the contact was created within Intercom.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "signed_up_at": {"name": "signed_up_at", "description": "The time the contact signed up.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "role": {"name": "role", "description": "The role of the contact (user or lead).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "email": {"name": "email", "description": "The contacts email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_replied_at": {"name": "last_replied_at", "description": "The time when the contact last messaged in.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_contacted_at": {"name": "last_contacted_at", "description": "The time when the contact was last messaged.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_email_clicked_at": {"name": "last_email_clicked_at", "description": "The time when the contact last clicked a link in an email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "last_email_opened_at": {"name": "last_email_opened_at", "description": "The time when a contact last opened an email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "unsubscribed_from_emails": {"name": "unsubscribed_from_emails", "description": "Boolean indicating whether the contact has unsubscribed from emails.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.contact_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.contact_tag_history": {"fqn": ["intercom_source", "intercom", "contact_tag_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.contact_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "contact_tag_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "contact_tag_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for tags associated with contacts.", "columns": {"contact_id": {"name": "contact_id", "description": "The unique identifier related to the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "contact_updated_at": {"name": "contact_updated_at", "description": "The date the contact was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.contact_tag_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.conversation_contact_history": {"fqn": ["intercom_source", "intercom", "conversation_contact_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.conversation_contact_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "conversation_contact_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "conversation_contact_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for contacts associated with a conversation.", "columns": {"contact_id": {"name": "contact_id", "description": "The unique identifier for the contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_id": {"name": "conversation_id", "description": "The unique identifier for the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_updated_at": {"name": "conversation_updated_at", "description": "Time the conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.conversation_contact_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.conversation_history": {"fqn": ["intercom_source", "intercom", "conversation_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.conversation_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "conversation_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "conversation_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table containing the historical records of each conversation. Conversations are created when a contact replies to an outbound message, or when one admin directly sends a message to a single contact.", "columns": {"id": {"name": "id", "description": "The id representing the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the conversation was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_id": {"name": "assignee_id", "description": "The id of the user assigned to the conversation. If it is not assigned to a user it will return null.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assignee_type": {"name": "assignee_type", "description": "The type of user the conversation is assigned to. If it is not assigned to a user it will return null.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_value": {"name": "conversation_rating_value", "description": "An optional field for the customer to rate the conversation which will be between 1 and 5.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_rating_remark": {"name": "conversation_rating_remark", "description": "An optional field to add a remark to correspond to the number rating.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_created_at": {"name": "first_contact_reply_created_at", "description": "Time of the first text conversation part from a contact.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "first_contact_reply_type": {"name": "first_contact_reply_type", "description": "The type of communication in which the first contact reply was.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "is_read": {"name": "is_read", "description": "Boolean indicating whether the conversation message has been read.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_id": {"name": "source_author_id", "description": "id of the individual who authored the first message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_author_type": {"name": "source_author_type", "description": "The type of individual who authored the first message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_delivered_as": {"name": "source_delivered_as", "description": "How the conversation was initially delivered to the responder.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_type": {"name": "source_type", "description": "The type of conversation. This includes conversation, push, facebook, twitter and email.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "source_subject": {"name": "source_subject", "description": "The subject of the conversation created by the initiator.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "state": {"name": "state", "description": "The current state of the conversation (open or close).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The date the conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "waiting_since": {"name": "waiting_since", "description": "The last time a contact responded to an admin. The time a customer started waiting for a response. Set to null if the last reply is from an admin.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "snoozed_until": {"name": "snoozed_until", "description": "If set, this is the time in the future when this conversation will be marked as open.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_name": {"name": "sla_name", "description": "The name of the SLA as given by the teammate when it was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "sla_status": {"name": "sla_status", "description": "One of \u201chit\u201d, \u201dmissed\u201d, or \u201ccancelled\u201d.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.conversation_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.conversation_part_history": {"fqn": ["intercom_source", "intercom", "conversation_part_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.conversation_part_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "conversation_part_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "conversation_part_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table containing data related to the individual parts of a single conversation.", "columns": {"id": {"name": "id", "description": "The id representing the conversation part.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "part_type": {"name": "part_type", "description": "The type of conversation part.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_id": {"name": "conversation_id", "description": "The id representing the parent conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "author_id": {"name": "author_id", "description": "The id representing the individual that sent the message.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "author_type": {"name": "author_type", "description": "The type of individual that sent the message (user, admin, or bot).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "created_at": {"name": "created_at", "description": "The time the conversation part was created.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assigned_to_id": {"name": "assigned_to_id", "description": "The id of the admin that was assigned the conversation by this conversation_part (null if there has been no change in assignment).", "meta": {}, "data_type": null, "quote": null, "tags": []}, "assigned_to_type": {"name": "assigned_to_type", "description": "The type of the individual which the conversation part is assigned.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "conversation_updated_at": {"name": "conversation_updated_at", "description": "The time the parent conversation was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "updated_at": {"name": "updated_at", "description": "The time the conversation part was last updated at.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.conversation_part_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.conversation_tag_history": {"fqn": ["intercom_source", "intercom", "conversation_tag_history"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.conversation_tag_history", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "conversation_tag_history", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "conversation_tag_history", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for tags associated with conversations.", "columns": {"conversation_id": {"name": "conversation_id", "description": "The unique identifier related to the conversation.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "tag_id": {"name": "tag_id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.conversation_tag_history", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.tag": {"fqn": ["intercom_source", "intercom", "tag"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.tag", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "tag", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "tag", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table consisting of tags which allow you to label your contacts, companies, or conversations.", "columns": {"id": {"name": "id", "description": "The unique identifier related to the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the tag.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.tag", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.team_admin": {"fqn": ["intercom_source", "intercom", "team_admin"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.team_admin", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "team_admin", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "team_admin", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Mapping table for admins associated with teams.", "columns": {"team_id": {"name": "team_id", "description": "The unique identifier of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "admin_id": {"name": "admin_id", "description": "The unique identifier of the admin associate with the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.team_admin", "created_at": 1657023779.9741755}, "source.intercom_source.intercom.team": {"fqn": ["intercom_source", "intercom", "team"], "database": "houseware_metrics", "schema": "intercom", "unique_id": "source.intercom_source.intercom.team", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "models\\src_intercom.yml", "original_file_path": "models\\src_intercom.yml", "name": "team", "source_name": "intercom", "source_description": "", "loader": "fivetran", "identifier": "team", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": "_fivetran_synced", "freshness": {"warn_after": {"count": 48, "period": "hour"}, "error_after": {"count": 72, "period": "hour"}, "filter": null}, "external": null, "description": "Table containing teams which are made up of groups of admin in Intercom.", "columns": {"id": {"name": "id", "description": "The unique identifier of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "name": {"name": "name", "description": "The name of the team.", "meta": {}, "data_type": null, "quote": null, "tags": []}, "_fivetran_deleted": {"name": "_fivetran_deleted", "description": "Boolean indicating whether the contact is deleted.", "meta": {}, "data_type": null, "quote": null, "tags": []}}, "meta": {"is_enabled": true}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "houseware_metrics.intercom.team", "created_at": 1657023779.9741755}}, "macros": {"macro.dbt_snowflake.snowflake__create_table_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_table_as", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__create_table_as", "macro_sql": "{% macro snowflake__create_table_as(temporary, relation, sql) -%}\n  {%- set transient = config.get('transient', default=true) -%}\n  {%- set cluster_by_keys = config.get('cluster_by', default=none) -%}\n  {%- set enable_automatic_clustering = config.get('automatic_clustering', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n  {%- if cluster_by_keys is not none and cluster_by_keys is string -%}\n    {%- set cluster_by_keys = [cluster_by_keys] -%}\n  {%- endif -%}\n  {%- if cluster_by_keys is not none -%}\n    {%- set cluster_by_string = cluster_by_keys|join(\", \")-%}\n  {% else %}\n    {%- set cluster_by_string = none -%}\n  {%- endif -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n      create or replace {% if temporary -%}\n        temporary\n      {%- elif transient -%}\n        transient\n      {%- endif %} table {{ relation }} {% if copy_grants and not temporary -%} copy grants {%- endif %} as\n      (\n        {%- if cluster_by_string is not none -%}\n          select * from(\n            {{ sql }}\n            ) order by ({{ cluster_by_string }})\n        {%- else -%}\n          {{ sql }}\n        {%- endif %}\n      );\n    {% if cluster_by_string is not none and not temporary -%}\n      alter table {{relation}} cluster by ({{cluster_by_string}});\n    {%- endif -%}\n    {% if enable_automatic_clustering and cluster_by_string is not none and not temporary  -%}\n      alter table {{relation}} resume recluster;\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.get_column_comment_sql": {"unique_id": "macro.dbt_snowflake.get_column_comment_sql", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "get_column_comment_sql", "macro_sql": "{% macro get_column_comment_sql(column_name, column_dict) %}\n  {{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} COMMENT $${{ column_dict[column_name]['description'] | replace('$', '[$]') }}$$\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.get_persist_docs_column_list": {"unique_id": "macro.dbt_snowflake.get_persist_docs_column_list", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "get_persist_docs_column_list", "macro_sql": "{% macro get_persist_docs_column_list(model_columns, query_columns) %}\n(\n  {% for column_name in query_columns %}\n    {% if (column_name|upper in model_columns) or (column_name in model_columns) %}\n      {{ get_column_comment_sql(column_name, model_columns) }}\n    {% else %}\n      {{column_name}}\n    {% endif %}\n    {{ \", \" if not loop.last else \"\" }}\n  {% endfor %}\n)\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__create_view_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_view_as", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__create_view_as", "macro_sql": "{% macro snowflake__create_view_as(relation, sql) -%}\n  {%- set secure = config.get('secure', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create or replace {% if secure -%}\n    secure\n  {%- endif %} view {{ relation }}\n  {% if config.persist_column_docs() -%}\n    {% set model_columns = model.columns %}\n    {% set query_columns = get_columns_in_query(sql) %}\n    {{ get_persist_docs_column_list(model_columns, query_columns) }}\n\n  {%- endif %}\n  {% if copy_grants -%} copy grants {%- endif %} as (\n    {{ sql }}\n  );\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query", "macro.dbt_snowflake.get_persist_docs_column_list"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__get_columns_in_relation": {"unique_id": "macro.dbt_snowflake.snowflake__get_columns_in_relation", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__get_columns_in_relation", "macro_sql": "{% macro snowflake__get_columns_in_relation(relation) -%}\n  {%- set sql -%}\n    describe table {{ relation }}\n  {%- endset -%}\n  {%- set result = run_query(sql) -%}\n\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many columns in relation {{ relation }}! dbt can only get\n      information about relations with fewer than {{ maximum }} columns.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n\n  {% set columns = [] %}\n  {% for row in result %}\n    {% do columns.append(api.Column.from_description(row['name'], row['type'])) %}\n  {% endfor %}\n  {% do return(columns) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__list_schemas": {"unique_id": "macro.dbt_snowflake.snowflake__list_schemas", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__list_schemas", "macro_sql": "{% macro snowflake__list_schemas(database) -%}\n  {# 10k limit from here: https://docs.snowflake.net/manuals/sql-reference/sql/show-schemas.html#usage-notes #}\n  {% set maximum = 10000 %}\n  {% set sql -%}\n    show terse schemas in database {{ database }}\n    limit {{ maximum }}\n  {%- endset %}\n  {% set result = run_query(sql) %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in database {{ database }}! dbt can only get\n      information about databases with fewer than {{ maximum }} schemas.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {{ return(result) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__list_relations_without_caching": {"unique_id": "macro.dbt_snowflake.snowflake__list_relations_without_caching", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__list_relations_without_caching", "macro_sql": "{% macro snowflake__list_relations_without_caching(schema_relation) %}\n  {%- set sql -%}\n    show terse objects in {{ schema_relation }}\n  {%- endset -%}\n\n  {%- set result = run_query(sql) -%}\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in schema  {{ schema_relation }}! dbt can only get\n      information about schemas with fewer than {{ maximum }} objects.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {%- do return(result) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__check_schema_exists": {"unique_id": "macro.dbt_snowflake.snowflake__check_schema_exists", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__check_schema_exists", "macro_sql": "{% macro snowflake__check_schema_exists(information_schema, schema) -%}\n  {% call statement('check_schema_exists', fetch_result=True) -%}\n        select count(*)\n        from {{ information_schema }}.schemata\n        where upper(schema_name) = upper('{{ schema }}')\n            and upper(catalog_name) = upper('{{ information_schema.database }}')\n  {%- endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__current_timestamp": {"unique_id": "macro.dbt_snowflake.snowflake__current_timestamp", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__current_timestamp", "macro_sql": "{% macro snowflake__current_timestamp() -%}\n  convert_timezone('UTC', current_timestamp())\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__snapshot_string_as_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_string_as_time", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__snapshot_string_as_time", "macro_sql": "{% macro snowflake__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"to_timestamp_ntz('\" ~ timestamp ~ \"')\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__snapshot_get_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_get_time", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__snapshot_get_time", "macro_sql": "{% macro snowflake__snapshot_get_time() -%}\n  to_timestamp_ntz({{ current_timestamp() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__rename_relation": {"unique_id": "macro.dbt_snowflake.snowflake__rename_relation", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__rename_relation", "macro_sql": "{% macro snowflake__rename_relation(from_relation, to_relation) -%}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ to_relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8744009}, "macro.dbt_snowflake.snowflake__alter_column_type": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_type", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__alter_column_type", "macro_sql": "{% macro snowflake__alter_column_type(relation, column_name, new_column_type) -%}\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} alter {{ adapter.quote(column_name) }} set data type {{ new_column_type }};\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.890069}, "macro.dbt_snowflake.snowflake__alter_relation_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_relation_comment", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__alter_relation_comment", "macro_sql": "{% macro snowflake__alter_relation_comment(relation, relation_comment) -%}\n  comment on {{ relation.type }} {{ relation }} IS $${{ relation_comment | replace('$', '[$]') }}$$;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.890069}, "macro.dbt_snowflake.snowflake__alter_column_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_comment", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__alter_column_comment", "macro_sql": "{% macro snowflake__alter_column_comment(relation, column_dict) -%}\n    {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n    alter {{ relation.type }} {{ relation }} alter\n    {% for column_name in column_dict if (column_name in existing_columns) or (column_name|upper in existing_columns) %}\n        {{ get_column_comment_sql(column_name, column_dict) }} {{ ',' if not loop.last else ';' }}\n    {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8914971}, "macro.dbt_snowflake.get_current_query_tag": {"unique_id": "macro.dbt_snowflake.get_current_query_tag", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "get_current_query_tag", "macro_sql": "{% macro get_current_query_tag() -%}\n  {{ return(run_query(\"show parameters like 'query_tag' in session\").rows[0]['value']) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.8925865}, "macro.dbt_snowflake.set_query_tag": {"unique_id": "macro.dbt_snowflake.set_query_tag", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "set_query_tag", "macro_sql": "{% macro set_query_tag() -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% set original_query_tag = get_current_query_tag() %}\n    {{ log(\"Setting query_tag to '\" ~ new_query_tag ~ \"'. Will reset to '\" ~ original_query_tag ~ \"' after materialization.\") }}\n    {% do run_query(\"alter session set query_tag = '{}'\".format(new_query_tag)) %}\n    {{ return(original_query_tag)}}\n  {% endif %}\n  {{ return(none)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_current_query_tag", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.893128}, "macro.dbt_snowflake.unset_query_tag": {"unique_id": "macro.dbt_snowflake.unset_query_tag", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "unset_query_tag", "macro_sql": "{% macro unset_query_tag(original_query_tag) -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% if original_query_tag %}\n      {{ log(\"Resetting query_tag to '\" ~ original_query_tag ~ \"'.\") }}\n      {% do run_query(\"alter session set query_tag = '{}'\".format(original_query_tag)) %}\n    {% else %}\n      {{ log(\"No original query_tag, unsetting parameter.\") }}\n      {% do run_query(\"alter session unset query_tag\") %}\n    {% endif %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.893128}, "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns": {"unique_id": "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__alter_relation_add_remove_columns", "macro_sql": "{% macro snowflake__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns %}\n\n    {% set sql -%}\n       alter {{ relation.type }} {{ relation }} add column\n          {% for column in add_columns %}\n            {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n          {% endfor %}\n    {%- endset -%}\n\n    {% do run_query(sql) %}\n\n  {% endif %}\n\n  {% if remove_columns %}\n\n    {% set sql -%}\n        alter {{ relation.type }} {{ relation }} drop column\n            {% for column in remove_columns %}\n                {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n    {%- endset -%}\n\n    {% do run_query(sql) %}\n\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.893128}, "macro.dbt_snowflake.snowflake_dml_explicit_transaction": {"unique_id": "macro.dbt_snowflake.snowflake_dml_explicit_transaction", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake_dml_explicit_transaction", "macro_sql": "{% macro snowflake_dml_explicit_transaction(dml) %}\n  {#\n    Use this macro to wrap all INSERT, MERGE, UPDATE, DELETE, and TRUNCATE\n    statements before passing them into run_query(), or calling in the 'main' statement\n    of a materialization\n  #}\n  {% set dml_transaction -%}\n    begin;\n    {{ dml }};\n    commit;\n  {%- endset %}\n\n  {% do return(dml_transaction) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.893128}, "macro.dbt_snowflake.snowflake__truncate_relation": {"unique_id": "macro.dbt_snowflake.snowflake__truncate_relation", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\adapters.sql", "original_file_path": "macros\\adapters.sql", "name": "snowflake__truncate_relation", "macro_sql": "{% macro snowflake__truncate_relation(relation) -%}\n  {% set truncate_dml %}\n    truncate table {{ relation }}\n  {% endset %}\n  {% call statement('truncate_relation') -%}\n    {{ snowflake_dml_explicit_transaction(truncate_dml) }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.893128}, "macro.dbt_snowflake.snowflake__get_catalog": {"unique_id": "macro.dbt_snowflake.snowflake__get_catalog", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\catalog.sql", "original_file_path": "macros\\catalog.sql", "name": "snowflake__get_catalog", "macro_sql": "{% macro snowflake__get_catalog(information_schema, schemas) -%}\n  {% set query %}\n      with tables as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n              table_type as \"table_type\",\n              comment as \"table_comment\",\n\n              -- note: this is the _role_ that owns the table\n              table_owner as \"table_owner\",\n\n              'Clustering Key' as \"stats:clustering_key:label\",\n              clustering_key as \"stats:clustering_key:value\",\n              'The key used to cluster this table' as \"stats:clustering_key:description\",\n              (clustering_key is not null) as \"stats:clustering_key:include\",\n\n              'Row Count' as \"stats:row_count:label\",\n              row_count as \"stats:row_count:value\",\n              'An approximate count of rows in this table' as \"stats:row_count:description\",\n              (row_count is not null) as \"stats:row_count:include\",\n\n              'Approximate Size' as \"stats:bytes:label\",\n              bytes as \"stats:bytes:value\",\n              'Approximate size of the table as reported by Snowflake' as \"stats:bytes:description\",\n              (bytes is not null) as \"stats:bytes:include\",\n\n              'Last Modified' as \"stats:last_modified:label\",\n              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as \"stats:last_modified:value\",\n              'The timestamp for last update/change' as \"stats:last_modified:description\",\n              (last_altered is not null and table_type='BASE TABLE') as \"stats:last_modified:include\"\n\n          from {{ information_schema }}.tables\n\n      ),\n\n      columns as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n\n              column_name as \"column_name\",\n              ordinal_position as \"column_index\",\n              data_type as \"column_type\",\n              comment as \"column_comment\"\n\n          from {{ information_schema }}.columns\n      )\n\n      select *\n      from tables\n      join columns using (\"table_database\", \"table_schema\", \"table_name\")\n      where (\n        {%- for schema in schemas -%}\n          upper(\"table_schema\") = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n      )\n      order by \"column_index\"\n    {%- endset -%}\n\n  {{ return(run_query(query)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9001763}, "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "dbt_snowflake_validate_get_incremental_strategy", "macro_sql": "{% macro dbt_snowflake_validate_get_incremental_strategy(config) %}\n  {#-- Find and validate the incremental strategy #}\n  {%- set strategy = config.get(\"incremental_strategy\", default=\"merge\") -%}\n\n  {% set invalid_strategy_msg -%}\n    Invalid incremental strategy provided: {{ strategy }}\n    Expected one of: 'merge', 'delete+insert'\n  {%- endset %}\n  {% if strategy not in ['merge', 'delete+insert'] %}\n    {% do exceptions.raise_compiler_error(invalid_strategy_msg) %}\n  {% endif %}\n\n  {% do return(strategy) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "dbt_snowflake_get_incremental_sql", "macro_sql": "{% macro dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n  {% if strategy == 'merge' %}\n    {% do return(get_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% elif strategy == 'delete+insert' %}\n    {% do return(get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% else %}\n    {% do exceptions.raise_compiler_error('invalid strategy: ' ~ strategy) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_merge_sql", "macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.materialization_incremental_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_incremental_snowflake", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\incremental.sql", "original_file_path": "macros\\materializations\\incremental.sql", "name": "materialization_incremental_snowflake", "macro_sql": "{% materialization incremental, adapter='snowflake' -%}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set target_relation = this %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(this) %}\n\n  {#-- Validate early so we don't run SQL if the strategy is invalid --#}\n  {% set strategy = dbt_snowflake_validate_get_incremental_strategy(config) -%}\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if existing_relation is none %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n\n  {% elif existing_relation.is_view %}\n    {#-- Can't overwrite a view with a table - we must drop --#}\n    {{ log(\"Dropping relation \" ~ target_relation ~ \" because it is a view and this model is a table.\") }}\n    {% do adapter.drop_relation(existing_relation) %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n\n  {% elif full_refresh_mode %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n\n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n           from_relation=tmp_relation,\n           to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n\n  {% endif %}\n\n  {%- call statement('main') -%}\n    {{ build_sql }}\n  {%- endcall -%}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set target_relation = target_relation.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.snowflake__get_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__get_merge_sql", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\merge.sql", "original_file_path": "macros\\materializations\\merge.sql", "name": "snowflake__get_merge_sql", "macro_sql": "{% macro snowflake__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) -%}\n\n    {#\n       Workaround for Snowflake not being happy with a merge on a constant-false predicate.\n       When no unique_key is provided, this macro will do a regular insert. If a unique_key\n       is provided, then this macro will do a proper merge instead.\n    #}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute='name')) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {%- set dml -%}\n    {%- if unique_key is none -%}\n\n        {{ sql_header if sql_header is not none }}\n\n        insert into {{ target }} ({{ dest_cols_csv }})\n        (\n            select {{ dest_cols_csv }}\n            from {{ source_sql }}\n        )\n\n    {%- else -%}\n\n        {{ default__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) }}\n\n    {%- endif -%}\n    {%- endset -%}\n\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.default__get_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\merge.sql", "original_file_path": "macros\\materializations\\merge.sql", "name": "snowflake__get_delete_insert_merge_sql", "macro_sql": "{% macro snowflake__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) %}\n    {% set dml = default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.snowflake__snapshot_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_merge_sql", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\merge.sql", "original_file_path": "macros\\materializations\\merge.sql", "name": "snowflake__snapshot_merge_sql", "macro_sql": "{% macro snowflake__snapshot_merge_sql(target, source, insert_cols) %}\n    {% set dml = default__snapshot_merge_sql(target, source, insert_cols) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9022744}, "macro.dbt_snowflake.snowflake__load_csv_rows": {"unique_id": "macro.dbt_snowflake.snowflake__load_csv_rows", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\seed.sql", "original_file_path": "macros\\materializations\\seed.sql", "name": "snowflake__load_csv_rows", "macro_sql": "{% macro snowflake__load_csv_rows(model, agate_table) %}\n    {% set batch_size = get_batch_size() %}\n    {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n    {% set bindings = [] %}\n\n    {% set statements = [] %}\n\n    {% for chunk in agate_table.rows | batch(batch_size) %}\n        {% set bindings = [] %}\n\n        {% for row in chunk %}\n            {% do bindings.extend(row) %}\n        {% endfor %}\n\n        {% set sql %}\n            insert into {{ this.render() }} ({{ cols_sql }}) values\n            {% for row in chunk -%}\n                ({%- for column in agate_table.column_names -%}\n                    %s\n                    {%- if not loop.last%},{%- endif %}\n                {%- endfor -%})\n                {%- if not loop.last%},{%- endif %}\n            {%- endfor %}\n        {% endset %}\n\n        {% do adapter.add_query('BEGIN', auto_begin=False) %}\n        {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n        {% do adapter.add_query('COMMIT', auto_begin=False) %}\n\n        {% if loop.index0 == 0 %}\n            {% do statements.append(sql) %}\n        {% endif %}\n    {% endfor %}\n\n    {# Return SQL so we can render it out into the compiled files #}\n    {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt_snowflake.materialization_seed_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_seed_snowflake", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\seed.sql", "original_file_path": "macros\\materializations\\seed.sql", "name": "materialization_seed_snowflake", "macro_sql": "{% materialization seed, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n\n    {% set relations = materialization_seed_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_seed_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt_snowflake.materialization_snapshot_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_snapshot_snowflake", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshot.sql", "name": "materialization_snapshot_snowflake", "macro_sql": "{% materialization snapshot, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n\n    {% set relations = materialization_snapshot_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_snapshot_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt_snowflake.materialization_table_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_table_snowflake", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\table.sql", "original_file_path": "macros\\materializations\\table.sql", "name": "materialization_table_snowflake", "macro_sql": "{% materialization table, adapter='snowflake' %}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database, type='table') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {#-- Drop the relation if it was a view to \"convert\" it in a table. This may lead to\n    -- downtime, but it should be a relatively infrequent occurrence  #}\n  {% if old_relation is not none and not old_relation.is_table %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ drop_relation_if_exists(old_relation) }}\n  {% endif %}\n\n  --build model\n  {% call statement('main') -%}\n    {{ create_table_as(false, target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt_snowflake.materialization_view_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_view_snowflake", "package_name": "dbt_snowflake", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\snowflake", "path": "macros\\materializations\\view.sql", "original_file_path": "macros\\materializations\\view.sql", "name": "materialization_view_snowflake", "macro_sql": "{% materialization view, adapter='snowflake' -%}\n\n    {% set original_query_tag = set_query_tag() %}\n    {% set to_return = create_or_replace_view() %}\n\n    {% set target_relation = this.incorporate(type='view') %}\n    {% do persist_docs(target_relation, model, for_columns=false) %}\n\n    {% do return(to_return) %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.create_or_replace_view", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9156203}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.alter_relation_add_remove_columns": {"unique_id": "macro.dbt.alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__alter_relation_add_remove_columns": {"unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\columns.sql", "original_file_path": "macros\\adapters\\columns.sql", "name": "default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation }}\n\n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter '+adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\freshness.sql", "original_file_path": "macros\\adapters\\freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.get_create_index_sql": {"unique_id": "macro.dbt.get_create_index_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__get_create_index_sql": {"unique_id": "macro.dbt.default__get_create_index_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.create_indexes": {"unique_id": "macro.dbt.create_indexes", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__create_indexes": {"unique_id": "macro.dbt.default__create_indexes", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\indexes.sql", "original_file_path": "macros\\adapters\\indexes.sql", "name": "default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9296699}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\metadata.sql", "original_file_path": "macros\\adapters\\metadata.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\persist_docs.sql", "original_file_path": "macros\\adapters\\persist_docs.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {% set tmp_identifier = base_relation.identifier ~ suffix %}\n    {% set tmp_relation = base_relation.incorporate(\n                                path={\"identifier\": tmp_identifier}) -%}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__get_or_create_relation": {"unique_id": "macro.dbt.default__get_or_create_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\relation.sql", "original_file_path": "macros\\adapters\\relation.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9453502}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\adapters\\schema.sql", "original_file_path": "macros\\adapters\\schema.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\datetime.sql", "original_file_path": "macros\\etc\\datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.960991}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "statement", "macro_sql": "{% macro statement(name=None, fetch_result=False, auto_begin=True) -%}\n  {%- if execute: -%}\n    {%- set sql = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n      {{ write(sql) }}\n    {%- endif -%}\n\n    {%- set res, table = adapter.execute(sql, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9705412}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9705412}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\etc\\statement.sql", "original_file_path": "macros\\etc\\statement.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9705412}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\accepted_values.sql", "original_file_path": "macros\\generic_test_sql\\accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9705412}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\not_null.sql", "original_file_path": "macros\\generic_test_sql\\not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9705412}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\relationships.sql", "original_file_path": "macros\\generic_test_sql\\relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.977095}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\generic_test_sql\\unique.sql", "original_file_path": "macros\\generic_test_sql\\unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9785154}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.default__generate_alias_name": {"unique_id": "macro.dbt.default__generate_alias_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_alias.sql", "original_file_path": "macros\\get_custom_name\\get_custom_alias.sql", "name": "default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_database.sql", "original_file_path": "macros\\get_custom_name\\get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.default__generate_schema_name": {"unique_id": "macro.dbt.default__generate_schema_name", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\get_custom_name\\get_custom_schema.sql", "original_file_path": "macros\\get_custom_name\\get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.should_store_failures": {"unique_id": "macro.dbt.should_store_failures", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\configs.sql", "original_file_path": "macros\\materializations\\configs.sql", "name": "should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\hooks.sql", "original_file_path": "macros\\materializations\\hooks.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9790204}, "macro.dbt.diff_columns": {"unique_id": "macro.dbt.diff_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9930713}, "macro.dbt.diff_column_data_types": {"unique_id": "macro.dbt.diff_column_data_types", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "original_file_path": "macros\\materializations\\models\\incremental\\column_helpers.sql", "name": "diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9930713}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  {% set unique_key = config.get('unique_key') %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(target_relation) %}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n  {% set backup_identifier = model['name'] + \"__dbt_backup\" %}\n\n  -- the intermediate_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {% set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier,\n                                                                  schema=schema,\n                                                                  database=database) %}\n  {% set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                            schema=schema,\n                                                            database=database) %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {# -- first check whether we want to full refresh for source view or config reasons #}\n  {% set trigger_full_refresh = (full_refresh_mode or existing_relation.is_view) %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n{% elif trigger_full_refresh %}\n      {#-- Make sure the backup doesn't exist so we don't encounter issues with the rename below #}\n      {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n      {% set backup_identifier = model['name'] + '__dbt_backup' %}\n      {% set intermediate_relation = existing_relation.incorporate(path={\"identifier\": tmp_identifier}) %}\n      {% set backup_relation = existing_relation.incorporate(path={\"identifier\": backup_identifier}) %}\n\n      {% set build_sql = create_table_as(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n      {% do to_drop.append(backup_relation) %}\n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=tmp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n  {% endif %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.get_delete_insert_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9974947}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "original_file_path": "macros\\materializations\\models\\incremental\\is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023777.9974947}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set update_columns = config.get('merge_update_columns', default = dest_columns | map(attribute=\"quoted\") | list) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{target }}\n            using {{ source }}\n            where (\n                {% for key in unique_key %}\n                    {{ source }}.{{ key }} = {{ target }}.{{ key }}\n                    {{ \"and \" if not loop.last }}\n                {% endfor %}\n            );\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select ({{ unique_key }})\n                from {{ source }}\n            );\n\n        {% endif %}\n        {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\merge.sql", "original_file_path": "macros\\materializations\\models\\incremental\\merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0090477}, "macro.dbt.incremental_validate_on_schema_change": {"unique_id": "macro.dbt.incremental_validate_on_schema_change", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.032473}, "macro.dbt.check_for_schema_changes": {"unique_id": "macro.dbt.check_for_schema_changes", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.033611}, "macro.dbt.sync_column_schemas": {"unique_id": "macro.dbt.sync_column_schemas", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.033611}, "macro.dbt.process_schema_changes": {"unique_id": "macro.dbt.process_schema_changes", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "original_file_path": "macros\\materializations\\models\\incremental\\on_schema_change.sql", "name": "process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.033611}, "macro.dbt.get_create_table_as_sql": {"unique_id": "macro.dbt.get_create_table_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.default__get_create_table_as_sql": {"unique_id": "macro.dbt.default__get_create_table_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, sql) -%}\n  {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\create_table_as.sql", "original_file_path": "macros\\materializations\\models\\table\\create_table_as.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\table\\table.sql", "original_file_path": "macros\\materializations\\models\\table\\table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type='table') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema,\n                                                      database=database,\n                                                      type='table') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier,\n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if old_relation is not none %}\n      {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "original_file_path": "macros\\materializations\\models\\view\\create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.get_create_view_as_sql": {"unique_id": "macro.dbt.get_create_view_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.default__get_create_view_as_sql": {"unique_id": "macro.dbt.default__get_create_view_as_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\create_view_as.sql", "original_file_path": "macros\\materializations\\models\\view\\create_view_as.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0406806}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.056356}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\helpers.sql", "original_file_path": "macros\\materializations\\models\\view\\helpers.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.056356}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\models\\view\\view.sql", "original_file_path": "macros\\materializations\\models\\view\\view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, database=database,\n                                                type='view') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema, database=database, type='view') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier,\n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"old_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the old_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the old_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema, database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_view_as(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if old_relation is not none %}\n    {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_view_as", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.056356}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.056356}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.get_binding_char": {"unique_id": "macro.dbt.get_binding_char", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.default__get_binding_char": {"unique_id": "macro.dbt.default__get_binding_char", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.get_batch_size": {"unique_id": "macro.dbt.get_batch_size", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.default__get_batch_size": {"unique_id": "macro.dbt.default__get_batch_size", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\helpers.sql", "original_file_path": "macros\\materializations\\seeds\\helpers.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\seeds\\seed.sql", "original_file_path": "macros\\materializations\\seeds\\seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set agate_table = load_agate_table() -%}\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ create_table_sql }};\n    -- dbt seed --\n    {{ sql }}\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0724542}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.get_true_sql": {"unique_id": "macro.dbt.get_true_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.default__get_true_sql": {"unique_id": "macro.dbt.default__get_true_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.default__snapshot_staging_table": {"unique_id": "macro.dbt.default__snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n\n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.default__build_snapshot_table": {"unique_id": "macro.dbt.default__build_snapshot_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\helpers.sql", "original_file_path": "macros\\materializations\\snapshots\\helpers.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set tmp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, tmp_relation, select) }}\n    {% endcall %}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.0881295}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_sql']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "original_file_path": "macros\\materializations\\snapshots\\snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_get_time", "macro_sql": "{% macro snapshot_get_time() -%}\n  {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() -%}\n  {{ current_timestamp() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1037545}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists) -%}\n    {%- set query_columns = get_columns_in_query(node['compiled_sql']) -%}\n    {%- if not target_exists -%}\n        {# no table yet -> return whatever the query does #}\n        {{ return([false, query_columns]) }}\n    {%- endif -%}\n    {# handle any schema changes #}\n    {%- set target_table = node.get('alias', node.get('name')) -%}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=target_table) -%}\n    {%- set existing_cols = get_columns_in_query('select * from ' ~ target_relation) -%}\n    {%- set ns = namespace() -%} {# handle for-loop scoping with a namespace #}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(col) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return([ns.column_added, intersection]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\snapshots\\strategies.sql", "original_file_path": "macros\\materializations\\snapshots\\strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    {% set updated_at = config.get('updated_at', snapshot_get_time()) %}\n\n    {% set column_added = false %}\n\n    {% if check_cols_config == 'all' %}\n        {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists) %}\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {% set check_cols = check_cols_config %}\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.get_test_sql": {"unique_id": "macro.dbt.get_test_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.default__get_test_sql": {"unique_id": "macro.dbt.default__get_test_sql", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\helpers.sql", "original_file_path": "macros\\materializations\\tests\\helpers.sql", "name": "default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.materialization_test_default": {"unique_id": "macro.dbt.materialization_test_default", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\test.sql", "original_file_path": "macros\\materializations\\tests\\test.sql", "name": "materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql %}\n\n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.get_where_subquery": {"unique_id": "macro.dbt.get_where_subquery", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.default__get_where_subquery": {"unique_id": "macro.dbt.default__get_where_subquery", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "macros\\materializations\\tests\\where_subquery.sql", "original_file_path": "macros\\materializations\\tests\\where_subquery.sql", "name": "default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1193836}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.135015}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "tests\\generic\\builtin.sql", "original_file_path": "tests\\generic\\builtin.sql", "name": "test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.135015}, "macro.codegen.generate_base_model": {"unique_id": "macro.codegen.generate_base_model", "package_name": "codegen", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\codegen", "path": "macros\\generate_base_model.sql", "original_file_path": "macros\\generate_base_model.sql", "name": "generate_base_model", "macro_sql": "{% macro generate_base_model(source_name, table_name, leading_commas=False) %}\n\n{%- set source_relation = source(source_name, table_name) -%}\n\n{%- set columns = adapter.get_columns_in_relation(source_relation) -%}\n{% set column_names=columns | map(attribute='name') %}\n{% set base_model_sql %}\nwith source as (\n\n    select * from {% raw %}{{ source({% endraw %}'{{ source_name }}', '{{ table_name }}'{% raw %}) }}{% endraw %}\n\n),\n\nrenamed as (\n\n    select\n        {%- if leading_commas -%}\n        {%- for column in column_names %}\n        {{\", \" if not loop.first}}{{ column | lower }}\n        {%- endfor %}\n        {%- else -%}\n        {%- for column in column_names %}\n        {{ column | lower }}{{\",\" if not loop.last}}\n        {%- endfor -%}\n        {%- endif %}\n\n    from source\n\n)\n\nselect * from renamed\n{% endset %}\n\n{% if execute %}\n\n{{ log(base_model_sql, info=True) }}\n{% do return(base_model_sql) %}\n\n{% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.codegen.generate_model_yaml": {"unique_id": "macro.codegen.generate_model_yaml", "package_name": "codegen", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\codegen", "path": "macros\\generate_model_yaml.sql", "original_file_path": "macros\\generate_model_yaml.sql", "name": "generate_model_yaml", "macro_sql": "{% macro generate_model_yaml(model_name) %}\n\n{% set model_yaml=[] %}\n\n{% do model_yaml.append('version: 2') %}\n{% do model_yaml.append('') %}\n{% do model_yaml.append('models:') %}\n{% do model_yaml.append('  - name: ' ~ model_name | lower) %}\n{% do model_yaml.append('    description: \"\"') %}\n{% do model_yaml.append('    columns:') %}\n\n{% set relation=ref(model_name) %}\n{%- set columns = adapter.get_columns_in_relation(relation) -%}\n\n{% for column in columns %}\n    {% do model_yaml.append('      - name: ' ~ column.name | lower ) %}\n    {% do model_yaml.append('        description: \"\"') %}\n    {% do model_yaml.append('') %}\n{% endfor %}\n\n{% if execute %}\n\n    {% set joined = model_yaml | join ('\\n') %}\n    {{ log(joined, info=True) }}\n    {% do return(joined) %}\n\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.codegen.get_tables_in_schema": {"unique_id": "macro.codegen.get_tables_in_schema", "package_name": "codegen", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\codegen", "path": "macros\\generate_source.sql", "original_file_path": "macros\\generate_source.sql", "name": "get_tables_in_schema", "macro_sql": "{% macro get_tables_in_schema(schema_name, database_name=target.database, table_pattern='%', exclude='') %}\n    \n    {% set tables=dbt_utils.get_relations_by_pattern(\n        schema_pattern=schema_name,\n        database=database_name,\n        table_pattern=table_pattern,\n        exclude=exclude\n    ) %}\n\n    {% set table_list= tables | map(attribute='identifier') %}\n\n    {{ return(table_list | sort) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.codegen.generate_source": {"unique_id": "macro.codegen.generate_source", "package_name": "codegen", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\codegen", "path": "macros\\generate_source.sql", "original_file_path": "macros\\generate_source.sql", "name": "generate_source", "macro_sql": "{% macro generate_source(schema_name, database_name=target.database, generate_columns=False, include_descriptions=False, table_pattern='%', exclude='') %}\n\n{% set sources_yaml=[] %}\n\n{% do sources_yaml.append('version: 2') %}\n{% do sources_yaml.append('') %}\n{% do sources_yaml.append('sources:') %}\n{% do sources_yaml.append('  - name: ' ~ schema_name | lower) %}\n\n{% if database_name != target.database %}\n{% do sources_yaml.append('    database: ' ~ database_name | lower) %}\n{% endif %}\n\n{% do sources_yaml.append('    tables:') %}\n\n{% set tables=codegen.get_tables_in_schema(schema_name, database_name, table_pattern, exclude) %}\n\n{% for table in tables %}\n    {% do sources_yaml.append('      - name: ' ~ table | lower ) %}\n\n    {% if generate_columns %}\n    {% do sources_yaml.append('        columns:') %}\n\n        {% set table_relation=api.Relation.create(\n            database=database_name,\n            schema=schema_name,\n            identifier=table\n        ) %}\n\n        {% set columns=adapter.get_columns_in_relation(table_relation) %}\n\n        {% for column in columns %}\n            {% do sources_yaml.append('          - name: ' ~ column.name | lower ) %}\n            {% if include_descriptions %}\n                {% do sources_yaml.append('            description: \"\"' ) %}\n            {% endif %}\n        {% endfor %}\n            {% do sources_yaml.append('') %}\n\n    {% endif %}\n\n{% endfor %}\n\n{% if execute %}\n\n    {% set joined = sources_yaml | join ('\\n') %}\n    {{ log(joined, info=True) }}\n    {% do return(joined) %}\n\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.codegen.get_tables_in_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.dbt_utils.any_value": {"unique_id": "macro.dbt_utils.any_value", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\any_value.sql", "original_file_path": "macros\\cross_db_utils\\any_value.sql", "name": "any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__any_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.dbt_utils.default__any_value": {"unique_id": "macro.dbt_utils.default__any_value", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\any_value.sql", "original_file_path": "macros\\cross_db_utils\\any_value.sql", "name": "default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n    \n    any_value({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.dbt_utils.postgres__any_value": {"unique_id": "macro.dbt_utils.postgres__any_value", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\any_value.sql", "original_file_path": "macros\\cross_db_utils\\any_value.sql", "name": "postgres__any_value", "macro_sql": "{% macro postgres__any_value(expression) -%}\n    {#- /*Postgres doesn't support any_value, so we're using min() to get the same result*/ -#}\n    min({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1369874}, "macro.dbt_utils.array_append": {"unique_id": "macro.dbt_utils.array_append", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_append.sql", "original_file_path": "macros\\cross_db_utils\\array_append.sql", "name": "array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {{ return(adapter.dispatch('array_append', 'dbt_utils')(array, new_element)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__array_append"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1510384}, "macro.dbt_utils.default__array_append": {"unique_id": "macro.dbt_utils.default__array_append", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_append.sql", "original_file_path": "macros\\cross_db_utils\\array_append.sql", "name": "default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1517584}, "macro.dbt_utils.bigquery__array_append": {"unique_id": "macro.dbt_utils.bigquery__array_append", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_append.sql", "original_file_path": "macros\\cross_db_utils\\array_append.sql", "name": "bigquery__array_append", "macro_sql": "{% macro bigquery__array_append(array, new_element) -%}\n    {{ dbt_utils.array_concat(array, dbt_utils.array_construct([new_element])) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.array_concat", "macro.dbt_utils.array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1528232}, "macro.dbt_utils.redshift__array_append": {"unique_id": "macro.dbt_utils.redshift__array_append", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_append.sql", "original_file_path": "macros\\cross_db_utils\\array_append.sql", "name": "redshift__array_append", "macro_sql": "{% macro redshift__array_append(array, new_element) -%}\n    {{ dbt_utils.array_concat(array, dbt_utils.array_construct([new_element])) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.array_concat", "macro.dbt_utils.array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1533294}, "macro.dbt_utils.array_concat": {"unique_id": "macro.dbt_utils.array_concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_concat.sql", "original_file_path": "macros\\cross_db_utils\\array_concat.sql", "name": "array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {{ return(adapter.dispatch('array_concat', 'dbt_utils')(array_1, array_2)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.default__array_concat": {"unique_id": "macro.dbt_utils.default__array_concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_concat.sql", "original_file_path": "macros\\cross_db_utils\\array_concat.sql", "name": "default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.bigquery__array_concat": {"unique_id": "macro.dbt_utils.bigquery__array_concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_concat.sql", "original_file_path": "macros\\cross_db_utils\\array_concat.sql", "name": "bigquery__array_concat", "macro_sql": "{% macro bigquery__array_concat(array_1, array_2) -%}\n    array_concat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.redshift__array_concat": {"unique_id": "macro.dbt_utils.redshift__array_concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_concat.sql", "original_file_path": "macros\\cross_db_utils\\array_concat.sql", "name": "redshift__array_concat", "macro_sql": "{% macro redshift__array_concat(array_1, array_2) -%}\n    array_concat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.array_construct": {"unique_id": "macro.dbt_utils.array_construct", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_construct.sql", "original_file_path": "macros\\cross_db_utils\\array_construct.sql", "name": "array_construct", "macro_sql": "{% macro array_construct(inputs = [], data_type = api.Column.translate_type('integer')) -%}\n  {{ return(adapter.dispatch('array_construct', 'dbt_utils')(inputs, data_type)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.default__array_construct": {"unique_id": "macro.dbt_utils.default__array_construct", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_construct.sql", "original_file_path": "macros\\cross_db_utils\\array_construct.sql", "name": "default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.snowflake__array_construct": {"unique_id": "macro.dbt_utils.snowflake__array_construct", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_construct.sql", "original_file_path": "macros\\cross_db_utils\\array_construct.sql", "name": "snowflake__array_construct", "macro_sql": "{% macro snowflake__array_construct(inputs, data_type) -%}\n    array_construct( {{ inputs|join(' , ') }} )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.redshift__array_construct": {"unique_id": "macro.dbt_utils.redshift__array_construct", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_construct.sql", "original_file_path": "macros\\cross_db_utils\\array_construct.sql", "name": "redshift__array_construct", "macro_sql": "{% macro redshift__array_construct(inputs, data_type) -%}\n    array( {{ inputs|join(' , ') }} )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1549366}, "macro.dbt_utils.bigquery__array_construct": {"unique_id": "macro.dbt_utils.bigquery__array_construct", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\array_construct.sql", "original_file_path": "macros\\cross_db_utils\\array_construct.sql", "name": "bigquery__array_construct", "macro_sql": "{% macro bigquery__array_construct(inputs, data_type) -%}\n    [ {{ inputs|join(' , ') }} ]\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.159445}, "macro.dbt_utils.bool_or": {"unique_id": "macro.dbt_utils.bool_or", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\bool_or.sql", "original_file_path": "macros\\cross_db_utils\\bool_or.sql", "name": "bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.159445}, "macro.dbt_utils.default__bool_or": {"unique_id": "macro.dbt_utils.default__bool_or", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\bool_or.sql", "original_file_path": "macros\\cross_db_utils\\bool_or.sql", "name": "default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n    \n    bool_or({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.159445}, "macro.dbt_utils.snowflake__bool_or": {"unique_id": "macro.dbt_utils.snowflake__bool_or", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\bool_or.sql", "original_file_path": "macros\\cross_db_utils\\bool_or.sql", "name": "snowflake__bool_or", "macro_sql": "{% macro snowflake__bool_or(expression) -%}\n    \n    boolor_agg({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.159445}, "macro.dbt_utils.bigquery__bool_or": {"unique_id": "macro.dbt_utils.bigquery__bool_or", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\bool_or.sql", "original_file_path": "macros\\cross_db_utils\\bool_or.sql", "name": "bigquery__bool_or", "macro_sql": "{% macro bigquery__bool_or(expression) -%}\n    \n    logical_or({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.159445}, "macro.dbt_utils.cast_array_to_string": {"unique_id": "macro.dbt_utils.cast_array_to_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_array_to_string.sql", "original_file_path": "macros\\cross_db_utils\\cast_array_to_string.sql", "name": "cast_array_to_string", "macro_sql": "{% macro cast_array_to_string(array) %}\n  {{ adapter.dispatch('cast_array_to_string', 'dbt_utils') (array) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__cast_array_to_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.default__cast_array_to_string": {"unique_id": "macro.dbt_utils.default__cast_array_to_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_array_to_string.sql", "original_file_path": "macros\\cross_db_utils\\cast_array_to_string.sql", "name": "default__cast_array_to_string", "macro_sql": "{% macro default__cast_array_to_string(array) %}\n    cast({{ array }} as {{ dbt_utils.type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.postgres__cast_array_to_string": {"unique_id": "macro.dbt_utils.postgres__cast_array_to_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_array_to_string.sql", "original_file_path": "macros\\cross_db_utils\\cast_array_to_string.sql", "name": "postgres__cast_array_to_string", "macro_sql": "{% macro postgres__cast_array_to_string(array) %}\n    {%- set array_as_string -%}cast({{ array }} as {{ dbt_utils.type_string() }}){%- endset -%}\n    {{ dbt_utils.replace(dbt_utils.replace(array_as_string,\"'}'\",\"']'\"),\"'{'\",\"'['\") }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.redshift__cast_array_to_string": {"unique_id": "macro.dbt_utils.redshift__cast_array_to_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_array_to_string.sql", "original_file_path": "macros\\cross_db_utils\\cast_array_to_string.sql", "name": "redshift__cast_array_to_string", "macro_sql": "{% macro redshift__cast_array_to_string(array) %}\n    cast({{ array }} as {{ dbt_utils.type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.bigquery__cast_array_to_string": {"unique_id": "macro.dbt_utils.bigquery__cast_array_to_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_array_to_string.sql", "original_file_path": "macros\\cross_db_utils\\cast_array_to_string.sql", "name": "bigquery__cast_array_to_string", "macro_sql": "{% macro bigquery__cast_array_to_string(array) %}\n    '['||(select string_agg(cast(element as string), ',') from unnest({{ array }}) element)||']'\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.cast_bool_to_text": {"unique_id": "macro.dbt_utils.cast_bool_to_text", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "original_file_path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "name": "cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt_utils') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.163909}, "macro.dbt_utils.default__cast_bool_to_text": {"unique_id": "macro.dbt_utils.default__cast_bool_to_text", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "original_file_path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "name": "default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ dbt_utils.type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1679208}, "macro.dbt_utils.redshift__cast_bool_to_text": {"unique_id": "macro.dbt_utils.redshift__cast_bool_to_text", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "original_file_path": "macros\\cross_db_utils\\cast_bool_to_text.sql", "name": "redshift__cast_bool_to_text", "macro_sql": "{% macro redshift__cast_bool_to_text(field) %}\n    case\n        when {{ field }} is true then 'true'\n        when {{ field }} is false then 'false'\n    end::text\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1679208}, "macro.dbt_utils.concat": {"unique_id": "macro.dbt_utils.concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\concat.sql", "original_file_path": "macros\\cross_db_utils\\concat.sql", "name": "concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt_utils')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1679208}, "macro.dbt_utils.default__concat": {"unique_id": "macro.dbt_utils.default__concat", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\concat.sql", "original_file_path": "macros\\cross_db_utils\\concat.sql", "name": "default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1679208}, "macro.dbt_utils.current_timestamp": {"unique_id": "macro.dbt_utils.current_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ return(adapter.dispatch('current_timestamp', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.default__current_timestamp": {"unique_id": "macro.dbt_utils.default__current_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() %}\n    current_timestamp::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.redshift__current_timestamp": {"unique_id": "macro.dbt_utils.redshift__current_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "redshift__current_timestamp", "macro_sql": "{% macro redshift__current_timestamp() %}\n    getdate()\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.bigquery__current_timestamp": {"unique_id": "macro.dbt_utils.bigquery__current_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "bigquery__current_timestamp", "macro_sql": "{% macro bigquery__current_timestamp() %}\n    current_timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "current_timestamp_in_utc", "macro_sql": "{% macro current_timestamp_in_utc() -%}\n  {{ return(adapter.dispatch('current_timestamp_in_utc', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.default__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.default__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "default__current_timestamp_in_utc", "macro_sql": "{% macro default__current_timestamp_in_utc() %}\n    {{dbt_utils.current_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.snowflake__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.snowflake__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "snowflake__current_timestamp_in_utc", "macro_sql": "{% macro snowflake__current_timestamp_in_utc() %}\n    convert_timezone('UTC', {{dbt_utils.current_timestamp()}})::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp", "macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.postgres__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.postgres__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "postgres__current_timestamp_in_utc", "macro_sql": "{% macro postgres__current_timestamp_in_utc() %}\n    (current_timestamp at time zone 'utc')::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.redshift__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.redshift__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\current_timestamp.sql", "original_file_path": "macros\\cross_db_utils\\current_timestamp.sql", "name": "redshift__current_timestamp_in_utc", "macro_sql": "{% macro redshift__current_timestamp_in_utc() %}\n    {{ return(dbt_utils.default__current_timestamp_in_utc()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1709275}, "macro.dbt_utils.type_string": {"unique_id": "macro.dbt_utils.type_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_string": {"unique_id": "macro.dbt_utils.default__type_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_string", "macro_sql": "{% macro default__type_string() %}\n    string\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.redshift__type_string": {"unique_id": "macro.dbt_utils.redshift__type_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "redshift__type_string", "macro_sql": "\n\n{%- macro redshift__type_string() -%}\n    varchar\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.postgres__type_string": {"unique_id": "macro.dbt_utils.postgres__type_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "postgres__type_string", "macro_sql": "{% macro postgres__type_string() %}\n    varchar\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.snowflake__type_string": {"unique_id": "macro.dbt_utils.snowflake__type_string", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "snowflake__type_string", "macro_sql": "{% macro snowflake__type_string() %}\n    varchar\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.type_timestamp": {"unique_id": "macro.dbt_utils.type_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_timestamp": {"unique_id": "macro.dbt_utils.default__type_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.postgres__type_timestamp": {"unique_id": "macro.dbt_utils.postgres__type_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "postgres__type_timestamp", "macro_sql": "{% macro postgres__type_timestamp() %}\n    timestamp without time zone\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.snowflake__type_timestamp": {"unique_id": "macro.dbt_utils.snowflake__type_timestamp", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "snowflake__type_timestamp", "macro_sql": "{% macro snowflake__type_timestamp() %}\n    timestamp_ntz\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.type_float": {"unique_id": "macro.dbt_utils.type_float", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_float": {"unique_id": "macro.dbt_utils.default__type_float", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_float", "macro_sql": "{% macro default__type_float() %}\n    float\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.bigquery__type_float": {"unique_id": "macro.dbt_utils.bigquery__type_float", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "bigquery__type_float", "macro_sql": "{% macro bigquery__type_float() %}\n    float64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.type_numeric": {"unique_id": "macro.dbt_utils.type_numeric", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_numeric": {"unique_id": "macro.dbt_utils.default__type_numeric", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    numeric(28, 6)\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.bigquery__type_numeric": {"unique_id": "macro.dbt_utils.bigquery__type_numeric", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "bigquery__type_numeric", "macro_sql": "{% macro bigquery__type_numeric() %}\n    numeric\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.type_bigint": {"unique_id": "macro.dbt_utils.type_bigint", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_bigint": {"unique_id": "macro.dbt_utils.default__type_bigint", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    bigint\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.bigquery__type_bigint": {"unique_id": "macro.dbt_utils.bigquery__type_bigint", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "bigquery__type_bigint", "macro_sql": "{% macro bigquery__type_bigint() %}\n    int64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.type_int": {"unique_id": "macro.dbt_utils.type_int", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.default__type_int": {"unique_id": "macro.dbt_utils.default__type_int", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "default__type_int", "macro_sql": "{% macro default__type_int() %}\n    int\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.bigquery__type_int": {"unique_id": "macro.dbt_utils.bigquery__type_int", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datatypes.sql", "original_file_path": "macros\\cross_db_utils\\datatypes.sql", "name": "bigquery__type_int", "macro_sql": "{% macro bigquery__type_int() %}\n    int64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1746414}, "macro.dbt_utils.dateadd": {"unique_id": "macro.dbt_utils.dateadd", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\dateadd.sql", "original_file_path": "macros\\cross_db_utils\\dateadd.sql", "name": "dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt_utils')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.181851}, "macro.dbt_utils.default__dateadd": {"unique_id": "macro.dbt_utils.default__dateadd", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\dateadd.sql", "original_file_path": "macros\\cross_db_utils\\dateadd.sql", "name": "default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.181851}, "macro.dbt_utils.bigquery__dateadd": {"unique_id": "macro.dbt_utils.bigquery__dateadd", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\dateadd.sql", "original_file_path": "macros\\cross_db_utils\\dateadd.sql", "name": "bigquery__dateadd", "macro_sql": "{% macro bigquery__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n        datetime_add(\n            cast( {{ from_date_or_timestamp }} as datetime),\n        interval {{ interval }} {{ datepart }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.182395}, "macro.dbt_utils.postgres__dateadd": {"unique_id": "macro.dbt_utils.postgres__dateadd", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\dateadd.sql", "original_file_path": "macros\\cross_db_utils\\dateadd.sql", "name": "postgres__dateadd", "macro_sql": "{% macro postgres__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ from_date_or_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.182395}, "macro.dbt_utils.redshift__dateadd": {"unique_id": "macro.dbt_utils.redshift__dateadd", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\dateadd.sql", "original_file_path": "macros\\cross_db_utils\\dateadd.sql", "name": "redshift__dateadd", "macro_sql": "{% macro redshift__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ return(dbt_utils.default__dateadd(datepart, interval, from_date_or_timestamp)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.182395}, "macro.dbt_utils.datediff": {"unique_id": "macro.dbt_utils.datediff", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datediff.sql", "original_file_path": "macros\\cross_db_utils\\datediff.sql", "name": "datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt_utils')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.default__datediff": {"unique_id": "macro.dbt_utils.default__datediff", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datediff.sql", "original_file_path": "macros\\cross_db_utils\\datediff.sql", "name": "default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.bigquery__datediff": {"unique_id": "macro.dbt_utils.bigquery__datediff", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datediff.sql", "original_file_path": "macros\\cross_db_utils\\datediff.sql", "name": "bigquery__datediff", "macro_sql": "{% macro bigquery__datediff(first_date, second_date, datepart) -%}\n\n    datetime_diff(\n        cast({{second_date}} as datetime),\n        cast({{first_date}} as datetime),\n        {{datepart}}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.postgres__datediff": {"unique_id": "macro.dbt_utils.postgres__datediff", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datediff.sql", "original_file_path": "macros\\cross_db_utils\\datediff.sql", "name": "postgres__datediff", "macro_sql": "{% macro postgres__datediff(first_date, second_date, datepart) -%}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.redshift__datediff": {"unique_id": "macro.dbt_utils.redshift__datediff", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\datediff.sql", "original_file_path": "macros\\cross_db_utils\\datediff.sql", "name": "redshift__datediff", "macro_sql": "{% macro redshift__datediff(first_date, second_date, datepart) -%}\n\n    {{ return(dbt_utils.default__datediff(first_date, second_date, datepart)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.date_trunc": {"unique_id": "macro.dbt_utils.date_trunc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\date_trunc.sql", "original_file_path": "macros\\cross_db_utils\\date_trunc.sql", "name": "date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt_utils') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1857977}, "macro.dbt_utils.default__date_trunc": {"unique_id": "macro.dbt_utils.default__date_trunc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\date_trunc.sql", "original_file_path": "macros\\cross_db_utils\\date_trunc.sql", "name": "default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1970694}, "macro.dbt_utils.bigquery__date_trunc": {"unique_id": "macro.dbt_utils.bigquery__date_trunc", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\date_trunc.sql", "original_file_path": "macros\\cross_db_utils\\date_trunc.sql", "name": "bigquery__date_trunc", "macro_sql": "{% macro bigquery__date_trunc(datepart, date) -%}\n    timestamp_trunc(\n        cast({{date}} as timestamp),\n        {{datepart}}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1976128}, "macro.dbt_utils.escape_single_quotes": {"unique_id": "macro.dbt_utils.escape_single_quotes", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\escape_single_quotes.sql", "original_file_path": "macros\\cross_db_utils\\escape_single_quotes.sql", "name": "escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__escape_single_quotes": {"unique_id": "macro.dbt_utils.default__escape_single_quotes", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\escape_single_quotes.sql", "original_file_path": "macros\\cross_db_utils\\escape_single_quotes.sql", "name": "default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.snowflake__escape_single_quotes": {"unique_id": "macro.dbt_utils.snowflake__escape_single_quotes", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\escape_single_quotes.sql", "original_file_path": "macros\\cross_db_utils\\escape_single_quotes.sql", "name": "snowflake__escape_single_quotes", "macro_sql": "{% macro snowflake__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\", \"\\\\'\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.bigquery__escape_single_quotes": {"unique_id": "macro.dbt_utils.bigquery__escape_single_quotes", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\escape_single_quotes.sql", "original_file_path": "macros\\cross_db_utils\\escape_single_quotes.sql", "name": "bigquery__escape_single_quotes", "macro_sql": "{% macro bigquery__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\", \"\\\\'\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.except": {"unique_id": "macro.dbt_utils.except", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\except.sql", "original_file_path": "macros\\cross_db_utils\\except.sql", "name": "except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__except": {"unique_id": "macro.dbt_utils.default__except", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\except.sql", "original_file_path": "macros\\cross_db_utils\\except.sql", "name": "default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.bigquery__except": {"unique_id": "macro.dbt_utils.bigquery__except", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\except.sql", "original_file_path": "macros\\cross_db_utils\\except.sql", "name": "bigquery__except", "macro_sql": "{% macro bigquery__except() %}\n\n    except distinct\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.hash": {"unique_id": "macro.dbt_utils.hash", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\hash.sql", "original_file_path": "macros\\cross_db_utils\\hash.sql", "name": "hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt_utils') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__hash": {"unique_id": "macro.dbt_utils.default__hash", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\hash.sql", "original_file_path": "macros\\cross_db_utils\\hash.sql", "name": "default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{field}} as {{dbt_utils.type_string()}}))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.bigquery__hash": {"unique_id": "macro.dbt_utils.bigquery__hash", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\hash.sql", "original_file_path": "macros\\cross_db_utils\\hash.sql", "name": "bigquery__hash", "macro_sql": "{% macro bigquery__hash(field) -%}\n    to_hex({{dbt_utils.default__hash(field)}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.identifier": {"unique_id": "macro.dbt_utils.identifier", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\identifier.sql", "original_file_path": "macros\\cross_db_utils\\identifier.sql", "name": "identifier", "macro_sql": "{% macro identifier(value) %}\t\n  {%- set error_message = '\n    Warning: the `identifier` macro is no longer supported and will be deprecated in a future release of dbt-utils. \\\n    Use `adapter.quote` instead. The {}.{} model triggered this warning. \\\n    '.format(model.package_name, model.name) -%}\n  {%- do exceptions.warn(error_message) -%}\n  {{ return(adapter.dispatch('identifier', 'dbt_utils') (value)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__identifier"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__identifier": {"unique_id": "macro.dbt_utils.default__identifier", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\identifier.sql", "original_file_path": "macros\\cross_db_utils\\identifier.sql", "name": "default__identifier", "macro_sql": "{% macro default__identifier(value) -%}\t\n    \"{{ value }}\"\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.bigquery__identifier": {"unique_id": "macro.dbt_utils.bigquery__identifier", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\identifier.sql", "original_file_path": "macros\\cross_db_utils\\identifier.sql", "name": "bigquery__identifier", "macro_sql": "{% macro bigquery__identifier(value) -%}\t\n    `{{ value }}`\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.intersect": {"unique_id": "macro.dbt_utils.intersect", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\intersect.sql", "original_file_path": "macros\\cross_db_utils\\intersect.sql", "name": "intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__intersect": {"unique_id": "macro.dbt_utils.default__intersect", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\intersect.sql", "original_file_path": "macros\\cross_db_utils\\intersect.sql", "name": "default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.bigquery__intersect": {"unique_id": "macro.dbt_utils.bigquery__intersect", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\intersect.sql", "original_file_path": "macros\\cross_db_utils\\intersect.sql", "name": "bigquery__intersect", "macro_sql": "{% macro bigquery__intersect() %}\n\n    intersect distinct\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.last_day": {"unique_id": "macro.dbt_utils.last_day", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\last_day.sql", "original_file_path": "macros\\cross_db_utils\\last_day.sql", "name": "last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt_utils') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default_last_day": {"unique_id": "macro.dbt_utils.default_last_day", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\last_day.sql", "original_file_path": "macros\\cross_db_utils\\last_day.sql", "name": "default_last_day", "macro_sql": "\n\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt_utils.dateadd('day', '-1',\n        dbt_utils.dateadd(datepart, '1', dbt_utils.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.default__last_day": {"unique_id": "macro.dbt_utils.default__last_day", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\last_day.sql", "original_file_path": "macros\\cross_db_utils\\last_day.sql", "name": "default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt_utils.default_last_day(date, datepart)}}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.postgres__last_day": {"unique_id": "macro.dbt_utils.postgres__last_day", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\last_day.sql", "original_file_path": "macros\\cross_db_utils\\last_day.sql", "name": "postgres__last_day", "macro_sql": "{% macro postgres__last_day(date, datepart) -%}\n\n    {%- if datepart == 'quarter' -%}\n    -- postgres dateadd does not support quarter interval.\n    cast(\n        {{dbt_utils.dateadd('day', '-1',\n        dbt_utils.dateadd('month', '3', dbt_utils.date_trunc(datepart, date))\n        )}}\n        as date)\n    {%- else -%}\n    {{dbt_utils.default_last_day(date, datepart)}}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc", "macro.dbt_utils.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.redshift__last_day": {"unique_id": "macro.dbt_utils.redshift__last_day", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\last_day.sql", "original_file_path": "macros\\cross_db_utils\\last_day.sql", "name": "redshift__last_day", "macro_sql": "{% macro redshift__last_day(date, datepart) %}\n\n    {{ return(dbt_utils.default__last_day(date, datepart)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.1991148}, "macro.dbt_utils.length": {"unique_id": "macro.dbt_utils.length", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\length.sql", "original_file_path": "macros\\cross_db_utils\\length.sql", "name": "length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__length"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.default__length": {"unique_id": "macro.dbt_utils.default__length", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\length.sql", "original_file_path": "macros\\cross_db_utils\\length.sql", "name": "default__length", "macro_sql": "{% macro default__length(expression) %}\n    \n    length(\n        {{ expression }}\n    )\n    \n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.redshift__length": {"unique_id": "macro.dbt_utils.redshift__length", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\length.sql", "original_file_path": "macros\\cross_db_utils\\length.sql", "name": "redshift__length", "macro_sql": "{% macro redshift__length(expression) %}\n\n    len(\n        {{ expression }}\n    )\n    \n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.listagg": {"unique_id": "macro.dbt_utils.listagg", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\listagg.sql", "original_file_path": "macros\\cross_db_utils\\listagg.sql", "name": "listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt_utils') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__listagg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.default__listagg": {"unique_id": "macro.dbt_utils.default__listagg", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\listagg.sql", "original_file_path": "macros\\cross_db_utils\\listagg.sql", "name": "default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.bigquery__listagg": {"unique_id": "macro.dbt_utils.bigquery__listagg", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\listagg.sql", "original_file_path": "macros\\cross_db_utils\\listagg.sql", "name": "bigquery__listagg", "macro_sql": "{% macro bigquery__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    string_agg(\n        {{ measure }},\n        {{ delimiter_text }}\n        {% if order_by_clause -%}\n        {{ order_by_clause }}\n        {%- endif %}\n        {% if limit_num -%}\n        limit {{ limit_num }}\n        {%- endif %}\n        )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.postgres__listagg": {"unique_id": "macro.dbt_utils.postgres__listagg", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\listagg.sql", "original_file_path": "macros\\cross_db_utils\\listagg.sql", "name": "postgres__listagg", "macro_sql": "{% macro postgres__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n    \n    {% if limit_num -%}\n    array_to_string(\n        (array_agg(\n            {{ measure }}\n            {% if order_by_clause -%}\n            {{ order_by_clause }}\n            {%- endif %}\n        ))[1:{{ limit_num }}],\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    string_agg(\n        {{ measure }},\n        {{ delimiter_text }}\n        {% if order_by_clause -%}\n        {{ order_by_clause }}\n        {%- endif %}\n        )\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.redshift__listagg": {"unique_id": "macro.dbt_utils.redshift__listagg", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\listagg.sql", "original_file_path": "macros\\cross_db_utils\\listagg.sql", "name": "redshift__listagg", "macro_sql": "{% macro redshift__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    {% set ns = namespace() %}\n    {% set ns.delimiter_text_regex = delimiter_text|trim(\"'\") %}\n    {% set special_chars %}\\,^,$,.,|,?,*,+,(,),[,],{,}{% endset %}  \n    {%- for char in special_chars.split(',') -%}\n        {% set escape_char %}\\\\{{ char }}{% endset %}\n        {% set ns.delimiter_text_regex = ns.delimiter_text_regex|replace(char,escape_char) %}\n    {%- endfor -%}\n\n    {% set regex %}'([^{{ ns.delimiter_text_regex }}]+{{ ns.delimiter_text_regex }}){1,{{ limit_num - 1}}}[^{{ ns.delimiter_text_regex }}]+'{% endset %}\n    regexp_substr(\n        listagg(\n            {{ measure }},\n            {{ delimiter_text }}\n            )\n            {% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n        ,{{ regex }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.string_literal": {"unique_id": "macro.dbt_utils.string_literal", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\literal.sql", "original_file_path": "macros\\cross_db_utils\\literal.sql", "name": "string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt_utils') (value)) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.default__string_literal": {"unique_id": "macro.dbt_utils.default__string_literal", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\literal.sql", "original_file_path": "macros\\cross_db_utils\\literal.sql", "name": "default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.214751}, "macro.dbt_utils.position": {"unique_id": "macro.dbt_utils.position", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\position.sql", "original_file_path": "macros\\cross_db_utils\\position.sql", "name": "position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt_utils') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__position"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.default__position": {"unique_id": "macro.dbt_utils.default__position", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\position.sql", "original_file_path": "macros\\cross_db_utils\\position.sql", "name": "default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n    \n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.bigquery__position": {"unique_id": "macro.dbt_utils.bigquery__position", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\position.sql", "original_file_path": "macros\\cross_db_utils\\position.sql", "name": "bigquery__position", "macro_sql": "{% macro bigquery__position(substring_text, string_text) %}\n\n    strpos(\n        {{ string_text }},\n        {{ substring_text }}\n        \n    )\n    \n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.replace": {"unique_id": "macro.dbt_utils.replace", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\replace.sql", "original_file_path": "macros\\cross_db_utils\\replace.sql", "name": "replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt_utils') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.default__replace": {"unique_id": "macro.dbt_utils.default__replace", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\replace.sql", "original_file_path": "macros\\cross_db_utils\\replace.sql", "name": "default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n    \n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.right": {"unique_id": "macro.dbt_utils.right", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\right.sql", "original_file_path": "macros\\cross_db_utils\\right.sql", "name": "right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt_utils') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__right"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.default__right": {"unique_id": "macro.dbt_utils.default__right", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\right.sql", "original_file_path": "macros\\cross_db_utils\\right.sql", "name": "default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n    \n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.bigquery__right": {"unique_id": "macro.dbt_utils.bigquery__right", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\right.sql", "original_file_path": "macros\\cross_db_utils\\right.sql", "name": "bigquery__right", "macro_sql": "{% macro bigquery__right(string_text, length_expression) %}\n\n    case when {{ length_expression }} = 0 \n        then ''\n    else \n        substr(\n            {{ string_text }},\n            -1 * ({{ length_expression }})\n        )\n    end\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.snowflake__right": {"unique_id": "macro.dbt_utils.snowflake__right", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\right.sql", "original_file_path": "macros\\cross_db_utils\\right.sql", "name": "snowflake__right", "macro_sql": "{% macro snowflake__right(string_text, length_expression) %}\n\n    case when {{ length_expression }} = 0 \n        then ''\n    else \n        right(\n            {{ string_text }},\n            {{ length_expression }}\n        )\n    end\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.safe_cast": {"unique_id": "macro.dbt_utils.safe_cast", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\safe_cast.sql", "original_file_path": "macros\\cross_db_utils\\safe_cast.sql", "name": "safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt_utils') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.default__safe_cast": {"unique_id": "macro.dbt_utils.default__safe_cast", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\safe_cast.sql", "original_file_path": "macros\\cross_db_utils\\safe_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.snowflake__safe_cast": {"unique_id": "macro.dbt_utils.snowflake__safe_cast", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\safe_cast.sql", "original_file_path": "macros\\cross_db_utils\\safe_cast.sql", "name": "snowflake__safe_cast", "macro_sql": "{% macro snowflake__safe_cast(field, type) %}\n    try_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.bigquery__safe_cast": {"unique_id": "macro.dbt_utils.bigquery__safe_cast", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\safe_cast.sql", "original_file_path": "macros\\cross_db_utils\\safe_cast.sql", "name": "bigquery__safe_cast", "macro_sql": "{% macro bigquery__safe_cast(field, type) %}\n    safe_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.split_part": {"unique_id": "macro.dbt_utils.split_part", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt_utils') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.default__split_part": {"unique_id": "macro.dbt_utils.default__split_part", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils._split_part_negative": {"unique_id": "macro.dbt_utils._split_part_negative", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "_split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }}) \n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.postgres__split_part": {"unique_id": "macro.dbt_utils.postgres__split_part", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "postgres__split_part", "macro_sql": "{% macro postgres__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    {{ dbt_utils.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt_utils._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part", "macro.dbt_utils._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.redshift__split_part": {"unique_id": "macro.dbt_utils.redshift__split_part", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "redshift__split_part", "macro_sql": "{% macro redshift__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    {{ dbt_utils.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt_utils._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part", "macro.dbt_utils._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.bigquery__split_part": {"unique_id": "macro.dbt_utils.bigquery__split_part", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\split_part.sql", "original_file_path": "macros\\cross_db_utils\\split_part.sql", "name": "bigquery__split_part", "macro_sql": "{% macro bigquery__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    split(\n        {{ string_text }},\n        {{ delimiter_text }}\n        )[safe_offset({{ part_number - 1 }})]\n  {% else %}\n    split(\n        {{ string_text }},\n        {{ delimiter_text }}\n        )[safe_offset(\n          length({{ string_text }}) \n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 1\n        )]\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2303755}, "macro.dbt_utils.width_bucket": {"unique_id": "macro.dbt_utils.width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\width_bucket.sql", "original_file_path": "macros\\cross_db_utils\\width_bucket.sql", "name": "width_bucket", "macro_sql": "{% macro width_bucket(expr, min_value, max_value, num_buckets) %}\n  {{ return(adapter.dispatch('width_bucket', 'dbt_utils') (expr, min_value, max_value, num_buckets)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__width_bucket"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2459624}, "macro.dbt_utils.default__width_bucket": {"unique_id": "macro.dbt_utils.default__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\width_bucket.sql", "original_file_path": "macros\\cross_db_utils\\width_bucket.sql", "name": "default__width_bucket", "macro_sql": "{% macro default__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is eaxtly at the bucket egde\n        case\n            when\n                mod(\n                    {{ dbt_utils.safe_cast(expr, dbt_utils.type_numeric() ) }},\n                    {{ dbt_utils.safe_cast(bin_size, dbt_utils.type_numeric() ) }}\n                ) = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.24766}, "macro.dbt_utils.redshift__width_bucket": {"unique_id": "macro.dbt_utils.redshift__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\width_bucket.sql", "original_file_path": "macros\\cross_db_utils\\width_bucket.sql", "name": "redshift__width_bucket", "macro_sql": "{% macro redshift__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is exactly at the bucket edge\n        case\n            when\n                {{ dbt_utils.safe_cast(expr, dbt_utils.type_numeric() ) }} %\n                {{ dbt_utils.safe_cast(bin_size, dbt_utils.type_numeric() ) }}\n                 = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.24766}, "macro.dbt_utils.snowflake__width_bucket": {"unique_id": "macro.dbt_utils.snowflake__width_bucket", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\width_bucket.sql", "original_file_path": "macros\\cross_db_utils\\width_bucket.sql", "name": "snowflake__width_bucket", "macro_sql": "{% macro snowflake__width_bucket(expr, min_value, max_value, num_buckets) %}\n    width_bucket({{ expr }}, {{ min_value }}, {{ max_value }}, {{ num_buckets }} )\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.24766}, "macro.dbt_utils._is_ephemeral": {"unique_id": "macro.dbt_utils._is_ephemeral", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\_is_ephemeral.sql", "original_file_path": "macros\\cross_db_utils\\_is_ephemeral.sql", "name": "_is_ephemeral", "macro_sql": "{% macro _is_ephemeral(obj, macro) %}\n    {%- if obj.is_cte -%}\n        {% set ephemeral_prefix = api.Relation.add_ephemeral_prefix('') %}\n        {% if obj.name.startswith(ephemeral_prefix) %}\n            {% set model_name = obj.name[(ephemeral_prefix|length):] %}\n        {% else %}\n            {% set model_name = obj.name %}\n        {%- endif -%}\n        {% set error_message %}\nThe `{{ macro }}` macro cannot be used with ephemeral models, as it relies on the information schema.\n\n`{{ model_name }}` is an ephemeral model. Consider making it a view or table instead.\n        {% endset %}\n        {%- do exceptions.raise_compiler_error(error_message) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.24766}, "macro.dbt_utils._is_relation": {"unique_id": "macro.dbt_utils._is_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\cross_db_utils\\_is_relation.sql", "original_file_path": "macros\\cross_db_utils\\_is_relation.sql", "name": "_is_relation", "macro_sql": "{% macro _is_relation(obj, macro) %}\n    {%- if not (obj is mapping and obj.get('metadata', {}).get('type', '').endswith('Relation')) -%}\n        {%- do exceptions.raise_compiler_error(\"Macro \" ~ macro ~ \" expected a Relation but received the value: \" ~ obj) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.24766}, "macro.dbt_utils.test_accepted_range": {"unique_id": "macro.dbt_utils.test_accepted_range", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\accepted_range.sql", "original_file_path": "macros\\generic_tests\\accepted_range.sql", "name": "test_accepted_range", "macro_sql": "{% test accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n  {{ return(adapter.dispatch('test_accepted_range', 'dbt_utils')(model, column_name, min_value, max_value, inclusive)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_accepted_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2544851}, "macro.dbt_utils.default__test_accepted_range": {"unique_id": "macro.dbt_utils.default__test_accepted_range", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\accepted_range.sql", "original_file_path": "macros\\generic_tests\\accepted_range.sql", "name": "default__test_accepted_range", "macro_sql": "{% macro default__test_accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n\nwith meet_condition as(\n  select *\n  from {{ model }}\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n\n  {%- if min_value is not none %}\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} > {{- \"=\" if inclusive }} {{ min_value }}\n  {%- endif %}\n\n  {%- if max_value is not none %}\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} < {{- \"=\" if inclusive }} {{ max_value }}\n  {%- endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2550273}, "macro.dbt_utils.test_at_least_one": {"unique_id": "macro.dbt_utils.test_at_least_one", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\at_least_one.sql", "original_file_path": "macros\\generic_tests\\at_least_one.sql", "name": "test_at_least_one", "macro_sql": "{% test at_least_one(model, column_name) %}\n  {{ return(adapter.dispatch('test_at_least_one', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_at_least_one"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2550273}, "macro.dbt_utils.default__test_at_least_one": {"unique_id": "macro.dbt_utils.default__test_at_least_one", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\at_least_one.sql", "original_file_path": "macros\\generic_tests\\at_least_one.sql", "name": "default__test_at_least_one", "macro_sql": "{% macro default__test_at_least_one(model, column_name) %}\n\nselect *\nfrom (\n    select\n        {# In TSQL, subquery aggregate columns need aliases #}\n        {# thus: a filler col name, 'filler_column' #}\n      count({{ column_name }}) as filler_column\n\n    from {{ model }}\n\n    having count({{ column_name }}) = 0\n\n) validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2574341}, "macro.dbt_utils.test_cardinality_equality": {"unique_id": "macro.dbt_utils.test_cardinality_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\cardinality_equality.sql", "original_file_path": "macros\\generic_tests\\cardinality_equality.sql", "name": "test_cardinality_equality", "macro_sql": "{% test cardinality_equality(model, column_name, to, field) %}\n    {{ return(adapter.dispatch('test_cardinality_equality', 'dbt_utils')(model, column_name, to, field)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_cardinality_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2590084}, "macro.dbt_utils.default__test_cardinality_equality": {"unique_id": "macro.dbt_utils.default__test_cardinality_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\cardinality_equality.sql", "original_file_path": "macros\\generic_tests\\cardinality_equality.sql", "name": "default__test_cardinality_equality", "macro_sql": "{% macro default__test_cardinality_equality(model, column_name, to, field) %}\n\n{# T-SQL does not let you use numbers as aliases for columns #}\n{# Thus, no \"GROUP BY 1\" #}\n\nwith table_a as (\nselect\n  {{ column_name }},\n  count(*) as num_rows\nfrom {{ model }}\ngroup by {{ column_name }}\n),\n\ntable_b as (\nselect\n  {{ field }},\n  count(*) as num_rows\nfrom {{ to }}\ngroup by {{ field }}\n),\n\nexcept_a as (\n  select *\n  from table_a\n  {{ dbt_utils.except() }}\n  select *\n  from table_b\n),\n\nexcept_b as (\n  select *\n  from table_b\n  {{ dbt_utils.except() }}\n  select *\n  from table_a\n),\n\nunioned as (\n  select *\n  from except_a\n  union all\n  select *\n  from except_b\n)\n\nselect *\nfrom unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2595525}, "macro.dbt_utils.test_equality": {"unique_id": "macro.dbt_utils.test_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\equality.sql", "original_file_path": "macros\\generic_tests\\equality.sql", "name": "test_equality", "macro_sql": "{% test equality(model, compare_model, compare_columns=None) %}\n  {{ return(adapter.dispatch('test_equality', 'dbt_utils')(model, compare_model, compare_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2615633}, "macro.dbt_utils.default__test_equality": {"unique_id": "macro.dbt_utils.default__test_equality", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\equality.sql", "original_file_path": "macros\\generic_tests\\equality.sql", "name": "default__test_equality", "macro_sql": "{% macro default__test_equality(model, compare_model, compare_columns=None) %}\n\n{% set set_diff %}\n    count(*) + coalesce(abs(\n        sum(case when which_diff = 'a_minus_b' then 1 else 0 end) -\n        sum(case when which_diff = 'b_minus_a' then 1 else 0 end)\n    ), 0)\n{% endset %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = set_diff) }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\n-- setup\n{%- do dbt_utils._is_relation(model, 'test_equality') -%}\n\n{#-\nIf the compare_cols arg is provided, we can run this test without querying the\ninformation schema\u00a0\u2014 this allows the model to be an ephemeral model\n-#}\n\n{%- if not compare_columns -%}\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n    {%- set compare_columns = adapter.get_columns_in_relation(model) | map(attribute='quoted') -%}\n{%- endif -%}\n\n{% set compare_cols_csv = compare_columns | join(', ') %}\n\nwith a as (\n\n    select * from {{ model }}\n\n),\n\nb as (\n\n    select * from {{ compare_model }}\n\n),\n\na_minus_b as (\n\n    select {{compare_cols_csv}} from a\n    {{ dbt_utils.except() }}\n    select {{compare_cols_csv}} from b\n\n),\n\nb_minus_a as (\n\n    select {{compare_cols_csv}} from b\n    {{ dbt_utils.except() }}\n    select {{compare_cols_csv}} from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2635336}, "macro.dbt_utils.test_equal_rowcount": {"unique_id": "macro.dbt_utils.test_equal_rowcount", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\equal_rowcount.sql", "original_file_path": "macros\\generic_tests\\equal_rowcount.sql", "name": "test_equal_rowcount", "macro_sql": "{% test equal_rowcount(model, compare_model) %}\n  {{ return(adapter.dispatch('test_equal_rowcount', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equal_rowcount"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2653956}, "macro.dbt_utils.default__test_equal_rowcount": {"unique_id": "macro.dbt_utils.default__test_equal_rowcount", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\equal_rowcount.sql", "original_file_path": "macros\\generic_tests\\equal_rowcount.sql", "name": "default__test_equal_rowcount", "macro_sql": "{% macro default__test_equal_rowcount(model, compare_model) %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = 'coalesce(diff_count, 0)') }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\nwith a as (\n\n    select count(*) as count_a from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_b from {{ compare_model }}\n\n),\nfinal as (\n\n    select\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n    from a\n    cross join b\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2653956}, "macro.dbt_utils.test_expression_is_true": {"unique_id": "macro.dbt_utils.test_expression_is_true", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\expression_is_true.sql", "original_file_path": "macros\\generic_tests\\expression_is_true.sql", "name": "test_expression_is_true", "macro_sql": "{% test expression_is_true(model, expression, column_name=None, condition='1=1') %}\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n  {{ return(adapter.dispatch('test_expression_is_true', 'dbt_utils')(model, expression, column_name, condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2683563}, "macro.dbt_utils.default__test_expression_is_true": {"unique_id": "macro.dbt_utils.default__test_expression_is_true", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\expression_is_true.sql", "original_file_path": "macros\\generic_tests\\expression_is_true.sql", "name": "default__test_expression_is_true", "macro_sql": "{% macro default__test_expression_is_true(model, expression, column_name, condition) %}\n\nwith meet_condition as (\n    select * from {{ model }} where {{ condition }}\n)\n\nselect\n    *\nfrom meet_condition\n{% if column_name is none %}\nwhere not({{ expression }})\n{%- else %}\nwhere not({{ column_name }} {{ expression }})\n{%- endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2688997}, "macro.dbt_utils.test_fewer_rows_than": {"unique_id": "macro.dbt_utils.test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\fewer_rows_than.sql", "original_file_path": "macros\\generic_tests\\fewer_rows_than.sql", "name": "test_fewer_rows_than", "macro_sql": "{% test fewer_rows_than(model, compare_model) %}\n  {{ return(adapter.dispatch('test_fewer_rows_than', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_fewer_rows_than"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2708406}, "macro.dbt_utils.default__test_fewer_rows_than": {"unique_id": "macro.dbt_utils.default__test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\fewer_rows_than.sql", "original_file_path": "macros\\generic_tests\\fewer_rows_than.sql", "name": "default__test_fewer_rows_than", "macro_sql": "{% macro default__test_fewer_rows_than(model, compare_model) %}\n\n{{ config(fail_calc = 'coalesce(row_count_delta, 0)') }}\n\nwith a as (\n\n    select count(*) as count_our_model from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_comparison_model from {{ compare_model }}\n\n),\ncounts as (\n\n    select\n        count_our_model,\n        count_comparison_model\n    from a\n    cross join b\n\n),\nfinal as (\n\n    select *,\n        case\n            -- fail the test if we have more rows than the reference model and return the row count delta\n            when count_our_model > count_comparison_model then (count_our_model - count_comparison_model)\n            -- fail the test if they are the same number\n            when count_our_model = count_comparison_model then 1\n            -- pass the test if the delta is positive (i.e. return the number 0)\n            else 0\n    end as row_count_delta\n    from counts\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2713852}, "macro.dbt_utils.test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "original_file_path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "name": "test_mutually_exclusive_ranges", "macro_sql": "{% test mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n  {{ return(adapter.dispatch('test_mutually_exclusive_ranges', 'dbt_utils')(model, lower_bound_column, upper_bound_column, partition_by, gaps, zero_length_range_allowed)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_mutually_exclusive_ranges"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.default__test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.default__test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "original_file_path": "macros\\generic_tests\\mutually_exclusive_ranges.sql", "name": "default__test_mutually_exclusive_ranges", "macro_sql": "{% macro default__test_mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n{% if gaps == 'not_allowed' %}\n    {% set allow_gaps_operator='=' %}\n    {% set allow_gaps_operator_in_words='equal_to' %}\n{% elif gaps == 'allowed' %}\n    {% set allow_gaps_operator='<=' %}\n    {% set allow_gaps_operator_in_words='less_than_or_equal_to' %}\n{% elif gaps == 'required' %}\n    {% set allow_gaps_operator='<' %}\n    {% set allow_gaps_operator_in_words='less_than' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`gaps` argument for mutually_exclusive_ranges test must be one of ['not_allowed', 'allowed', 'required'] Got: '\" ~ gaps ~\"'.'\"\n    ) }}\n{% endif %}\n{% if not zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<' %}\n    {% set allow_zero_length_operator_in_words='less_than' %}\n{% elif zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<=' %}\n    {% set allow_zero_length_operator_in_words='less_than_or_equal_to' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`zero_length_range_allowed` argument for mutually_exclusive_ranges test must be one of [true, false] Got: '\" ~ zero_length_range_allowed ~\"'.'\"\n    ) }}\n{% endif %}\n\n{% set partition_clause=\"partition by \" ~ partition_by if partition_by else '' %}\n\nwith window_functions as (\n\n    select\n        {% if partition_by %}\n        {{ partition_by }} as partition_by_col,\n        {% endif %}\n        {{ lower_bound_column }} as lower_bound,\n        {{ upper_bound_column }} as upper_bound,\n\n        lead({{ lower_bound_column }}) over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }}\n        ) as next_lower_bound,\n\n        row_number() over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }} desc\n        ) = 1 as is_last_record\n\n    from {{ model }}\n\n),\n\ncalc as (\n    -- We want to return records where one of our assumptions fails, so we'll use\n    -- the `not` function with `and` statements so we can write our assumptions nore cleanly\n    select\n        *,\n\n        -- For each record: lower_bound should be < upper_bound.\n        -- Coalesce it to return an error on the null case (implicit assumption\n        -- these columns are not_null)\n        coalesce(\n            lower_bound {{ allow_zero_length_operator }} upper_bound,\n            false\n        ) as lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound,\n\n        -- For each record: upper_bound {{ allow_gaps_operator }} the next lower_bound.\n        -- Coalesce it to handle null cases for the last record.\n        coalesce(\n            upper_bound {{ allow_gaps_operator }} next_lower_bound,\n            is_last_record,\n            false\n        ) as upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n\n    from window_functions\n\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from calc\n\n    where not(\n        -- THE FOLLOWING SHOULD BE TRUE --\n        lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound\n        and upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n    )\n)\n\nselect * from validation_errors\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.test_not_accepted_values": {"unique_id": "macro.dbt_utils.test_not_accepted_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_accepted_values.sql", "original_file_path": "macros\\generic_tests\\not_accepted_values.sql", "name": "test_not_accepted_values", "macro_sql": "{% test not_accepted_values(model, column_name, values, quote=True) %}\n  {{ return(adapter.dispatch('test_not_accepted_values', 'dbt_utils')(model, column_name, values, quote)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.default__test_not_accepted_values": {"unique_id": "macro.dbt_utils.default__test_not_accepted_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_accepted_values.sql", "original_file_path": "macros\\generic_tests\\not_accepted_values.sql", "name": "default__test_not_accepted_values", "macro_sql": "{% macro default__test_not_accepted_values(model, column_name, values, quote=True) %}\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field in (\n        {% for value in values -%}\n            {% if quote -%}\n            '{{ value }}'\n            {%- else -%}\n            {{ value }}\n            {%- endif -%}\n            {%- if not loop.last -%},{%- endif %}\n        {%- endfor %}\n        )\n\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.test_not_constant": {"unique_id": "macro.dbt_utils.test_not_constant", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_constant.sql", "original_file_path": "macros\\generic_tests\\not_constant.sql", "name": "test_not_constant", "macro_sql": "{% test not_constant(model, column_name) %}\n  {{ return(adapter.dispatch('test_not_constant', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_constant"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.default__test_not_constant": {"unique_id": "macro.dbt_utils.default__test_not_constant", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_constant.sql", "original_file_path": "macros\\generic_tests\\not_constant.sql", "name": "default__test_not_constant", "macro_sql": "{% macro default__test_not_constant(model, column_name) %}\n\n\nselect\n    {# In TSQL, subquery aggregate columns need aliases #}\n    {# thus: a filler col name, 'filler_column' #}\n    count(distinct {{ column_name }}) as filler_column\n\nfrom {{ model }}\n\nhaving count(distinct {{ column_name }}) = 1\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.test_not_null_proportion": {"unique_id": "macro.dbt_utils.test_not_null_proportion", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_null_proportion.sql", "original_file_path": "macros\\generic_tests\\not_null_proportion.sql", "name": "test_not_null_proportion", "macro_sql": "{% macro test_not_null_proportion(model) %}\n  {{ return(adapter.dispatch('test_not_null_proportion', 'dbt_utils')(model, **kwargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_proportion"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.default__test_not_null_proportion": {"unique_id": "macro.dbt_utils.default__test_not_null_proportion", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\not_null_proportion.sql", "original_file_path": "macros\\generic_tests\\not_null_proportion.sql", "name": "default__test_not_null_proportion", "macro_sql": "{% macro default__test_not_null_proportion(model) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n{% set at_least = kwargs.get('at_least', kwargs.get('arg')) %}\n{% set at_most = kwargs.get('at_most', kwargs.get('arg', 1)) %}\n\nwith validation as (\n  select\n    sum(case when {{ column_name }} is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion\n  from {{ model }}\n),\nvalidation_errors as (\n  select\n    not_null_proportion\n  from validation\n  where not_null_proportion < {{ at_least }} or not_null_proportion > {{ at_most }}\n)\nselect\n  *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.test_recency": {"unique_id": "macro.dbt_utils.test_recency", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\recency.sql", "original_file_path": "macros\\generic_tests\\recency.sql", "name": "test_recency", "macro_sql": "{% test recency(model, field, datepart, interval) %}\n  {{ return(adapter.dispatch('test_recency', 'dbt_utils')(model, field, datepart, interval)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_recency"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.default__test_recency": {"unique_id": "macro.dbt_utils.default__test_recency", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\recency.sql", "original_file_path": "macros\\generic_tests\\recency.sql", "name": "default__test_recency", "macro_sql": "{% macro default__test_recency(model, field, datepart, interval) %}\n\n{% set threshold = dbt_utils.dateadd(datepart, interval * -1, dbt_utils.current_timestamp()) %}\n\nwith recency as (\n\n    select max({{field}}) as most_recent\n    from {{ model }}\n\n)\n\nselect\n\n    most_recent,\n    {{ threshold }} as threshold\n\nfrom recency\nwhere most_recent < {{ threshold }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.27749}, "macro.dbt_utils.test_relationships_where": {"unique_id": "macro.dbt_utils.test_relationships_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\relationships_where.sql", "original_file_path": "macros\\generic_tests\\relationships_where.sql", "name": "test_relationships_where", "macro_sql": "{% test relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n  {{ return(adapter.dispatch('test_relationships_where', 'dbt_utils')(model, column_name, to, field, from_condition, to_condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_relationships_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__test_relationships_where": {"unique_id": "macro.dbt_utils.default__test_relationships_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\relationships_where.sql", "original_file_path": "macros\\generic_tests\\relationships_where.sql", "name": "default__test_relationships_where", "macro_sql": "{% macro default__test_relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n\nwith left_table as (\n\n  select\n    {{column_name}} as id\n\n  from {{model}}\n\n  where {{column_name}} is not null\n    and {{from_condition}}\n\n),\n\nright_table as (\n\n  select\n    {{field}} as id\n\n  from {{to}}\n\n  where {{field}} is not null\n    and {{to_condition}}\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.test_sequential_values": {"unique_id": "macro.dbt_utils.test_sequential_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\sequential_values.sql", "original_file_path": "macros\\generic_tests\\sequential_values.sql", "name": "test_sequential_values", "macro_sql": "{% test sequential_values(model, column_name, interval=1, datepart=None) %}\n\n  {{ return(adapter.dispatch('test_sequential_values', 'dbt_utils')(model, column_name, interval, datepart)) }}\n\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_sequential_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__test_sequential_values": {"unique_id": "macro.dbt_utils.default__test_sequential_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\sequential_values.sql", "original_file_path": "macros\\generic_tests\\sequential_values.sql", "name": "default__test_sequential_values", "macro_sql": "{% macro default__test_sequential_values(model, column_name, interval=1, datepart=None) %}\n\n{% set previous_column_name = \"previous_\" ~ dbt_utils.slugify(column_name) %}\n\nwith windowed as (\n\n    select\n        {{ column_name }},\n        lag({{ column_name }}) over (\n            order by {{ column_name }}\n        ) as {{ previous_column_name }}\n    from {{ model }}\n),\n\nvalidation_errors as (\n    select\n        *\n    from windowed\n    {% if datepart %}\n    where not(cast({{ column_name }} as {{ dbt_utils.type_timestamp() }})= cast({{ dbt_utils.dateadd(datepart, interval, previous_column_name) }} as {{ dbt_utils.type_timestamp() }}))\n    {% else %}\n    where not({{ column_name }} = {{ previous_column_name }} + {{ interval }})\n    {% endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.slugify", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.test_not_null_where": {"unique_id": "macro.dbt_utils.test_not_null_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\test_not_null_where.sql", "original_file_path": "macros\\generic_tests\\test_not_null_where.sql", "name": "test_not_null_where", "macro_sql": "{% test not_null_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.not_null_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `not_null` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_not_null_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__test_not_null_where": {"unique_id": "macro.dbt_utils.default__test_not_null_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\test_not_null_where.sql", "original_file_path": "macros\\generic_tests\\test_not_null_where.sql", "name": "default__test_not_null_where", "macro_sql": "{% macro default__test_not_null_where(model, column_name) %}\r\n  {{ return(test_not_null(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.test_unique_where": {"unique_id": "macro.dbt_utils.test_unique_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\test_unique_where.sql", "original_file_path": "macros\\generic_tests\\test_unique_where.sql", "name": "test_unique_where", "macro_sql": "{% test unique_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.unique_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `unique` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_unique_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__test_unique_where": {"unique_id": "macro.dbt_utils.default__test_unique_where", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\test_unique_where.sql", "original_file_path": "macros\\generic_tests\\test_unique_where.sql", "name": "default__test_unique_where", "macro_sql": "{% macro default__test_unique_where(model, column_name) %}\r\n  {{ return(test_unique(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\unique_combination_of_columns.sql", "original_file_path": "macros\\generic_tests\\unique_combination_of_columns.sql", "name": "test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n  {{ return(adapter.dispatch('test_unique_combination_of_columns', 'dbt_utils')(model, combination_of_columns, quote_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_combination_of_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.default__test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\generic_tests\\unique_combination_of_columns.sql", "original_file_path": "macros\\generic_tests\\unique_combination_of_columns.sql", "name": "default__test_unique_combination_of_columns", "macro_sql": "{% macro default__test_unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n\n{% if not quote_columns %}\n    {%- set column_list=combination_of_columns %}\n{% elif quote_columns %}\n    {%- set column_list=[] %}\n        {% for column in combination_of_columns -%}\n            {% set column_list = column_list.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set columns_csv=column_list | join(', ') %}\n\n\nwith validation_errors as (\n\n    select\n        {{ columns_csv }}\n    from {{ model }}\n    group by {{ columns_csv }}\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.log_info": {"unique_id": "macro.dbt_utils.log_info", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\log_info.sql", "original_file_path": "macros\\jinja_helpers\\log_info.sql", "name": "log_info", "macro_sql": "{% macro log_info(message) %}\n    {{ return(adapter.dispatch('log_info', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__log_info"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.default__log_info": {"unique_id": "macro.dbt_utils.default__log_info", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\log_info.sql", "original_file_path": "macros\\jinja_helpers\\log_info.sql", "name": "default__log_info", "macro_sql": "{% macro default__log_info(message) %}\n    {{ log(dbt_utils.pretty_log_format(message), info=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.2931244}, "macro.dbt_utils.pretty_log_format": {"unique_id": "macro.dbt_utils.pretty_log_format", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\pretty_log_format.sql", "original_file_path": "macros\\jinja_helpers\\pretty_log_format.sql", "name": "pretty_log_format", "macro_sql": "{% macro pretty_log_format(message) %}\n    {{ return(adapter.dispatch('pretty_log_format', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.306554}, "macro.dbt_utils.default__pretty_log_format": {"unique_id": "macro.dbt_utils.default__pretty_log_format", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\pretty_log_format.sql", "original_file_path": "macros\\jinja_helpers\\pretty_log_format.sql", "name": "default__pretty_log_format", "macro_sql": "{% macro default__pretty_log_format(message) %}\n    {{ return( dbt_utils.pretty_time() ~ ' + ' ~ message) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.306554}, "macro.dbt_utils.pretty_time": {"unique_id": "macro.dbt_utils.pretty_time", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\pretty_time.sql", "original_file_path": "macros\\jinja_helpers\\pretty_time.sql", "name": "pretty_time", "macro_sql": "{% macro pretty_time(format='%H:%M:%S') %}\n    {{ return(adapter.dispatch('pretty_time', 'dbt_utils')(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.306554}, "macro.dbt_utils.default__pretty_time": {"unique_id": "macro.dbt_utils.default__pretty_time", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\pretty_time.sql", "original_file_path": "macros\\jinja_helpers\\pretty_time.sql", "name": "default__pretty_time", "macro_sql": "{% macro default__pretty_time(format='%H:%M:%S') %}\n    {{ return(modules.datetime.datetime.now().strftime(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.308505}, "macro.dbt_utils.slugify": {"unique_id": "macro.dbt_utils.slugify", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\jinja_helpers\\slugify.sql", "original_file_path": "macros\\jinja_helpers\\slugify.sql", "name": "slugify", "macro_sql": "{% macro slugify(string) %}\n\n{#- Lower case the string -#}\n{% set string = string | lower %}\n{#- Replace spaces and dashes with underscores -#}\n{% set string = modules.re.sub('[ -]+', '_', string) %}\n{#- Only take letters, numbers, and underscores -#}\n{% set string = modules.re.sub('[^a-z0-9_]+', '', string) %}\n\n{{ return(string) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3090115}, "macro.dbt_utils.get_period_boundaries": {"unique_id": "macro.dbt_utils.get_period_boundaries", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\materializations\\insert_by_period_materialization.sql", "original_file_path": "macros\\materializations\\insert_by_period_materialization.sql", "name": "get_period_boundaries", "macro_sql": "{% macro get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n    {{ return(adapter.dispatch('get_period_boundaries', 'dbt_utils')(target_schema, target_table, timestamp_field, start_date, stop_date, period)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_boundaries"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3107917}, "macro.dbt_utils.default__get_period_boundaries": {"unique_id": "macro.dbt_utils.default__get_period_boundaries", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\materializations\\insert_by_period_materialization.sql", "original_file_path": "macros\\materializations\\insert_by_period_materialization.sql", "name": "default__get_period_boundaries", "macro_sql": "{% macro default__get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n\n  {% call statement('period_boundaries', fetch_result=True) -%}\n    with data as (\n      select\n          coalesce(max(\"{{timestamp_field}}\"), '{{start_date}}')::timestamp as start_timestamp,\n          coalesce(\n            {{dbt_utils.dateadd('millisecond',\n                                -1,\n                                \"nullif('\" ~ stop_date ~ \"','')::timestamp\")}},\n            {{dbt_utils.current_timestamp()}}\n          ) as stop_timestamp\n      from \"{{target_schema}}\".\"{{target_table}}\"\n    )\n\n    select\n      start_timestamp,\n      stop_timestamp,\n      {{dbt_utils.datediff('start_timestamp',\n                           'stop_timestamp',\n                           period)}}  + 1 as num_periods\n    from data\n  {%- endcall %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3107917}, "macro.dbt_utils.get_period_sql": {"unique_id": "macro.dbt_utils.get_period_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\materializations\\insert_by_period_materialization.sql", "original_file_path": "macros\\materializations\\insert_by_period_materialization.sql", "name": "get_period_sql", "macro_sql": "{% macro get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n    {{ return(adapter.dispatch('get_period_sql', 'dbt_utils')(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.324336}, "macro.dbt_utils.default__get_period_sql": {"unique_id": "macro.dbt_utils.default__get_period_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\materializations\\insert_by_period_materialization.sql", "original_file_path": "macros\\materializations\\insert_by_period_materialization.sql", "name": "default__get_period_sql", "macro_sql": "{% macro default__get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n\n  {%- set period_filter -%}\n    (\"{{timestamp_field}}\" >  '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' and\n     \"{{timestamp_field}}\" <= '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' + interval '1 {{period}}' and\n     \"{{timestamp_field}}\" <  '{{stop_timestamp}}'::timestamp)\n  {%- endset -%}\n\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\n\n  select\n    {{target_cols_csv}}\n  from (\n    {{filtered_sql}}\n  )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.324336}, "macro.dbt_utils.materialization_insert_by_period_default": {"unique_id": "macro.dbt_utils.materialization_insert_by_period_default", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\materializations\\insert_by_period_materialization.sql", "original_file_path": "macros\\materializations\\insert_by_period_materialization.sql", "name": "materialization_insert_by_period_default", "macro_sql": "{% materialization insert_by_period, default -%}\n  {%- set timestamp_field = config.require('timestamp_field') -%}\n  {%- set start_date = config.require('start_date') -%}\n  {%- set stop_date = config.get('stop_date') or '' -%}\n  {%- set period = config.get('period') or 'week' -%}\n\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\n    {%- set error_message -%}\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\n    {%- endset -%}\n    {{ exceptions.raise_compiler_error(error_message) }}\n  {%- endif -%}\n\n  {%- set identifier = model['name'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\n\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\n\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\n\n  -- setup\n  {% if old_relation is none -%}\n    -- noop\n  {%- elif should_truncate -%}\n    {{adapter.truncate_relation(old_relation)}}\n  {%- elif should_drop -%}\n    {{adapter.drop_relation(old_relation)}}\n    {%- set old_relation = none -%}\n  {%- endif %}\n\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\n\n  -- `begin` happens here, so `commit` after it to finish the transaction\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\n  {% call statement() -%}\n    begin; -- make extra sure we've closed out the transaction\n    commit;\n  {%- endcall %}\n\n  -- build model\n  {% if force_create or old_relation is none -%}\n    {# Create an empty target table -#}\n    {% call statement('main') -%}\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\n      {{create_table_as(False, target_relation, empty_sql)}}\n    {%- endcall %}\n  {%- endif %}\n\n  {% set _ = dbt_utils.get_period_boundaries(schema,\n                                              identifier,\n                                              timestamp_field,\n                                              start_date,\n                                              stop_date,\n                                              period) %}\n  {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\n  {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\n  {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\n\n  {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\n  {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\n  {%- set loop_vars = {'sum_rows_inserted': 0} -%}\n\n  -- commit each period as a separate transaction\n  {% for i in range(num_periods) -%}\n    {%- set msg = \"Running for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) -%}\n    {{ dbt_utils.log_info(msg) }}\n\n    {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period' ~ i ~ '_tmp' -%}\n    {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\n                                               schema=schema, type='table') -%}\n    {% call statement() -%}\n      {% set tmp_table_sql = dbt_utils.get_period_sql(target_cols_csv,\n                                                       sql,\n                                                       timestamp_field,\n                                                       period,\n                                                       start_timestamp,\n                                                       stop_timestamp,\n                                                       i) %}\n      {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\n    {%- endcall %}\n\n    {{adapter.expand_target_column_types(from_relation=tmp_relation,\n                                         to_relation=target_relation)}}\n    {%- set name = 'main-' ~ i -%}\n    {% call statement(name, fetch_result=True) -%}\n      insert into {{target_relation}} ({{target_cols_csv}})\n      (\n          select\n              {{target_cols_csv}}\n          from {{tmp_relation.include(schema=False)}}\n      );\n    {%- endcall %}\n    {% set result = load_result('main-' ~ i) %}\n    {% if 'response' in result.keys() %} {# added in v0.19.0 #}\n        {% set rows_inserted = result['response']['rows_affected'] %}\n    {% else %} {# older versions #}\n        {% set rows_inserted = result['status'].split(\" \")[2] | int %}\n    {% endif %}\n    \n    {%- set sum_rows_inserted = loop_vars['sum_rows_inserted'] + rows_inserted -%}\n    {%- if loop_vars.update({'sum_rows_inserted': sum_rows_inserted}) %} {% endif -%}\n\n    {%- set msg = \"Ran for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" ~ rows_inserted ~ \" records inserted\" -%}\n    {{ dbt_utils.log_info(msg) }}\n\n  {%- endfor %}\n\n  {% call statement() -%}\n    begin;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=True)}}\n\n  {% call statement() -%}\n    commit;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=False)}}\n\n  {%- set status_string = \"INSERT \" ~ loop_vars['sum_rows_inserted'] -%}\n\n  {% call noop_statement('main', status_string) -%}\n    -- no-op\n  {%- endcall %}\n\n  -- Return the relations created in this materialization\n  {{ return({'relations': [target_relation]}) }}  \n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt_utils.get_period_boundaries", "macro.dbt_utils.log_info", "macro.dbt_utils.get_period_sql", "macro.dbt.noop_statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.324336}, "macro.dbt_utils.get_intervals_between": {"unique_id": "macro.dbt_utils.get_intervals_between", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt_utils')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.default__get_intervals_between": {"unique_id": "macro.dbt_utils.default__get_intervals_between", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{dbt_utils.datediff(start_date, end_date, datepart)}}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.date_spine": {"unique_id": "macro.dbt_utils.date_spine", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt_utils')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.default__date_spine": {"unique_id": "macro.dbt_utils.default__date_spine", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\date_spine.sql", "original_file_path": "macros\\sql\\date_spine.sql", "name": "default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n{# call as follows:\n\ndate_spine(\n    \"day\",\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n    \"dateadd(week, 1, current_date)\"\n) #}\n\n\nwith rawdata as (\n\n    {{dbt_utils.generate_series(\n        dbt_utils.get_intervals_between(start_date, end_date, datepart)\n    )}}\n\n),\n\nall_periods as (\n\n    select (\n        {{\n            dbt_utils.dateadd(\n                datepart,\n                \"row_number() over (order by 1) - 1\",\n                start_date\n            )\n        }}\n    ) as date_{{datepart}}\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_{{datepart}} <= {{ end_date }}\n\n)\n\nselect * from filtered\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.generate_series", "macro.dbt_utils.get_intervals_between", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.deduplicate": {"unique_id": "macro.dbt_utils.deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "deduplicate", "macro_sql": "{%- macro deduplicate(relation, partition_by, order_by=none, relation_alias=none) -%}\n\n    {%- set error_message_group_by -%}\nWarning: the `group_by` parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nUse `partition_by` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if kwargs.get('group_by') %}\n    {%- do exceptions.warn(error_message_group_by) -%}\n    {%- endif -%}\n\n    {%- set error_message_order_by -%}\nWarning: `order_by` as an optional parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nSupply a non-null value for `order_by` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if not order_by %}\n    {%- do exceptions.warn(error_message_order_by) -%}\n    {%- endif -%}\n\n    {%- set error_message_alias -%}\nWarning: the `relation_alias` parameter of the `deduplicate` macro is no longer supported and will be deprecated in a future release of dbt-utils.\nIf you were using `relation_alias` to point to a CTE previously then you can now pass the alias directly to `relation` instead.\nThe {{ model.package_name }}.{{ model.name }} model triggered this warning.\n    {%- endset -%}\n\n    {% if relation_alias %}\n    {%- do exceptions.warn(error_message_alias) -%}\n    {%- endif -%}\n\n    {% set partition_by = partition_by or kwargs.get('group_by') %}\n    {% set relation = relation_alias or relation %}\n    {% set order_by = order_by or \"'1'\" %}\n\n    {{ return(adapter.dispatch('deduplicate', 'dbt_utils')(relation, partition_by, order_by)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.default__deduplicate": {"unique_id": "macro.dbt_utils.default__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "default__deduplicate", "macro_sql": "\n\n{%- macro default__deduplicate(relation, partition_by, order_by) -%}\n\n    with row_numbered as (\n        select\n            _inner.*,\n            row_number() over (\n                partition by {{ partition_by }}\n                order by {{ order_by }}\n            ) as rn\n        from {{ relation }} as _inner\n    )\n\n    select\n        distinct data.*\n    from {{ relation }} as data\n    {#\n    -- Not all DBs will support natural joins but the ones that do include:\n    -- Oracle, MySQL, SQLite, Redshift, Teradata, Materialize, Databricks\n    -- Apache Spark, SingleStore, Vertica\n    -- Those that do not appear to support natural joins include:\n    -- SQLServer, Trino, Presto, Rockset, Athena\n    #}\n    natural join row_numbered\n    where row_numbered.rn = 1\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.redshift__deduplicate": {"unique_id": "macro.dbt_utils.redshift__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "redshift__deduplicate", "macro_sql": "{% macro redshift__deduplicate(relation, partition_by, order_by) -%}\n\n    {{ return(dbt_utils.default__deduplicate(relation, partition_by, order_by=order_by)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__deduplicate"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.postgres__deduplicate": {"unique_id": "macro.dbt_utils.postgres__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "postgres__deduplicate", "macro_sql": "\n{%- macro postgres__deduplicate(relation, partition_by, order_by) -%}\n\n    select\n        distinct on ({{ partition_by }}) *\n    from {{ relation }}\n    order by {{ partition_by }}{{ ',' ~ order_by }}\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.snowflake__deduplicate": {"unique_id": "macro.dbt_utils.snowflake__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "snowflake__deduplicate", "macro_sql": "\n{%- macro snowflake__deduplicate(relation, partition_by, order_by) -%}\n\n    select *\n    from {{ relation }}\n    qualify\n        row_number() over (\n            partition by {{ partition_by }}\n            order by {{ order_by }}\n        ) = 1\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.bigquery__deduplicate": {"unique_id": "macro.dbt_utils.bigquery__deduplicate", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\deduplicate.sql", "original_file_path": "macros\\sql\\deduplicate.sql", "name": "bigquery__deduplicate", "macro_sql": "\n{%- macro bigquery__deduplicate(relation, partition_by, order_by) -%}\n\n    select unique.*\n    from (\n        select\n            array_agg (\n                original\n                order by {{ order_by }}\n                limit 1\n            )[offset(0)] unique\n        from {{ relation }} original\n        group by {{ partition_by }}\n    )\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.get_powers_of_two": {"unique_id": "macro.dbt_utils.get_powers_of_two", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.default__get_powers_of_two": {"unique_id": "macro.dbt_utils.default__get_powers_of_two", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.generate_series": {"unique_id": "macro.dbt_utils.generate_series", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.default__generate_series": {"unique_id": "macro.dbt_utils.default__generate_series", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\generate_series.sql", "original_file_path": "macros\\sql\\generate_series.sql", "name": "default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt_utils.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3400166}, "macro.dbt_utils.get_column_values": {"unique_id": "macro.dbt_utils.get_column_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_column_values.sql", "original_file_path": "macros\\sql\\get_column_values.sql", "name": "get_column_values", "macro_sql": "{% macro get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {{ return(adapter.dispatch('get_column_values', 'dbt_utils')(table, column, order_by, max_records, default, where)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_column_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3556406}, "macro.dbt_utils.default__get_column_values": {"unique_id": "macro.dbt_utils.default__get_column_values", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_column_values.sql", "original_file_path": "macros\\sql\\get_column_values.sql", "name": "default__get_column_values", "macro_sql": "{% macro default__get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none, where=none) -%}\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {% set default = [] if not default %}\n        {{ return(default) }}\n    {% endif %}\n\n    {%- do dbt_utils._is_ephemeral(table, 'get_column_values') -%}\n\n    {# Not all relations are tables. Renaming for internal clarity without breaking functionality for anyone using named arguments #}\n    {# TODO: Change the method signature in a future 0.x.0 release #}\n    {%- set target_relation = table -%}\n\n    {# adapter.load_relation is a convenience wrapper to avoid building a Relation when we already have one #}\n    {% set relation_exists = (load_relation(target_relation)) is not none %}\n\n    {%- call statement('get_column_values', fetch_result=true) %}\n\n        {%- if not relation_exists and default is none -%}\n\n          {{ exceptions.raise_compiler_error(\"In get_column_values(): relation \" ~ target_relation ~ \" does not exist and no default value was provided.\") }}\n\n        {%- elif not relation_exists and default is not none -%}\n\n          {{ log(\"Relation \" ~ target_relation ~ \" does not exist. Returning the default value: \" ~ default) }}\n\n          {{ return(default) }}\n\n        {%- else -%}\n\n\n            select\n                {{ column }} as value\n\n            from {{ target_relation }}\n\n            {% if where is not none %}\n            where {{ where }}\n            {% endif %}\n\n            group by {{ column }}\n            order by {{ order_by }}\n\n            {% if max_records is not none %}\n            limit {{ max_records }}\n            {% endif %}\n\n        {% endif %}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_column_values') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values) }}\n    {%- else -%}\n        {{ return(default) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_ephemeral", "macro.dbt.load_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3573668}, "macro.dbt_utils.get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_filtered_columns_in_relation.sql", "original_file_path": "macros\\sql\\get_filtered_columns_in_relation.sql", "name": "get_filtered_columns_in_relation", "macro_sql": "{% macro get_filtered_columns_in_relation(from, except=[]) -%}\n    {{ return(adapter.dispatch('get_filtered_columns_in_relation', 'dbt_utils')(from, except)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3573668}, "macro.dbt_utils.default__get_filtered_columns_in_relation": {"unique_id": "macro.dbt_utils.default__get_filtered_columns_in_relation", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_filtered_columns_in_relation.sql", "original_file_path": "macros\\sql\\get_filtered_columns_in_relation.sql", "name": "default__get_filtered_columns_in_relation", "macro_sql": "{% macro default__get_filtered_columns_in_relation(from, except=[]) -%}\n    {%- do dbt_utils._is_relation(from, 'get_filtered_columns_in_relation') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'get_filtered_columns_in_relation') -%}\n\n    {# -- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return('') }}\n    {% endif %}\n\n    {%- set include_cols = [] %}\n    {%- set cols = adapter.get_columns_in_relation(from) -%}\n    {%- set except = except | map(\"lower\") | list %}\n    {%- for col in cols -%}\n        {%- if col.column|lower not in except -%}\n            {% do include_cols.append(col.column) %}\n        {%- endif %}\n    {%- endfor %}\n\n    {{ return(include_cols) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3573668}, "macro.dbt_utils.get_query_results_as_dict": {"unique_id": "macro.dbt_utils.get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_query_results_as_dict.sql", "original_file_path": "macros\\sql\\get_query_results_as_dict.sql", "name": "get_query_results_as_dict", "macro_sql": "{% macro get_query_results_as_dict(query) %}\n    {{ return(adapter.dispatch('get_query_results_as_dict', 'dbt_utils')(query)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_query_results_as_dict"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3573668}, "macro.dbt_utils.default__get_query_results_as_dict": {"unique_id": "macro.dbt_utils.default__get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_query_results_as_dict.sql", "original_file_path": "macros\\sql\\get_query_results_as_dict.sql", "name": "default__get_query_results_as_dict", "macro_sql": "{% macro default__get_query_results_as_dict(query) %}\n\n{# This macro returns a dictionary of the form {column_name: (tuple_of_results)} #}\n\n    {%- call statement('get_query_results', fetch_result=True,auto_begin=false) -%}\n\n        {{ query }}\n\n    {%- endcall -%}\n\n    {% set sql_results={} %}\n\n    {%- if execute -%}\n        {% set sql_results_table = load_result('get_query_results').table.columns %}\n        {% for column_name, column in sql_results_table.items() %}\n            {% do sql_results.update({column_name: column.values()}) %}\n        {% endfor %}\n    {%- endif -%}\n\n    {{ return(sql_results) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3573668}, "macro.dbt_utils.get_relations_by_pattern": {"unique_id": "macro.dbt_utils.get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_relations_by_pattern.sql", "original_file_path": "macros\\sql\\get_relations_by_pattern.sql", "name": "get_relations_by_pattern", "macro_sql": "{% macro get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_pattern', 'dbt_utils')(schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3661494}, "macro.dbt_utils.default__get_relations_by_pattern": {"unique_id": "macro.dbt_utils.default__get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_relations_by_pattern.sql", "original_file_path": "macros\\sql\\get_relations_by_pattern.sql", "name": "default__get_relations_by_pattern", "macro_sql": "{% macro default__get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.366698}, "macro.dbt_utils.get_relations_by_prefix": {"unique_id": "macro.dbt_utils.get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_relations_by_prefix.sql", "original_file_path": "macros\\sql\\get_relations_by_prefix.sql", "name": "get_relations_by_prefix", "macro_sql": "{% macro get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_prefix', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_prefix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.366698}, "macro.dbt_utils.default__get_relations_by_prefix": {"unique_id": "macro.dbt_utils.default__get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_relations_by_prefix.sql", "original_file_path": "macros\\sql\\get_relations_by_prefix.sql", "name": "default__get_relations_by_prefix", "macro_sql": "{% macro default__get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_prefix_sql(schema, prefix, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.371247}, "macro.dbt_utils.get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "get_tables_by_pattern_sql", "macro_sql": "{% macro get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_pattern_sql', 'dbt_utils')\n        (schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.373368}, "macro.dbt_utils.default__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "default__get_tables_by_pattern_sql", "macro_sql": "{% macro default__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n        select distinct\n            table_schema as \"table_schema\",\n            table_name as \"table_name\",\n            {{ dbt_utils.get_table_types_sql() }}\n        from {{ database }}.information_schema.tables\n        where table_schema ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.373368}, "macro.dbt_utils.bigquery__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.bigquery__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "bigquery__get_tables_by_pattern_sql", "macro_sql": "{% macro bigquery__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {% if '%' in schema_pattern %}\n        {% set schemata=dbt_utils._bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% else %}\n        {% set schemata=[schema_pattern] %}\n    {% endif %}\n\n    {% set sql %}\n        {% for schema in schemata %}\n            select distinct\n                table_schema,\n                table_name,\n                {{ dbt_utils.get_table_types_sql() }}\n\n            from {{ adapter.quote(database) }}.{{ schema }}.INFORMATION_SCHEMA.TABLES\n            where lower(table_name) like lower ('{{ table_pattern }}')\n                and lower(table_name) not like lower ('{{ exclude }}')\n\n            {% if not loop.last %} union all {% endif %}\n\n        {% endfor %}\n    {% endset %}\n\n    {{ return(sql) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._bigquery__get_matching_schemata", "macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.373368}, "macro.dbt_utils._bigquery__get_matching_schemata": {"unique_id": "macro.dbt_utils._bigquery__get_matching_schemata", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_pattern_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_pattern_sql.sql", "name": "_bigquery__get_matching_schemata", "macro_sql": "{% macro _bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% if execute %}\n\n        {% set sql %}\n        select schema_name from {{ adapter.quote(database) }}.INFORMATION_SCHEMA.SCHEMATA\n        where lower(schema_name) like lower('{{ schema_pattern }}')\n        {% endset %}\n\n        {% set results=run_query(sql) %}\n\n        {% set schemata=results.columns['schema_name'].values() %}\n\n        {{ return(schemata) }}\n\n    {% else %}\n\n        {{ return([]) }}\n\n    {% endif %}\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.373368}, "macro.dbt_utils.get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_prefix_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_prefix_sql.sql", "name": "get_tables_by_prefix_sql", "macro_sql": "{% macro get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_prefix_sql', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.373368}, "macro.dbt_utils.default__get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_tables_by_prefix_sql.sql", "original_file_path": "macros\\sql\\get_tables_by_prefix_sql.sql", "name": "default__get_tables_by_prefix_sql", "macro_sql": "{% macro default__get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n\n    {{ dbt_utils.get_tables_by_pattern_sql(\n        schema_pattern = schema,\n        table_pattern = prefix ~ '%',\n        exclude = exclude,\n        database = database\n    ) }}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3798492}, "macro.dbt_utils.get_table_types_sql": {"unique_id": "macro.dbt_utils.get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "get_table_types_sql", "macro_sql": "{%- macro get_table_types_sql() -%}\n  {{ return(adapter.dispatch('get_table_types_sql', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3798492}, "macro.dbt_utils.default__get_table_types_sql": {"unique_id": "macro.dbt_utils.default__get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "default__get_table_types_sql", "macro_sql": "{% macro default__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'EXTERNAL TABLE' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as \"table_type\"\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3812134}, "macro.dbt_utils.postgres__get_table_types_sql": {"unique_id": "macro.dbt_utils.postgres__get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "postgres__get_table_types_sql", "macro_sql": "{% macro postgres__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'FOREIGN' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as \"table_type\"\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3812134}, "macro.dbt_utils.bigquery__get_table_types_sql": {"unique_id": "macro.dbt_utils.bigquery__get_table_types_sql", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\get_table_types_sql.sql", "original_file_path": "macros\\sql\\get_table_types_sql.sql", "name": "bigquery__get_table_types_sql", "macro_sql": "{% macro bigquery__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'EXTERNAL TABLE' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as `table_type`\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3812134}, "macro.dbt_utils.group_by": {"unique_id": "macro.dbt_utils.group_by", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\groupby.sql", "original_file_path": "macros\\sql\\groupby.sql", "name": "group_by", "macro_sql": "{%- macro group_by(n) -%}\n    {{ return(adapter.dispatch('group_by', 'dbt_utils')(n)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3817554}, "macro.dbt_utils.default__group_by": {"unique_id": "macro.dbt_utils.default__group_by", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\groupby.sql", "original_file_path": "macros\\sql\\groupby.sql", "name": "default__group_by", "macro_sql": "\n\n{%- macro default__group_by(n) -%}\n\n  group by {% for i in range(1, n + 1) -%}\n      {{ i }}{{ ',' if not loop.last }}   \n   {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3830154}, "macro.dbt_utils.degrees_to_radians": {"unique_id": "macro.dbt_utils.degrees_to_radians", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "degrees_to_radians", "macro_sql": "{% macro degrees_to_radians(degrees) -%}\n    acos(-1) * {{degrees}} / 180\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3845367}, "macro.dbt_utils.haversine_distance": {"unique_id": "macro.dbt_utils.haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "haversine_distance", "macro_sql": "{% macro haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n    {{ return(adapter.dispatch('haversine_distance', 'dbt_utils')(lat1,lon1,lat2,lon2,unit)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__haversine_distance"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3845367}, "macro.dbt_utils.default__haversine_distance": {"unique_id": "macro.dbt_utils.default__haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "default__haversine_distance", "macro_sql": "{% macro default__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n\n    2 * 3961 * asin(sqrt(power((sin(radians(({{ lat2 }} - {{ lat1 }}) / 2))), 2) +\n    cos(radians({{lat1}})) * cos(radians({{lat2}})) *\n    power((sin(radians(({{ lon2 }} - {{ lon1 }}) / 2))), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.bigquery__haversine_distance": {"unique_id": "macro.dbt_utils.bigquery__haversine_distance", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\haversine_distance.sql", "original_file_path": "macros\\sql\\haversine_distance.sql", "name": "bigquery__haversine_distance", "macro_sql": "{% macro bigquery__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{% set radians_lat1 = dbt_utils.degrees_to_radians(lat1) %}\n{% set radians_lat2 = dbt_utils.degrees_to_radians(lat2) %}\n{% set radians_lon1 = dbt_utils.degrees_to_radians(lon1) %}\n{% set radians_lon2 = dbt_utils.degrees_to_radians(lon2) %}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n    2 * 3961 * asin(sqrt(power(sin(({{ radians_lat2 }} - {{ radians_lat1 }}) / 2), 2) +\n    cos({{ radians_lat1 }}) * cos({{ radians_lat2 }}) *\n    power(sin(({{ radians_lon2 }} - {{ radians_lon1 }}) / 2), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.degrees_to_radians"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.nullcheck": {"unique_id": "macro.dbt_utils.nullcheck", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\nullcheck.sql", "original_file_path": "macros\\sql\\nullcheck.sql", "name": "nullcheck", "macro_sql": "{% macro nullcheck(cols) %}\n    {{ return(adapter.dispatch('nullcheck', 'dbt_utils')(cols)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.default__nullcheck": {"unique_id": "macro.dbt_utils.default__nullcheck", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\nullcheck.sql", "original_file_path": "macros\\sql\\nullcheck.sql", "name": "default__nullcheck", "macro_sql": "{% macro default__nullcheck(cols) %}\n{%- for col in cols %}\n\n    {% if col.is_string() -%}\n\n    nullif({{col.name}},'') as {{col.name}}\n\n    {%- else -%}\n\n    {{col.name}}\n\n    {%- endif -%}\n\n{%- if not loop.last -%} , {%- endif -%}\n\n{%- endfor -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.nullcheck_table": {"unique_id": "macro.dbt_utils.nullcheck_table", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\nullcheck_table.sql", "original_file_path": "macros\\sql\\nullcheck_table.sql", "name": "nullcheck_table", "macro_sql": "{% macro nullcheck_table(relation) %}\n    {{ return(adapter.dispatch('nullcheck_table', 'dbt_utils')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.default__nullcheck_table": {"unique_id": "macro.dbt_utils.default__nullcheck_table", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\nullcheck_table.sql", "original_file_path": "macros\\sql\\nullcheck_table.sql", "name": "default__nullcheck_table", "macro_sql": "{% macro default__nullcheck_table(relation) %}\n\n  {%- do dbt_utils._is_relation(relation, 'nullcheck_table') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'nullcheck_table') -%}\n  {% set cols = adapter.get_columns_in_relation(relation) %}\n\n  select {{ dbt_utils.nullcheck(cols) }}\n  from {{relation}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.pivot": {"unique_id": "macro.dbt_utils.pivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\pivot.sql", "original_file_path": "macros\\sql\\pivot.sql", "name": "pivot", "macro_sql": "{% macro pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n    {{ return(adapter.dispatch('pivot', 'dbt_utils')(column, values, alias, agg, cmp, prefix, suffix, then_value, else_value, quote_identifiers, distinct)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.default__pivot": {"unique_id": "macro.dbt_utils.default__pivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\pivot.sql", "original_file_path": "macros\\sql\\pivot.sql", "name": "default__pivot", "macro_sql": "{% macro default__pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n  {% for value in values %}\n    {{ agg }}(\n      {% if distinct %} distinct {% endif %}\n      case\n      when {{ column }} {{ cmp }} '{{ dbt_utils.escape_single_quotes(value) }}'\n        then {{ then_value }}\n      else {{ else_value }}\n      end\n    )\n    {% if alias %}\n      {% if quote_identifiers %}\n            as {{ adapter.quote(prefix ~ value ~ suffix) }}\n      {% else %}\n        as {{ dbt_utils.slugify(prefix ~ value ~ suffix) }}\n      {% endif %}\n    {% endif %}\n    {% if not loop.last %},{% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.escape_single_quotes", "macro.dbt_utils.slugify"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.safe_add": {"unique_id": "macro.dbt_utils.safe_add", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\safe_add.sql", "original_file_path": "macros\\sql\\safe_add.sql", "name": "safe_add", "macro_sql": "{%- macro safe_add() -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('safe_add', 'dbt_utils')(*varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_add"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.default__safe_add": {"unique_id": "macro.dbt_utils.default__safe_add", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\safe_add.sql", "original_file_path": "macros\\sql\\safe_add.sql", "name": "default__safe_add", "macro_sql": "\n\n{%- macro default__safe_add() -%}\n\n{% set fields = [] %}\n\n{%- for field in varargs -%}\n\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\n\n{%- endfor -%}\n\n{{ fields|join(' +\\n  ') }}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.star": {"unique_id": "macro.dbt_utils.star", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\star.sql", "original_file_path": "macros\\sql\\star.sql", "name": "star", "macro_sql": "{% macro star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {{ return(adapter.dispatch('star', 'dbt_utils')(from, relation_alias, except, prefix, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__star"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.3870423}, "macro.dbt_utils.default__star": {"unique_id": "macro.dbt_utils.default__star", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\star.sql", "original_file_path": "macros\\sql\\star.sql", "name": "default__star", "macro_sql": "{% macro default__star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {%- do dbt_utils._is_relation(from, 'star') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'star') -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return('*') }}\n    {% endif %}\n\n    {% set cols = dbt_utils.get_filtered_columns_in_relation(from, except) %}\n\n    {%- if cols|length <= 0 -%}\n      {{- return('*') -}}\n    {%- else -%}\n        {%- for col in cols %}\n            {%- if relation_alias %}{{ relation_alias }}.{% else %}{%- endif -%}{{ adapter.quote(col)|trim }} {%- if prefix!='' or suffix!='' %} as {{ adapter.quote(prefix ~ col ~ suffix)|trim }} {%- endif -%}\n            {%- if not loop.last %},{{ '\\n  ' }}{% endif %}\n        {%- endfor -%}\n    {% endif %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.get_filtered_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4026766}, "macro.dbt_utils.surrogate_key": {"unique_id": "macro.dbt_utils.surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\surrogate_key.sql", "original_file_path": "macros\\sql\\surrogate_key.sql", "name": "surrogate_key", "macro_sql": "{%- macro surrogate_key(field_list) -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('surrogate_key', 'dbt_utils')(field_list, *varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4026766}, "macro.dbt_utils.default__surrogate_key": {"unique_id": "macro.dbt_utils.default__surrogate_key", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\surrogate_key.sql", "original_file_path": "macros\\sql\\surrogate_key.sql", "name": "default__surrogate_key", "macro_sql": "\n\n{%- macro default__surrogate_key(field_list) -%}\n\n{%- if varargs|length >= 1 or field_list is string %}\n\n{%- set error_message = '\nWarning: the `surrogate_key` macro now takes a single list argument instead of \\\nmultiple string arguments. Support for multiple string arguments will be \\\ndeprecated in a future release of dbt-utils. The {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.warn(error_message) -%}\n\n{# first argument is not included in varargs, so add first element to field_list_xf #}\n{%- set field_list_xf = [field_list] -%}\n\n{%- for field in varargs %}\n{%- set _ = field_list_xf.append(field) -%}\n{%- endfor -%}\n\n{%- else -%}\n\n{# if using list, just set field_list_xf as field_list #}\n{%- set field_list_xf = field_list -%}\n\n{%- endif -%}\n\n\n{%- set fields = [] -%}\n\n{%- for field in field_list_xf -%}\n\n    {%- set _ = fields.append(\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ dbt_utils.type_string() ~ \"), '')\"\n    ) -%}\n\n    {%- if not loop.last %}\n        {%- set _ = fields.append(\"'-'\") -%}\n    {%- endif -%}\n\n{%- endfor -%}\n\n{{dbt_utils.hash(dbt_utils.concat(fields))}}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.hash", "macro.dbt_utils.concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4026766}, "macro.dbt_utils.union_relations": {"unique_id": "macro.dbt_utils.union_relations", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\union.sql", "original_file_path": "macros\\sql\\union.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name, where)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4026766}, "macro.dbt_utils.default__union_relations": {"unique_id": "macro.dbt_utils.default__union_relations", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\union.sql", "original_file_path": "macros\\sql\\union.sql", "name": "default__union_relations", "macro_sql": "\n\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\n\n    {%- if exclude and include -%}\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\n    {%- endif -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\n    {%- if not execute %}\n        {{ return('') }}\n    {% endif -%}\n\n    {%- set column_override = column_override if column_override is not none else {} -%}\n\n    {%- set relation_columns = {} -%}\n    {%- set column_superset = {} -%}\n\n    {%- for relation in relations -%}\n\n        {%- do relation_columns.update({relation: []}) -%}\n\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\n        {%- for col in cols -%}\n\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\n        {%- if exclude and col.column in exclude -%}\n\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\n        {%- elif include and col.column not in include -%}\n\n        {#- Otherwise add the column to the column superset -#}\n        {%- else -%}\n\n            {#- update the list of columns in this relation -#}\n            {%- do relation_columns[relation].append(col.column) -%}\n\n            {%- if col.column in column_superset -%}\n\n                {%- set stored = column_superset[col.column] -%}\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\n\n                    {%- do column_superset.update({col.column: col}) -%}\n\n                {%- endif %}\n\n            {%- else -%}\n\n                {%- do column_superset.update({col.column: col}) -%}\n\n            {%- endif -%}\n\n        {%- endif -%}\n\n        {%- endfor -%}\n    {%- endfor -%}\n\n    {%- set ordered_column_names = column_superset.keys() -%}\n    {%- set dbt_command = flags.WHICH -%}\n\n\n    {% if dbt_command in ['run', 'build'] %}\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\n        {%- set relations_string -%}\n            {%- for relation in relations -%}\n                {{ relation.name }}\n            {%- if not loop.last %}, {% endif -%}\n            {%- endfor -%}\n        {%- endset -%}\n\n        {%- set error_message -%}\n            There were no columns found to union for relations {{ relations_string }}\n        {%- endset -%}\n\n        {{ exceptions.raise_compiler_error(error_message) }}\n    {%- endif -%}\n    {%- endif -%}\n\n    {%- for relation in relations %}\n\n        (\n            select\n\n                cast({{ dbt_utils.string_literal(relation) }} as {{ dbt_utils.type_string() }}) as {{ source_column_name }},\n                {% for col_name in ordered_column_names -%}\n\n                    {%- set col = column_superset[col_name] %}\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\n\n                {%- endfor %}\n\n            from {{ relation }}\n\n            {% if where -%}\n            where {{ where }}\n            {%- endif %}\n        )\n\n        {% if not loop.last -%}\n            union all\n        {% endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.string_literal", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.unpivot": {"unique_id": "macro.dbt_utils.unpivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\unpivot.sql", "original_file_path": "macros\\sql\\unpivot.sql", "name": "unpivot", "macro_sql": "{% macro unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n    {{ return(adapter.dispatch('unpivot', 'dbt_utils')(relation, cast_to, exclude, remove, field_name, value_name, table)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__unpivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.default__unpivot": {"unique_id": "macro.dbt_utils.default__unpivot", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\sql\\unpivot.sql", "original_file_path": "macros\\sql\\unpivot.sql", "name": "default__unpivot", "macro_sql": "{% macro default__unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n\n    {% if table %}\n        {%- set error_message = '\n            Warning: the `unpivot` macro no longer accepts a `table` parameter. \\\n            This parameter will be deprecated in a future release of dbt-utils. Use the `relation` parameter instead. \\\n            The {}.{} model triggered this warning. \\\n            '.format(model.package_name, model.name) -%}\n        {%- do exceptions.warn(error_message) -%}\n    {% endif %}\n\n    {% if relation and table %}\n        {{ exceptions.raise_compiler_error(\"Error: both the `relation` and `table` parameters were provided to `unpivot` macro. Choose one only (we recommend `relation`).\") }}\n    {% elif not relation and table %}\n        {% set relation=table %}\n    {% elif not relation and not table %}\n        {{ exceptions.raise_compiler_error(\"Error: argument `relation` is required for `unpivot` macro.\") }}\n    {% endif %}\n\n  {%- set exclude = exclude if exclude is not none else [] %}\n  {%- set remove = remove if remove is not none else [] %}\n\n  {%- set include_cols = [] %}\n\n  {%- set table_columns = {} %}\n\n  {%- do table_columns.update({relation: []}) %}\n\n  {%- do dbt_utils._is_relation(relation, 'unpivot') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'unpivot') -%}\n  {%- set cols = adapter.get_columns_in_relation(relation) %}\n\n  {%- for col in cols -%}\n    {%- if col.column.lower() not in remove|map('lower') and col.column.lower() not in exclude|map('lower') -%}\n      {% do include_cols.append(col) %}\n    {%- endif %}\n  {%- endfor %}\n\n\n  {%- for col in include_cols -%}\n    select\n      {%- for exclude_col in exclude %}\n        {{ exclude_col }},\n      {%- endfor %}\n\n      cast('{{ col.column }}' as {{ dbt_utils.type_string() }}) as {{ field_name }},\n      cast(  {% if col.data_type == 'boolean' %}\n           {{ dbt_utils.cast_bool_to_text(col.column) }}\n             {% else %}\n           {{ col.column }}\n             {% endif %}\n           as {{ cast_to }}) as {{ value_name }}\n\n    from {{ relation }}\n\n    {% if not loop.last -%}\n      union all\n    {% endif -%}\n  {%- endfor -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.type_string", "macro.dbt_utils.cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.get_url_host": {"unique_id": "macro.dbt_utils.get_url_host", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_host.sql", "original_file_path": "macros\\web\\get_url_host.sql", "name": "get_url_host", "macro_sql": "{% macro get_url_host(field) -%}\n    {{ return(adapter.dispatch('get_url_host', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_host"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.default__get_url_host": {"unique_id": "macro.dbt_utils.default__get_url_host", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_host.sql", "original_file_path": "macros\\web\\get_url_host.sql", "name": "default__get_url_host", "macro_sql": "{% macro default__get_url_host(field) -%}\n\n{%- set parsed =\n    dbt_utils.split_part(\n        dbt_utils.split_part(\n            dbt_utils.replace(\n                dbt_utils.replace(\n                    dbt_utils.replace(field, \"'android-app://'\", \"''\"\n                    ), \"'http://'\", \"''\"\n                ), \"'https://'\", \"''\"\n            ), \"'/'\", 1\n        ), \"'?'\", 1\n    )\n\n-%}\n\n\n    {{ dbt_utils.safe_cast(\n        parsed,\n        dbt_utils.type_string()\n        )}}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part", "macro.dbt_utils.replace", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.get_url_parameter": {"unique_id": "macro.dbt_utils.get_url_parameter", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_parameter.sql", "original_file_path": "macros\\web\\get_url_parameter.sql", "name": "get_url_parameter", "macro_sql": "{% macro get_url_parameter(field, url_parameter) -%}\n    {{ return(adapter.dispatch('get_url_parameter', 'dbt_utils')(field, url_parameter)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_parameter"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.default__get_url_parameter": {"unique_id": "macro.dbt_utils.default__get_url_parameter", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_parameter.sql", "original_file_path": "macros\\web\\get_url_parameter.sql", "name": "default__get_url_parameter", "macro_sql": "{% macro default__get_url_parameter(field, url_parameter) -%}\n\n{%- set formatted_url_parameter = \"'\" + url_parameter + \"='\" -%}\n\n{%- set split = dbt_utils.split_part(dbt_utils.split_part(field, formatted_url_parameter, 2), \"'&'\", 1) -%}\n\nnullif({{ split }},'')\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.get_url_path": {"unique_id": "macro.dbt_utils.get_url_path", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_path.sql", "original_file_path": "macros\\web\\get_url_path.sql", "name": "get_url_path", "macro_sql": "{% macro get_url_path(field) -%}\n    {{ return(adapter.dispatch('get_url_path', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_path"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.dbt_utils.default__get_url_path": {"unique_id": "macro.dbt_utils.default__get_url_path", "package_name": "dbt_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\dbt_utils", "path": "macros\\web\\get_url_path.sql", "original_file_path": "macros\\web\\get_url_path.sql", "name": "default__get_url_path", "macro_sql": "{% macro default__get_url_path(field) -%}\n\n    {%- set stripped_url = \n        dbt_utils.replace(\n            dbt_utils.replace(field, \"'http://'\", \"''\"), \"'https://'\", \"''\")\n    -%}\n\n    {%- set first_slash_pos -%}\n        coalesce(\n            nullif({{dbt_utils.position(\"'/'\", stripped_url)}}, 0),\n            {{dbt_utils.position(\"'?'\", stripped_url)}} - 1\n            )\n    {%- endset -%}\n\n    {%- set parsed_path =\n        dbt_utils.split_part(\n            dbt_utils.right(\n                stripped_url, \n                dbt_utils.length(stripped_url) ~ \"-\" ~ first_slash_pos\n                ), \n            \"'?'\", 1\n            )\n    -%}\n\n    {{ dbt_utils.safe_cast(\n        parsed_path,\n        dbt_utils.type_string()\n    )}}\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt_utils.position", "macro.dbt_utils.split_part", "macro.dbt_utils.right", "macro.dbt_utils.length", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4183016}, "macro.fivetran_utils.add_dbt_source_relation": {"unique_id": "macro.fivetran_utils.add_dbt_source_relation", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\add_dbt_source_relation.sql", "original_file_path": "macros\\add_dbt_source_relation.sql", "name": "add_dbt_source_relation", "macro_sql": "{% macro add_dbt_source_relation() %}\n\n{% if var('union_schemas', none) or var('union_databases', none) %}\n, _dbt_source_relation\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4339259}, "macro.fivetran_utils.add_pass_through_columns": {"unique_id": "macro.fivetran_utils.add_pass_through_columns", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\add_pass_through_columns.sql", "original_file_path": "macros\\add_pass_through_columns.sql", "name": "add_pass_through_columns", "macro_sql": "{% macro add_pass_through_columns(base_columns, pass_through_var) %}\n\n  {% if pass_through_var %}\n\n    {% for column in pass_through_var %}\n\n      {% if column.alias %}\n\n      {% do base_columns.append({ \"name\": column.name, \"alias\": column.alias, \"datatype\": column.datatype if column.datatype else dbt_utils.type_string()}) %}\n\n      {% else %}\n\n      {% do base_columns.append({ \"name\": column.name, \"datatype\": column.datatype if column.datatype else dbt_utils.type_string()}) %}\n        \n      {% endif %}\n\n    {% endfor %}\n\n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.435632}, "macro.fivetran_utils.array_agg": {"unique_id": "macro.fivetran_utils.array_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\array_agg.sql", "original_file_path": "macros\\array_agg.sql", "name": "array_agg", "macro_sql": "{% macro array_agg(field_to_agg) -%}\n\n{{ adapter.dispatch('array_agg', 'fivetran_utils') (field_to_agg) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__array_agg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.435632}, "macro.fivetran_utils.default__array_agg": {"unique_id": "macro.fivetran_utils.default__array_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\array_agg.sql", "original_file_path": "macros\\array_agg.sql", "name": "default__array_agg", "macro_sql": "{% macro default__array_agg(field_to_agg) %}\n    array_agg({{ field_to_agg }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.435632}, "macro.fivetran_utils.redshift__array_agg": {"unique_id": "macro.fivetran_utils.redshift__array_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\array_agg.sql", "original_file_path": "macros\\array_agg.sql", "name": "redshift__array_agg", "macro_sql": "{% macro redshift__array_agg(field_to_agg) %}\n    listagg({{ field_to_agg }}, ',')\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.435632}, "macro.fivetran_utils.calculated_fields": {"unique_id": "macro.fivetran_utils.calculated_fields", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\calculated_fields.sql", "original_file_path": "macros\\calculated_fields.sql", "name": "calculated_fields", "macro_sql": "{% macro calculated_fields(variable) -%}\n\n{% if var(variable, none) %}\n    {% for field in var(variable) %}\n        , {{ field.transform_sql }} as {{ field.name }} \n    {% endfor %}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.437828}, "macro.fivetran_utils.ceiling": {"unique_id": "macro.fivetran_utils.ceiling", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\ceiling.sql", "original_file_path": "macros\\ceiling.sql", "name": "ceiling", "macro_sql": "{% macro ceiling(num) -%}\n\n{{ adapter.dispatch('ceiling', 'fivetran_utils') (num) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__ceiling"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4393444}, "macro.fivetran_utils.default__ceiling": {"unique_id": "macro.fivetran_utils.default__ceiling", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\ceiling.sql", "original_file_path": "macros\\ceiling.sql", "name": "default__ceiling", "macro_sql": "{% macro default__ceiling(num) %}\n    ceiling({{ num }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4393444}, "macro.fivetran_utils.snowflake__ceiling": {"unique_id": "macro.fivetran_utils.snowflake__ceiling", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\ceiling.sql", "original_file_path": "macros\\ceiling.sql", "name": "snowflake__ceiling", "macro_sql": "{% macro snowflake__ceiling(num) %}\n    ceil({{ num }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4393444}, "macro.fivetran_utils.collect_freshness": {"unique_id": "macro.fivetran_utils.collect_freshness", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\collect_freshness.sql", "original_file_path": "macros\\collect_freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4405885}, "macro.fivetran_utils.default__collect_freshness": {"unique_id": "macro.fivetran_utils.default__collect_freshness", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\collect_freshness.sql", "original_file_path": "macros\\collect_freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n\n  {%- set enabled_array = [] -%}\n  {% for node in graph.sources.values() %}\n    {% if node.identifier == source.identifier %}\n      {% if (node.meta['is_enabled'] | default(true)) %}\n        {%- do enabled_array.append(1) -%}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n  {% set is_enabled = (enabled_array != []) %}\n\n    select\n      {% if is_enabled %}\n      max({{ loaded_at_field }})\n      {% else %} \n      {{ current_timestamp() }} {% endif %} as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n\n    {% if is_enabled %}\n    from {{ source }}\n      {% if filter %}\n      where {{ filter }}\n      {% endif %}\n    {% endif %}\n\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.44219}, "macro.fivetran_utils.dummy_coalesce_value": {"unique_id": "macro.fivetran_utils.dummy_coalesce_value", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\dummy_coalesce_value.sql", "original_file_path": "macros\\dummy_coalesce_value.sql", "name": "dummy_coalesce_value", "macro_sql": "{% macro dummy_coalesce_value(column) %}\n\n{% set coalesce_value = {\n 'STRING': \"'DUMMY_STRING'\",\n 'BOOLEAN': 'null',\n 'INT': 999999999,\n 'FLOAT': 999999999.99,\n 'TIMESTAMP': 'cast(\"2099-12-31\" as timestamp)',\n 'DATE': 'cast(\"2099-12-31\" as date)',\n} %}\n\n{% if column.is_float() %}\n{{ return(coalesce_value['FLOAT']) }}\n\n{% elif column.is_numeric() %}\n{{ return(coalesce_value['INT']) }}\n\n{% elif column.is_string() %}\n{{ return(coalesce_value['STRING']) }}\n\n{% elif column.data_type|lower == 'boolean' %}\n{{ return(coalesce_value['BOOLEAN']) }}\n\n{% elif 'timestamp' in column.data_type|lower %}\n{{ return(coalesce_value['TIMESTAMP']) }}\n\n{% elif 'date' in column.data_type|lower %}\n{{ return(coalesce_value['DATE']) }}\n\n{% elif 'int' in column.data_type|lower %}\n{{ return(coalesce_value['INT']) }}\n\n{% endif %}\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.44219}, "macro.fivetran_utils.empty_variable_warning": {"unique_id": "macro.fivetran_utils.empty_variable_warning", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\empty_variable_warning.sql", "original_file_path": "macros\\empty_variable_warning.sql", "name": "empty_variable_warning", "macro_sql": "{% macro empty_variable_warning(variable, downstream_model) %}\n\n{% if not var(variable) %}\n{{ log(\n    \"\"\"\n    Warning: You have passed an empty list to the \"\"\" ~ variable ~ \"\"\".\n    As a result, you won't see the history of any columns in the \"\"\" ~ downstream_model ~ \"\"\" model.\n    \"\"\",\n    info=True\n) }}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.44219}, "macro.fivetran_utils.enabled_vars": {"unique_id": "macro.fivetran_utils.enabled_vars", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\enabled_vars.sql", "original_file_path": "macros\\enabled_vars.sql", "name": "enabled_vars", "macro_sql": "{% macro enabled_vars(vars) %}\n\n{% for v in vars %}\n    \n    {% if var(v, True) == False %}\n    {{ return(False) }}\n    {% endif %}\n\n{% endfor %}\n\n{{ return(True) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4504755}, "macro.fivetran_utils.enabled_vars_one_true": {"unique_id": "macro.fivetran_utils.enabled_vars_one_true", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\enabled_vars_one_true.sql", "original_file_path": "macros\\enabled_vars_one_true.sql", "name": "enabled_vars_one_true", "macro_sql": "{% macro enabled_vars_one_true(vars) %}\n\n{% for v in vars %}\n    \n    {% if var(v, False) == True %}\n    {{ return(True) }}\n    {% endif %}\n\n{% endfor %}\n\n{{ return(False) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.fill_pass_through_columns": {"unique_id": "macro.fivetran_utils.fill_pass_through_columns", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\fill_pass_through_columns.sql", "original_file_path": "macros\\fill_pass_through_columns.sql", "name": "fill_pass_through_columns", "macro_sql": "{% macro fill_pass_through_columns(pass_through_variable) %}\n\n{% if var(pass_through_variable) %}\n    {% for field in var(pass_through_variable) %}\n        {% if field.transform_sql %}\n            , {{ field.transform_sql }} as {{ field.alias if field.alias else field.name }}\n        {% else %}\n            , {{ field.alias if field.alias else field.name }}\n        {% endif %}\n    {% endfor %}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.fill_staging_columns": {"unique_id": "macro.fivetran_utils.fill_staging_columns", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\fill_staging_columns.sql", "original_file_path": "macros\\fill_staging_columns.sql", "name": "fill_staging_columns", "macro_sql": "{% macro fill_staging_columns(source_columns, staging_columns) -%}\n\n{%- set source_column_names = source_columns|map(attribute='name')|map('lower')|list -%}\n\n{%- for column in staging_columns %}\n    {% if column.name|lower in source_column_names -%}\n        {{ fivetran_utils.quote_column(column) }} as \n        {%- if 'alias' in column %} {{ column.alias }} {% else %} {{ fivetran_utils.quote_column(column) }} {%- endif -%}\n    {%- else -%}\n        cast(null as {{ column.datatype }})\n        {%- if 'alias' in column %} as {{ column.alias }} {% else %} as {{ fivetran_utils.quote_column(column) }} {% endif -%}\n    {%- endif -%}\n    {%- if not loop.last -%} , {% endif -%}\n{% endfor %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.quote_column"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.quote_column": {"unique_id": "macro.fivetran_utils.quote_column", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\fill_staging_columns.sql", "original_file_path": "macros\\fill_staging_columns.sql", "name": "quote_column", "macro_sql": "{% macro quote_column(column) %}\n    {% if 'quote' in column %}\n        {% if column.quote %}\n            {% if target.type in ('bigquery', 'spark') %}\n            `{{ column.name }}`\n            {% elif target.type == 'snowflake' %}\n            \"{{ column.name | upper }}\"\n            {% else %}\n            \"{{ column.name }}\"\n            {% endif %}\n        {% else %}\n        {{ column.name }}\n        {% endif %}\n    {% else %}\n    {{ column.name }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.first_value": {"unique_id": "macro.fivetran_utils.first_value", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\first_value.sql", "original_file_path": "macros\\first_value.sql", "name": "first_value", "macro_sql": "{% macro first_value(first_value_field, partition_field, order_by_field, order=\"asc\") -%}\n\n{{ adapter.dispatch('first_value', 'fivetran_utils') (first_value_field, partition_field, order_by_field, order) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__first_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.default__first_value": {"unique_id": "macro.fivetran_utils.default__first_value", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\first_value.sql", "original_file_path": "macros\\first_value.sql", "name": "default__first_value", "macro_sql": "{% macro default__first_value(first_value_field, partition_field, order_by_field, order=\"asc\")  %}\n\n    first_value( {{ first_value_field }} ignore nulls ) over (partition by {{ partition_field }} order by {{ order_by_field }} {{ order }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.redshift__first_value": {"unique_id": "macro.fivetran_utils.redshift__first_value", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\first_value.sql", "original_file_path": "macros\\first_value.sql", "name": "redshift__first_value", "macro_sql": "{% macro redshift__first_value(first_value_field, partition_field, order_by_field, order=\"asc\") %}\n\n    first_value( {{ first_value_field }} ignore nulls ) over (partition by {{ partition_field }} order by {{ order_by_field }} {{ order }} , {{ partition_field }} rows unbounded preceding )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.json_extract": {"unique_id": "macro.fivetran_utils.json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "json_extract", "macro_sql": "{% macro json_extract(string, string_path) -%}\n\n{{ adapter.dispatch('json_extract', 'fivetran_utils') (string, string_path) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__json_extract"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.default__json_extract": {"unique_id": "macro.fivetran_utils.default__json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "default__json_extract", "macro_sql": "{% macro default__json_extract(string, string_path) %}\n\n  json_extract_path_text({{string}}, {{ \"'\" ~ string_path ~ \"'\" }} )\n \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.snowflake__json_extract": {"unique_id": "macro.fivetran_utils.snowflake__json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "snowflake__json_extract", "macro_sql": "{% macro snowflake__json_extract(string, string_path) %}\n\n  json_extract_path_text(try_parse_json( {{string}} ), {{ \"'\" ~ string_path ~ \"'\" }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.redshift__json_extract": {"unique_id": "macro.fivetran_utils.redshift__json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "redshift__json_extract", "macro_sql": "{% macro redshift__json_extract(string, string_path) %}\n\n  case when is_valid_json( {{string}} ) then json_extract_path_text({{string}}, {{ \"'\" ~ string_path ~ \"'\" }} ) else null end\n \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.bigquery__json_extract": {"unique_id": "macro.fivetran_utils.bigquery__json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "bigquery__json_extract", "macro_sql": "{% macro bigquery__json_extract(string, string_path) %}\n\n  json_extract_scalar({{string}}, {{ \"'$.\" ~ string_path ~ \"'\" }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.postgres__json_extract": {"unique_id": "macro.fivetran_utils.postgres__json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_extract.sql", "original_file_path": "macros\\json_extract.sql", "name": "postgres__json_extract", "macro_sql": "{% macro postgres__json_extract(string, string_path) %}\n\n  {{string}}::json->>{{\"'\" ~ string_path ~ \"'\" }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4523141}, "macro.fivetran_utils.json_parse": {"unique_id": "macro.fivetran_utils.json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "json_parse", "macro_sql": "{% macro json_parse(string, string_path) -%}\n\n{{ adapter.dispatch('json_parse', 'fivetran_utils') (string, string_path) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__json_parse"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.default__json_parse": {"unique_id": "macro.fivetran_utils.default__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "default__json_parse", "macro_sql": "{% macro default__json_parse(string, string_path) %}\n\n  json_extract_path_text({{string}}, {%- for s in string_path -%}'{{ s }}'{%- if not loop.last -%},{%- endif -%}{%- endfor -%} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.redshift__json_parse": {"unique_id": "macro.fivetran_utils.redshift__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "redshift__json_parse", "macro_sql": "{% macro redshift__json_parse(string, string_path) %}\n\n  json_extract_path_text({{string}}, {%- for s in string_path -%}'{{ s }}'{%- if not loop.last -%},{%- endif -%}{%- endfor -%} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.bigquery__json_parse": {"unique_id": "macro.fivetran_utils.bigquery__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "bigquery__json_parse", "macro_sql": "{% macro bigquery__json_parse(string, string_path) %}\n\n \n  json_extract_scalar({{string}}, '$.{%- for s in string_path -%}{{ s }}{%- if not loop.last -%}.{%- endif -%}{%- endfor -%} ')\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.postgres__json_parse": {"unique_id": "macro.fivetran_utils.postgres__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "postgres__json_parse", "macro_sql": "{% macro postgres__json_parse(string, string_path) %}\n\n  {{string}}::json #>> '{ {%- for s in string_path -%}{{ s }}{%- if not loop.last -%},{%- endif -%}{%- endfor -%} }'\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.snowflake__json_parse": {"unique_id": "macro.fivetran_utils.snowflake__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "snowflake__json_parse", "macro_sql": "{% macro snowflake__json_parse(string, string_path) %}\n\n  parse_json( {{string}} ) {%- for s in string_path -%}{% if s is number %}[{{ s }}]{% else %}['{{ s }}']{% endif %}{%- endfor -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.spark__json_parse": {"unique_id": "macro.fivetran_utils.spark__json_parse", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\json_parse.sql", "original_file_path": "macros\\json_parse.sql", "name": "spark__json_parse", "macro_sql": "{% macro spark__json_parse(string, string_path) %}\n\n  {{string}} : {%- for s in string_path -%}{% if s is number %}[{{ s }}]{% else %}['{{ s }}']{% endif %}{%- endfor -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4663212}, "macro.fivetran_utils.max_bool": {"unique_id": "macro.fivetran_utils.max_bool", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\max_bool.sql", "original_file_path": "macros\\max_bool.sql", "name": "max_bool", "macro_sql": "{% macro max_bool(boolean_field) -%}\n\n{{ adapter.dispatch('max_bool', 'fivetran_utils') (boolean_field) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__max_bool"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.default__max_bool": {"unique_id": "macro.fivetran_utils.default__max_bool", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\max_bool.sql", "original_file_path": "macros\\max_bool.sql", "name": "default__max_bool", "macro_sql": "{% macro default__max_bool(boolean_field)  %}\n\n    bool_or( {{ boolean_field }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.snowflake__max_bool": {"unique_id": "macro.fivetran_utils.snowflake__max_bool", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\max_bool.sql", "original_file_path": "macros\\max_bool.sql", "name": "snowflake__max_bool", "macro_sql": "{% macro snowflake__max_bool(boolean_field)  %}\n\n    max( {{ boolean_field }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.bigquery__max_bool": {"unique_id": "macro.fivetran_utils.bigquery__max_bool", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\max_bool.sql", "original_file_path": "macros\\max_bool.sql", "name": "bigquery__max_bool", "macro_sql": "{% macro bigquery__max_bool(boolean_field)  %}\n\n    max( {{ boolean_field }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.percentile": {"unique_id": "macro.fivetran_utils.percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "percentile", "macro_sql": "{% macro percentile(percentile_field, partition_field, percent) -%}\n\n{{ adapter.dispatch('percentile', 'fivetran_utils') (percentile_field, partition_field, percent) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__percentile"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.default__percentile": {"unique_id": "macro.fivetran_utils.default__percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "default__percentile", "macro_sql": "{% macro default__percentile(percentile_field, partition_field, percent)  %}\n\n    percentile_cont( \n        {{ percent }} )\n        within group ( order by {{ percentile_field }} )\n        over ( partition by {{ partition_field }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.redshift__percentile": {"unique_id": "macro.fivetran_utils.redshift__percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "redshift__percentile", "macro_sql": "{% macro redshift__percentile(percentile_field, partition_field, percent)  %}\n\n    percentile_cont( \n        {{ percent }} )\n        within group ( order by {{ percentile_field }} )\n        over ( partition by {{ partition_field }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.bigquery__percentile": {"unique_id": "macro.fivetran_utils.bigquery__percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "bigquery__percentile", "macro_sql": "{% macro bigquery__percentile(percentile_field, partition_field, percent)  %}\n\n    percentile_cont( \n        {{ percentile_field }}, \n        {{ percent }}) \n        over (partition by {{ partition_field }}    \n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.postgres__percentile": {"unique_id": "macro.fivetran_utils.postgres__percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "postgres__percentile", "macro_sql": "{% macro postgres__percentile(percentile_field, partition_field, percent)  %}\n\n    percentile_cont( \n        {{ percent }} )\n        within group ( order by {{ percentile_field }} )\n    /* have to group by partition field */\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.spark__percentile": {"unique_id": "macro.fivetran_utils.spark__percentile", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\percentile.sql", "original_file_path": "macros\\percentile.sql", "name": "spark__percentile", "macro_sql": "{% macro spark__percentile(percentile_field, partition_field, percent)  %}\n\n    percentile( \n        {{ percentile_field }}, \n        {{ percent }}) \n        over (partition by {{ partition_field }}    \n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.persist_pass_through_columns": {"unique_id": "macro.fivetran_utils.persist_pass_through_columns", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\persist_pass_through_columns.sql", "original_file_path": "macros\\persist_pass_through_columns.sql", "name": "persist_pass_through_columns", "macro_sql": "{% macro persist_pass_through_columns(pass_through_variable) %}\n\n{% if var(pass_through_variable, none) %}\n    {% for field in var(pass_through_variable) %}\n        , {{ field.alias if field.alias else field.name }}\n    {% endfor %}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.pivot_json_extract": {"unique_id": "macro.fivetran_utils.pivot_json_extract", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\pivot_json_extract.sql", "original_file_path": "macros\\pivot_json_extract.sql", "name": "pivot_json_extract", "macro_sql": "{% macro pivot_json_extract(string, list_of_properties) %}\n\n{%- for property in list_of_properties -%}\n\nreplace( {{ fivetran_utils.json_extract(string, property) }}, '\"', '') as {{ property | replace(' ', '_') | lower }}\n\n{%- if not loop.last -%},{%- endif %}\n{% endfor -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.json_extract"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.remove_prefix_from_columns": {"unique_id": "macro.fivetran_utils.remove_prefix_from_columns", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\remove_prefix_from_columns.sql", "original_file_path": "macros\\remove_prefix_from_columns.sql", "name": "remove_prefix_from_columns", "macro_sql": "{% macro remove_prefix_from_columns(columns, prefix='', exclude=[]) %}\n\n        {%- for col in columns if col.name not in exclude -%}\n        {%- if col.name[:prefix|length]|lower == prefix -%}\n        {{ col.name }} as {{ col.name[prefix|length:] }}\n        {%- else -%}\n        {{ col.name }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n        {% endfor -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.seed_data_helper": {"unique_id": "macro.fivetran_utils.seed_data_helper", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\seed_data_helper.sql", "original_file_path": "macros\\seed_data_helper.sql", "name": "seed_data_helper", "macro_sql": "{% macro seed_data_helper(seed_name, warehouses) %}\n\n{% if target.type in warehouses %}\n    {% for w in warehouses %}\n        {% if target.type == w %}\n            {{ return(ref(seed_name ~ \"_\" ~ w ~ \"\")) }}\n        {% endif %}\n    {% endfor %}\n{% else %}\n{{ return(ref(seed_name)) }}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.4713302}, "macro.fivetran_utils.snowflake_seed_data": {"unique_id": "macro.fivetran_utils.snowflake_seed_data", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\snowflake_seed_data.sql", "original_file_path": "macros\\snowflake_seed_data.sql", "name": "snowflake_seed_data", "macro_sql": "{% macro snowflake_seed_data(seed_name) %}\n\n{% if target.type == 'snowflake' %}\n{{ return(ref(seed_name ~ '_snowflake')) }}\n{% else %}\n{{ return(ref(seed_name)) }}\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.source_relation": {"unique_id": "macro.fivetran_utils.source_relation", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\source_relation.sql", "original_file_path": "macros\\source_relation.sql", "name": "source_relation", "macro_sql": "{% macro source_relation(union_schema_variable='union_schemas', union_database_variable='union_databases') -%}\n\n{{ adapter.dispatch('source_relation', 'fivetran_utils') (union_schema_variable, union_database_variable) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__source_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.default__source_relation": {"unique_id": "macro.fivetran_utils.default__source_relation", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\source_relation.sql", "original_file_path": "macros\\source_relation.sql", "name": "default__source_relation", "macro_sql": "{% macro default__source_relation(union_schema_variable, union_database_variable) %}\n\n{% if var(union_schema_variable, none)  %}\n, case\n    {% for schema in var(union_schema_variable) %}\n    when lower(replace(replace(_dbt_source_relation,'\"',''),'`','')) like '%.{{ schema|lower }}.%' then '{{ schema|lower }}'\n    {% endfor %}\n  end as source_relation\n{% elif var(union_database_variable, none) %}\n, case\n    {% for database in var(union_database_variable) %}\n    when lower(replace(replace(_dbt_source_relation,'\"',''),'`','')) like '%{{ database|lower }}.%' then '{{ database|lower }}'\n    {% endfor %}\n  end as source_relation\n{% else %}\n, cast('' as {{ dbt_utils.type_string() }}) as source_relation\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.string_agg": {"unique_id": "macro.fivetran_utils.string_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\string_agg.sql", "original_file_path": "macros\\string_agg.sql", "name": "string_agg", "macro_sql": "{% macro string_agg(field_to_agg, delimiter) -%}\n\n{{ adapter.dispatch('string_agg', 'fivetran_utils') (field_to_agg, delimiter) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__string_agg"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.default__string_agg": {"unique_id": "macro.fivetran_utils.default__string_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\string_agg.sql", "original_file_path": "macros\\string_agg.sql", "name": "default__string_agg", "macro_sql": "{% macro default__string_agg(field_to_agg, delimiter) %}\n    string_agg({{ field_to_agg }}, {{ delimiter }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.snowflake__string_agg": {"unique_id": "macro.fivetran_utils.snowflake__string_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\string_agg.sql", "original_file_path": "macros\\string_agg.sql", "name": "snowflake__string_agg", "macro_sql": "{% macro snowflake__string_agg(field_to_agg, delimiter) %}\n    listagg({{ field_to_agg }}, {{ delimiter }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.redshift__string_agg": {"unique_id": "macro.fivetran_utils.redshift__string_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\string_agg.sql", "original_file_path": "macros\\string_agg.sql", "name": "redshift__string_agg", "macro_sql": "{% macro redshift__string_agg(field_to_agg, delimiter) %}\n    listagg({{ field_to_agg }}, {{ delimiter }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.spark__string_agg": {"unique_id": "macro.fivetran_utils.spark__string_agg", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\string_agg.sql", "original_file_path": "macros\\string_agg.sql", "name": "spark__string_agg", "macro_sql": "{% macro spark__string_agg(field_to_agg, delimiter) %}\n    -- collect set will remove duplicates\n    replace(replace(replace(cast( collect_set({{ field_to_agg }}) as string), '[', ''), ']', ''), ', ', {{ delimiter }} )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.timestamp_add": {"unique_id": "macro.fivetran_utils.timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "timestamp_add", "macro_sql": "{% macro timestamp_add(datepart, interval, from_timestamp) -%}\n\n{{ adapter.dispatch('timestamp_add', 'fivetran_utils') (datepart, interval, from_timestamp) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__timestamp_add"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.default__timestamp_add": {"unique_id": "macro.fivetran_utils.default__timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "default__timestamp_add", "macro_sql": "{% macro default__timestamp_add(datepart, interval, from_timestamp) %}\n\n    timestampadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.bigquery__timestamp_add": {"unique_id": "macro.fivetran_utils.bigquery__timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "bigquery__timestamp_add", "macro_sql": "{% macro bigquery__timestamp_add(datepart, interval, from_timestamp) %}\n\n        timestamp_add({{ from_timestamp }}, interval  {{ interval }} {{ datepart }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.redshift__timestamp_add": {"unique_id": "macro.fivetran_utils.redshift__timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "redshift__timestamp_add", "macro_sql": "{% macro redshift__timestamp_add(datepart, interval, from_timestamp) %}\n\n        dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.postgres__timestamp_add": {"unique_id": "macro.fivetran_utils.postgres__timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "postgres__timestamp_add", "macro_sql": "{% macro postgres__timestamp_add(datepart, interval, from_timestamp) %}\n\n    {{ from_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.spark__timestamp_add": {"unique_id": "macro.fivetran_utils.spark__timestamp_add", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_add.sql", "original_file_path": "macros\\timestamp_add.sql", "name": "spark__timestamp_add", "macro_sql": "{% macro spark__timestamp_add(datepart, interval, from_timestamp) %}\n\n    {{ dbt_utils.dateadd(datepart, interval, from_timestamp) }}\n        \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.timestamp_diff": {"unique_id": "macro.fivetran_utils.timestamp_diff", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_diff.sql", "original_file_path": "macros\\timestamp_diff.sql", "name": "timestamp_diff", "macro_sql": "{% macro timestamp_diff(first_date, second_date, datepart) %}\n  {{ adapter.dispatch('timestamp_diff', 'fivetran_utils')(first_date, second_date, datepart) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__timestamp_diff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.default__timestamp_diff": {"unique_id": "macro.fivetran_utils.default__timestamp_diff", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_diff.sql", "original_file_path": "macros\\timestamp_diff.sql", "name": "default__timestamp_diff", "macro_sql": "{% macro default__timestamp_diff(first_date, second_date, datepart) %}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.redshift__timestamp_diff": {"unique_id": "macro.fivetran_utils.redshift__timestamp_diff", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_diff.sql", "original_file_path": "macros\\timestamp_diff.sql", "name": "redshift__timestamp_diff", "macro_sql": "{% macro redshift__timestamp_diff(first_date, second_date, datepart) %}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.bigquery__timestamp_diff": {"unique_id": "macro.fivetran_utils.bigquery__timestamp_diff", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_diff.sql", "original_file_path": "macros\\timestamp_diff.sql", "name": "bigquery__timestamp_diff", "macro_sql": "{% macro bigquery__timestamp_diff(first_date, second_date, datepart) %}\n\n    timestamp_diff(\n        {{second_date}},\n        {{first_date}},\n        {{datepart}}\n    )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.482337}, "macro.fivetran_utils.postgres__timestamp_diff": {"unique_id": "macro.fivetran_utils.postgres__timestamp_diff", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\timestamp_diff.sql", "original_file_path": "macros\\timestamp_diff.sql", "name": "postgres__timestamp_diff", "macro_sql": "{% macro postgres__timestamp_diff(first_date, second_date, datepart) %}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.try_cast": {"unique_id": "macro.fivetran_utils.try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "try_cast", "macro_sql": "{% macro try_cast(field, type) %}\n    {{ adapter.dispatch('try_cast', 'fivetran_utils') (field, type) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.snowflake__try_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.default__safe_cast": {"unique_id": "macro.fivetran_utils.default__safe_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.redshift__try_cast": {"unique_id": "macro.fivetran_utils.redshift__try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "redshift__try_cast", "macro_sql": "{% macro redshift__try_cast(field, type) %}\n{%- if type == 'numeric' -%}\n\n    case\n        when trim({{field}}) ~ '^(0|[1-9][0-9]*)$' then trim({{field}})\n        else null\n    end::{{type}}\n\n{% else %}\n    {{ exceptions.raise_compiler_error(\n            \"non-numeric datatypes are not currently supported\") }}\n\n{% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.postgres__try_cast": {"unique_id": "macro.fivetran_utils.postgres__try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "postgres__try_cast", "macro_sql": "{% macro postgres__try_cast(field, type) %}\n{%- if type == 'numeric' -%}\n\n    case\n        when replace(cast({{field}} as varchar),cast(' ' as varchar),cast('' as varchar)) ~ '^(0|[1-9][0-9]*)$' \n        then replace(cast({{field}} as varchar),cast(' ' as varchar),cast('' as varchar))\n        else null\n    end::{{type}}\n\n{% else %}\n    {{ exceptions.raise_compiler_error(\n            \"non-numeric datatypes are not currently supported\") }}\n\n{% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.snowflake__try_cast": {"unique_id": "macro.fivetran_utils.snowflake__try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "snowflake__try_cast", "macro_sql": "{% macro snowflake__try_cast(field, type) %}\n    try_cast(cast({{field}} as varchar) as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.bigquery__try_cast": {"unique_id": "macro.fivetran_utils.bigquery__try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "bigquery__try_cast", "macro_sql": "{% macro bigquery__try_cast(field, type) %}\n    safe_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.spark__try_cast": {"unique_id": "macro.fivetran_utils.spark__try_cast", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\try_cast.sql", "original_file_path": "macros\\try_cast.sql", "name": "spark__try_cast", "macro_sql": "{% macro spark__try_cast(field, type) %}\n    try_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.union_data": {"unique_id": "macro.fivetran_utils.union_data", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\union_data.sql", "original_file_path": "macros\\union_data.sql", "name": "union_data", "macro_sql": "{% macro union_data(table_identifier, database_variable, schema_variable, default_database, default_schema, default_variable, union_schema_variable='union_schemas', union_database_variable='union_databases') -%}\n\n{{ adapter.dispatch('union_data', 'fivetran_utils') (\n    table_identifier, \n    database_variable, \n    schema_variable, \n    default_database, \n    default_schema, \n    default_variable,\n    union_schema_variable,\n    union_database_variable\n    ) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.fivetran_utils.default__union_data"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.default__union_data": {"unique_id": "macro.fivetran_utils.default__union_data", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\union_data.sql", "original_file_path": "macros\\union_data.sql", "name": "default__union_data", "macro_sql": "{% macro default__union_data(\n    table_identifier, \n    database_variable, \n    schema_variable, \n    default_database, \n    default_schema, \n    default_variable,\n    union_schema_variable,\n    union_database_variable\n    ) %}\n\n{% if var(union_schema_variable, none) %}\n\n    {% set relations = [] %}\n    \n    {% if var(union_schema_variable) is string %}\n    {% set trimmed = var(union_schema_variable)|trim('[')|trim(']') %}\n    {% set schemas = trimmed.split(',')|map('trim',\" \")|map('trim','\"')|map('trim',\"'\") %}\n    {% else %}\n    {% set schemas = var(union_schema_variable) %}\n    {% endif %}\n\n    {% for schema in var(union_schema_variable) %}\n\n    {% set relation=adapter.get_relation(\n        database=var(database_variable, default_database),\n        schema=schema,\n        identifier=table_identifier\n    ) -%}\n    \n    {% set relation_exists=relation is not none %}\n\n    {% if relation_exists %}\n\n    {% do relations.append(relation) %}\n    \n    {% endif %}\n\n    {% endfor %}\n\n    {{ dbt_utils.union_relations(relations) }}\n\n{% elif var(union_database_variable, none) %}\n\n    {% set relations = [] %}\n\n    {% for database in var(union_database_variable) %}\n\n    {% set relation=adapter.get_relation(\n        database=database,\n        schema=var(schema_variable, default_schema),\n        identifier=table_identifier\n    ) -%}\n\n    {% set relation_exists=relation is not none %}\n\n    {% if relation_exists %}\n\n    {% do relations.append(relation) %}\n    \n    {% endif %}\n\n    {% endfor %}\n\n    {{ dbt_utils.union_relations(relations) }}\n\n{% else %}\n\n    select * \n    from {{ var(default_variable) }}\n\n{% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.49797}, "macro.fivetran_utils.union_relations": {"unique_id": "macro.fivetran_utils.union_relations", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\union_relations.sql", "original_file_path": "macros\\union_relations.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, aliases=none, column_override=none, include=[], exclude=[], source_column_name=none) -%}\n\n    {%- if exclude and include -%}\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\n    {%- endif -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\n    {%- if not execute %}\n        {{ return('') }}\n    {% endif -%}\n\n    {%- set column_override = column_override if column_override is not none else {} -%}\n    {%- set source_column_name = source_column_name if source_column_name is not none else '_dbt_source_relation' -%}\n\n    {%- set relation_columns = {} -%}\n    {%- set column_superset = {} -%}\n\n    {%- for relation in relations -%}\n\n        {%- do relation_columns.update({relation: []}) -%}\n\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\n        {%- for col in cols -%}\n\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\n        {%- if exclude and col.column in exclude -%}\n\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\n        {%- elif include and col.column not in include -%}\n\n        {#- Otherwise add the column to the column superset -#}\n        {%- else -%}\n\n            {#- update the list of columns in this relation -#}\n            {%- do relation_columns[relation].append(col.column) -%}\n\n            {%- if col.column in column_superset -%}\n\n                {%- set stored = column_superset[col.column] -%}\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\n\n                    {%- do column_superset.update({col.column: col}) -%}\n\n                {%- endif %}\n\n            {%- else -%}\n\n                {%- do column_superset.update({col.column: col}) -%}\n\n            {%- endif -%}\n\n        {%- endif -%}\n\n        {%- endfor -%}\n    {%- endfor -%}\n\n    {%- set ordered_column_names = column_superset.keys() -%}\n\n    {%- for relation in relations %}\n\n        (\n            select\n\n                cast({{ dbt_utils.string_literal(relation) }} as {{ dbt_utils.type_string() }}) as {{ source_column_name }},\n                {% for col_name in ordered_column_names -%}\n\n                    {%- set col = column_superset[col_name] %}\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\n\n                {%- endfor %}\n\n            from {{ aliases[loop.index0] if aliases else relation }}\n        )\n\n        {% if not loop.last -%}\n            union all\n        {% endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils.string_literal", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.fivetran_utils.union_tables": {"unique_id": "macro.fivetran_utils.union_tables", "package_name": "fivetran_utils", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\fivetran_utils", "path": "macros\\union_relations.sql", "original_file_path": "macros\\union_relations.sql", "name": "union_tables", "macro_sql": "{%- macro union_tables(tables, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_table') -%}\n\n    {%- do exceptions.warn(\"Warning: the `union_tables` macro is no longer supported and will be deprecated in a future release of dbt-utils. Use the `union_relations` macro instead\") -%}\n\n    {{ return(dbt_utils.union_relations(tables, column_override, include, exclude, source_column_name)) }}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.intercom_source.get_admin_columns": {"unique_id": "macro.intercom_source.get_admin_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_admin_columns.sql", "original_file_path": "macros\\get_admin_columns.sql", "name": "get_admin_columns", "macro_sql": "{% macro get_admin_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"job_title\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"name\", \"datatype\": dbt_utils.type_string()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_string", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.intercom_source.get_company_history_columns": {"unique_id": "macro.intercom_source.get_company_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_company_history_columns.sql", "original_file_path": "macros\\get_company_history_columns.sql", "name": "get_company_history_columns", "macro_sql": "{% macro get_company_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"created_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"industry\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"monthly_spend\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"name\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"plan_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"plan_name\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"session_count\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"user_count\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"website\", \"datatype\": dbt_utils.type_int()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_string", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.intercom_source.get_company_tag_history_columns": {"unique_id": "macro.intercom_source.get_company_tag_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_company_tag_history_columns.sql", "original_file_path": "macros\\get_company_tag_history_columns.sql", "name": "get_company_tag_history_columns", "macro_sql": "{% macro get_company_tag_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"company_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"company_updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"tag_id\", \"datatype\": dbt_utils.type_int()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.intercom_source.get_contact_company_history_columns": {"unique_id": "macro.intercom_source.get_contact_company_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_contact_company_history_columns.sql", "original_file_path": "macros\\get_contact_company_history_columns.sql", "name": "get_contact_company_history_columns", "macro_sql": "{% macro get_contact_company_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"company_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"contact_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"contact_updated_at\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5135953}, "macro.intercom_source.get_contact_history_columns": {"unique_id": "macro.intercom_source.get_contact_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_contact_history_columns.sql", "original_file_path": "macros\\get_contact_history_columns.sql", "name": "get_contact_history_columns", "macro_sql": "{% macro get_contact_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"admin_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"created_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"email\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"last_contacted_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"last_email_clicked_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"last_email_opened_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"last_replied_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"name\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"role\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"signed_up_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"unsubscribed_from_emails\", \"datatype\": \"boolean\"},\n    {\"name\": \"updated_at\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_contact_tag_history_columns": {"unique_id": "macro.intercom_source.get_contact_tag_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_contact_tag_history_columns.sql", "original_file_path": "macros\\get_contact_tag_history_columns.sql", "name": "get_contact_tag_history_columns", "macro_sql": "{% macro get_contact_tag_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"contact_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"contact_updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"tag_id\", \"datatype\": dbt_utils.type_int()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_conversation_contact_history_columns": {"unique_id": "macro.intercom_source.get_conversation_contact_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_conversation_contact_history_columns.sql", "original_file_path": "macros\\get_conversation_contact_history_columns.sql", "name": "get_conversation_contact_history_columns", "macro_sql": "{% macro get_conversation_contact_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"contact_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"conversation_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"conversation_updated_at\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_string", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_conversation_history_columns": {"unique_id": "macro.intercom_source.get_conversation_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_conversation_history_columns.sql", "original_file_path": "macros\\get_conversation_history_columns.sql", "name": "get_conversation_history_columns", "macro_sql": "{% macro get_conversation_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"assignee_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"assignee_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"conversation_rating_remark\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"conversation_rating_value\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"created_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"first_contact_reply_created_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"first_contact_reply_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"read\", \"datatype\": \"boolean\"},\n    {\"name\": \"sla_name\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"sla_status\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"snoozed_until\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"source_author_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"source_author_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"source_body\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"source_delivered_as\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"source_subject\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"source_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"state\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"waiting_since\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_conversation_part_history_columns": {"unique_id": "macro.intercom_source.get_conversation_part_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_conversation_part_history_columns.sql", "original_file_path": "macros\\get_conversation_part_history_columns.sql", "name": "get_conversation_part_history_columns", "macro_sql": "{% macro get_conversation_part_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"assigned_to_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"assigned_to_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"author_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"author_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"conversation_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"conversation_updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"created_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"part_type\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"updated_at\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_conversation_tag_history_columns": {"unique_id": "macro.intercom_source.get_conversation_tag_history_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_conversation_tag_history_columns.sql", "original_file_path": "macros\\get_conversation_tag_history_columns.sql", "name": "get_conversation_tag_history_columns", "macro_sql": "{% macro get_conversation_tag_history_columns() %}\n\n{% set columns = [\n    {\"name\": \"conversation_id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"conversation_updated_at\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"tag_id\", \"datatype\": dbt_utils.type_int()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_int", "macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5292206}, "macro.intercom_source.get_tag_columns": {"unique_id": "macro.intercom_source.get_tag_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_tag_columns.sql", "original_file_path": "macros\\get_tag_columns.sql", "name": "get_tag_columns", "macro_sql": "{% macro get_tag_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"name\", \"datatype\": dbt_utils.type_timestamp()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5454137}, "macro.intercom_source.get_team_admin_columns": {"unique_id": "macro.intercom_source.get_team_admin_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_team_admin_columns.sql", "original_file_path": "macros\\get_team_admin_columns.sql", "name": "get_team_admin_columns", "macro_sql": "{% macro get_team_admin_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"admin_id\", \"datatype\": dbt_utils.type_string()},\n    {\"name\": \"team_id\", \"datatype\": dbt_utils.type_int()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_string", "macro.dbt_utils.type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5454137}, "macro.intercom_source.get_team_columns": {"unique_id": "macro.intercom_source.get_team_columns", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "macros\\get_team_columns.sql", "original_file_path": "macros\\get_team_columns.sql", "name": "get_team_columns", "macro_sql": "{% macro get_team_columns() %}\n\n{% set columns = [\n    {\"name\": \"_fivetran_deleted\", \"datatype\": \"boolean\"},\n    {\"name\": \"_fivetran_synced\", \"datatype\": dbt_utils.type_timestamp()},\n    {\"name\": \"id\", \"datatype\": dbt_utils.type_int()},\n    {\"name\": \"name\", \"datatype\": dbt_utils.type_string()}\n] %}\n\n{{ return(columns) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp", "macro.dbt_utils.type_int", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5483892}, "macro.metrics.aggregate_primary_metric": {"unique_id": "macro.metrics.aggregate_primary_metric", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "aggregate_primary_metric", "macro_sql": "{% macro aggregate_primary_metric(aggregate, expression) %}\n    {{ return(adapter.dispatch('aggregate_primary_metric', 'metrics')(aggregate, expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__aggregate_primary_metric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__aggregate_primary_metric": {"unique_id": "macro.metrics.default__aggregate_primary_metric", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__aggregate_primary_metric", "macro_sql": "{% macro default__aggregate_primary_metric(aggregate, expression) %}\n    {% if aggregate == 'count' %}\n        {{ return(adapter.dispatch('metric_count', 'metrics')(expression)) }}\n    \n    {% elif aggregate == 'count_distinct' %}\n        {{ return(adapter.dispatch('metric_count_distinct', 'metrics')(expression)) }}\n    \n    {% elif aggregate == 'average' %}\n        {{ return(adapter.dispatch('metric_average', 'metrics')(expression)) }}\n    \n    {% elif aggregate == 'max' %}\n        {{ return(adapter.dispatch('metric_max', 'metrics')(expression)) }}\n       \n    {% elif aggregate == 'min' %}\n        {{ return(adapter.dispatch('metric_min', 'metrics')(expression)) }}\n    \n    {% elif aggregate == 'sum' %}\n        {{ return(adapter.dispatch('metric_sum', 'metrics')(expression)) }}\n    \n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Unknown aggregation style: \" ~ aggregate) %}  \n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__metric_count", "macro.metrics.default__metric_count_distinct", "macro.metrics.default__metric_average", "macro.metrics.default__metric_max", "macro.metrics.default__metric_min", "macro.metrics.default__metric_sum"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_count": {"unique_id": "macro.metrics.default__metric_count", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_count", "macro_sql": "{% macro default__metric_count(expression) %}\n    count({{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_count_distinct": {"unique_id": "macro.metrics.default__metric_count_distinct", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_count_distinct", "macro_sql": "{% macro default__metric_count_distinct(expression) %}\n    count(distinct {{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_average": {"unique_id": "macro.metrics.default__metric_average", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_average", "macro_sql": "{% macro default__metric_average(expression) %}\n    avg({{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.redshift__metric_average": {"unique_id": "macro.metrics.redshift__metric_average", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "redshift__metric_average", "macro_sql": "{% macro redshift__metric_average(expression) %}\n    avg(cast({{ expression }} as float))\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_max": {"unique_id": "macro.metrics.default__metric_max", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_max", "macro_sql": "{% macro default__metric_max(expression) %}\n    max({{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_min": {"unique_id": "macro.metrics.default__metric_min", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_min", "macro_sql": "{% macro default__metric_min(expression) %}\n    min({{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.default__metric_sum": {"unique_id": "macro.metrics.default__metric_sum", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\aggregate_primary_metric.sql", "original_file_path": "macros\\aggregate_primary_metric.sql", "name": "default__metric_sum", "macro_sql": "{% macro default__metric_sum(expression) %}\n    sum({{ expression }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.get_metric_relation": {"unique_id": "macro.metrics.get_metric_relation", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\get_metric_relation.sql", "original_file_path": "macros\\get_metric_relation.sql", "name": "get_metric_relation", "macro_sql": "{% macro get_metric_relation(ref_name) %}\n    {% if execute %}\n        {% set model_ref_node = graph.nodes.values() | selectattr('name', 'equalto', ref_name[0]) | first %}\n        {% set relation = api.Relation.create(\n            database = model_ref_node.database,\n            schema = model_ref_node.schema,\n            identifier = model_ref_node.alias\n        )\n        %}\n        {% do return(relation) %}\n    {% else %}\n        {% do return(api.Relation.create()) %}\n    {% endif %} \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.get_metric_calendar": {"unique_id": "macro.metrics.get_metric_calendar", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\get_metric_relation.sql", "original_file_path": "macros\\get_metric_relation.sql", "name": "get_metric_calendar", "macro_sql": "{% macro get_metric_calendar(ref_name) %}\n    /*\n        TODO: this is HORRID.\n        Short version: How do we properly handle refs[0] for the metric's model, and the ref() syntax for the calendar table? \n    */\n\n    /*\n        Long version: even though the metric yml file has its model as a full ref\n\n        - name: slack_joiners\n        model: ref('dim_slack_users_2')\n\n        the refs array from the graph contains just the string, inside a second array:\n\n        {\n        \"fqn\":[\"joel_sandbox\",\"metrics\",\"slack_joiners\"],\n        \"unique_id\":\"metric.joel_sandbox.slack_joiners\",\n        \"time_grains\":[\"day\", \"week\", \"month\"],\n        \"dimensions\":[\"has_messaged\"],\n        \"resource_type\":\"metric\",\n        \"refs\":[\n            [\n                \"dim_slack_users_2\"\n            ]\n        ],\n        \"created_at\":1642578505.5324879\n        }\n\n\n        Whereas the calendar variable:\n        vars:\n            dbt_metrics_calendar_model: ref('all_days_extended_2')\n\n        comes through as the entire ref string (it hasn't been parsed or processed yet). \n        This splits on the ' character, takes the second element, and wraps it inside an array, \n        to have the same shape as get_metric_relation expects,\n        which is written to expect the metric's `model`.\n    */\n    \n    {% set split_ref_name = ref_name.split(\"'\")[1] %}\n    {% do return(metrics.get_metric_relation([split_ref_name])) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.get_metric_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5500386}, "macro.metrics.get_metric_sql": {"unique_id": "macro.metrics.get_metric_sql", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\get_metric_sql.sql", "original_file_path": "macros\\get_metric_sql.sql", "name": "get_metric_sql", "macro_sql": "\n\n\n{%- macro get_metric_sql(metric, grain, dimensions, secondary_calculations, start_date, end_date) %}\n{%- if not execute %}\n    {%- do return(\"not execute\") %}\n{%- endif %}\n\n{%- if not metric %}\n    {%- do exceptions.raise_compiler_error(\"No metric provided\") %}\n{%- endif %}\n\n{%- if not grain %}\n    {%- do exceptions.raise_compiler_error(\"No date grain provided\") %}\n{%- endif %}\n\n{#-/* TODO: This refs[0][0] stuff is totally ick */#}\n{%- set model = metrics.get_metric_relation(metric.refs[0] if execute else \"\") %}\n{%- set calendar_tbl = metrics.get_metric_calendar(var('dbt_metrics_calendar_model', \"ref('dbt_metrics_default_calendar')\")) %}\n\n{#- /* TODO: Do I need to validate that the requested grain is defined on the metric? */ #}\n{#- /* TODO: build a list of failures and return them all at once*/ #}\n{%- for calc_config in secondary_calculations if calc_config.aggregate %}\n    {%- do metrics.validate_aggregate_coherence(metric.type, calc_config.aggregate) %}\n{%- endfor %}\n\n{#- /* TODO: build a list of failures and return them all at once*/ #}\n{%- for calc_config in secondary_calculations if calc_config.period %}\n    {%- do metrics.validate_grain_order(grain, calc_config.period) %}\n{%- endfor %}\n\n{%- set relevant_periods = [] %}\n{%- for calc_config in secondary_calculations if calc_config.period and calc_config.period not in relevant_periods %}\n    {%- set _ = relevant_periods.append(calc_config.period) %}\n{%- endfor -%}\n\nwith source_query as (\n\n    select\n        /* Always trunc to the day, then use dimensions on calendar table to achieve the _actual_ desired aggregates. */\n        /* Need to cast as a date otherwise we get values like 2021-01-01 and 2021-01-01T00:00:00+00:00 that don't join :( */\n        cast({{ dbt_utils.date_trunc('day', 'cast(' ~ metric.timestamp ~ ' as date)') }} as date) as date_day,\n        \n        {% for dim in dimensions %}\n            {%- if metrics.is_dim_from_model(metric, dim) -%}\n                 {{ dim }},\n            {% endif -%}\n\n        {%- endfor %}\n\n        {#- /*When metric.sql is undefined or '*' for a count, \n            it's unnecessary to pull through the whole table */ #}\n        {%- if metric.sql and metric.sql | replace('*', '') | trim != '' -%}\n            {{ metric.sql }} as property_to_aggregate\n        {%- elif metric.type == 'count' -%}\n            1 as property_to_aggregate /*a specific expression to aggregate wasn't provided, so this effectively creates count(*) */\n        {%- else -%}\n            {%- do exceptions.raise_compiler_error(\"Expression to aggregate is required for non-count aggregation in metric `\" ~ metric.name ~ \"`\") -%}  \n        {%- endif %}\n\n    from {{ model }}\n    where 1=1\n    {%- for filter in metric.filters %}\n        and {{ filter.field }} {{ filter.operator }} {{ filter.value }}\n    {%- endfor %}\n),\n\n spine__time as (\n     select \n        /* this could be the same as date_day if grain is day. That's OK! \n        They're used for different things: date_day for joining to the spine, period for aggregating.*/\n        date_{{ grain }} as period, \n        {% for period in relevant_periods %}\n            date_{{ period }},\n        {% endfor %}\n        {% for dim in dimensions if not metrics.is_dim_from_model(metric, dim) %}\n            {{ dim }},\n        {% endfor %}\n        date_day\n     from {{ calendar_tbl }}\n ),\n\n{%- for dim in dimensions -%}\n    {%- if metrics.is_dim_from_model(metric, dim) %}\n          \n        spine__values__{{ dim }} as (\n\n            select distinct {{ dim }}\n            from source_query\n\n        ),  \n    {% endif -%}\n\n\n{%- endfor %}\n\nspine as (\n\n    select *\n    from spine__time\n    {%- for dim in dimensions -%}\n\n        {%- if metrics.is_dim_from_model(metric, dim) %}\n            cross join spine__values__{{ dim }}\n        {%- endif %}\n    {%- endfor %}\n\n),\n\njoined as (\n    select \n        spine.period,\n        {% for period in relevant_periods %}\n        spine.date_{{ period }},\n        {% endfor %}\n        {% for dim in dimensions %}\n        spine.{{ dim }},\n        {% endfor %}\n\n        -- has to be aggregated in this CTE to allow dimensions coming from the calendar table\n        {{- metrics.aggregate_primary_metric(metric.type, 'source_query.property_to_aggregate') }} as {{ metric.name }},\n        {{ dbt_utils.bool_or('source_query.date_day is not null') }} as has_data\n\n    from spine\n    left outer join source_query on source_query.date_day = spine.date_day\n    {% for dim in dimensions %}\n        {%- if metrics.is_dim_from_model(metric, dim) %}\n            and (  source_query.{{ dim}} = spine.{{ dim }}\n                or source_query.{{ dim }} is null and spine.{{ dim }} is null\n            )\n        {%- endif %}\n    {% endfor %}\n\n    {#- /* Add 1 twice to account for 1) timeseries dim and 2) to be inclusive of the last dim */ #}\n    group by {{ range(1, (dimensions | length) + (relevant_periods | length) + 1 + 1) | join (\", \") }}\n\n),\n\nbounded as (\n    select \n        *,\n        {% if start_date %}cast('{{ start_date }}' as date){% else %} min(case when has_data then period end) over () {% endif %} as lower_bound,\n        {% if end_date %}cast('{{ end_date }}' as date){% else %} max(case when has_data then period end) over () {% endif %} as upper_bound\n    from joined \n),\n\nsecondary_calculations as (\n\n    select *\n        \n        {% for calc_config in secondary_calculations -%}\n\n            , {{ metrics.perform_secondary_calculation(metric.name, dimensions, calc_config) -}} as {{ metrics.generate_secondary_calculation_alias(calc_config, grain) }}\n\n        {% endfor %}\n\n    from bounded\n    \n),\n\nfinal as (\n    select\n        period\n        {% for dim in dimensions %}\n        , {{ dim }}\n        {% endfor %}\n        , coalesce({{ metric.name }}, 0) as {{ metric.name }}\n        {% for calc_config in secondary_calculations %}\n        , {{ metrics.generate_secondary_calculation_alias(calc_config, grain) }}\n        {% endfor %}\n\n    from secondary_calculations\n    where period >= lower_bound\n    and period <= upper_bound\n    order by {{ range(1, (dimensions | length) + 1 + 1) | join (\", \") }}\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.get_metric_relation", "macro.metrics.get_metric_calendar", "macro.metrics.validate_aggregate_coherence", "macro.metrics.validate_grain_order", "macro.dbt_utils.date_trunc", "macro.metrics.is_dim_from_model", "macro.metrics.aggregate_primary_metric", "macro.dbt_utils.bool_or", "macro.metrics.perform_secondary_calculation", "macro.metrics.generate_secondary_calculation_alias"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5773425}, "macro.metrics.is_dim_from_model": {"unique_id": "macro.metrics.is_dim_from_model", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\is_dim_from_model.sql", "original_file_path": "macros\\is_dim_from_model.sql", "name": "is_dim_from_model", "macro_sql": "{% macro is_dim_from_model(metric, dim_name) %}\n    {% if execute %}\n        -- For now, time dimensions have to be encoded in the meta tag. \n        -- If there's no meta config, then assume all dimensions belong to the main model.\n        {% if not metric['meta']['dimensions'] %}\n            {% do return(True) %}\n        {% endif %}\n\n        {% set model_dims = (metric['meta']['dimensions'] | selectattr('type', '==', 'model') | first)['columns'] %}\n        {% do return (dim_name in model_dims) %}\n    {% else %}\n        {% do return (False) %}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5773425}, "macro.metrics.metric": {"unique_id": "macro.metrics.metric", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\metric.sql", "original_file_path": "macros\\metric.sql", "name": "metric", "macro_sql": "{% macro metric(metric_name, grain, dimensions=[], secondary_calculations=[], start_date=None, end_date=None) -%}\n    -- Need this here, since the actual ref is nested within loops/conditions:\n    -- depends on: {{ ref('dbt_metrics_default_calendar') }}\n    \n    {%- if not execute %}\n        {%- do return(\"not execute\") %}\n    {%- endif %}\n\n    {%- set metric = metrics.get_metric(metric_name) %}\n\n    {%- set sql = metrics.get_metric_sql(\n        metric=metric,\n        grain=grain,\n        dimensions=dimensions,\n        secondary_calculations=secondary_calculations,\n        start_date=start_date,\n        end_date=end_date\n    ) %}\n    ({{ sql }}) metric_subq\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.get_metric", "macro.metrics.get_metric_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5773425}, "macro.metrics.get_metric": {"unique_id": "macro.metrics.get_metric", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\metric.sql", "original_file_path": "macros\\metric.sql", "name": "get_metric", "macro_sql": "{% macro get_metric(metric_name) %}\n    {% if not execute %}\n        {% do return(None) %}\n    {% else %}\n    {% set metric_info = namespace(metric_id=none) %}\n    {% for metric in graph.metrics.values() %}\n        {% if metric.name == metric_name %}\n            {% set metric_info.metric_id = metric.unique_id %}\n        {% endif %}\n    {% endfor %}\n\n    {% if metric_info.metric_id is none %}\n        {% do exceptions.raise_compiler_error(\"Metric named '\" ~ metric_name ~ \"' not found\") %}\n    {% endif %}\n    \n\n    {% do return(graph.metrics[metric_info.metric_id]) %}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5773425}, "macro.metrics.generate_secondary_calculation_alias": {"unique_id": "macro.metrics.generate_secondary_calculation_alias", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\generate_secondary_calculation_alias.sql", "original_file_path": "macros\\secondary_calculations\\generate_secondary_calculation_alias.sql", "name": "generate_secondary_calculation_alias", "macro_sql": "{% macro generate_secondary_calculation_alias(calc_config, grain) %}\n\n    {{ return(adapter.dispatch('generate_secondary_calculation_alias', 'metrics')(calc_config, grain)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__generate_secondary_calculation_alias"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.588114}, "macro.metrics.default__generate_secondary_calculation_alias": {"unique_id": "macro.metrics.default__generate_secondary_calculation_alias", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\generate_secondary_calculation_alias.sql", "original_file_path": "macros\\secondary_calculations\\generate_secondary_calculation_alias.sql", "name": "default__generate_secondary_calculation_alias", "macro_sql": "{% macro default__generate_secondary_calculation_alias(calc_config, grain) %}\n    {% if calc_config.alias %}\n        {% do return(calc_config.alias) %}\n    {% endif %}\n    \n    {%- set calc_type = calc_config.calculation %}\n    {%- if calc_type == 'period_over_period' %}\n        {%- do return(calc_config.comparison_strategy ~ \"_to_\" ~ calc_config.interval ~ \"_\" ~ grain ~ \"_ago\") %}\n   \n    {%- elif calc_type == 'rolling' %}\n        {%- do return(\"rolling_\" ~ calc_config.aggregate ~ \"_\" ~ calc_config.interval ~ \"_\" ~ grain) %}\n    \n    {%- elif calc_type == 'period_to_date' %}\n        {%- do return(calc_config.aggregate ~ \"_for_\" ~ calc_config.period) %}\n\n    {%- else %}\n        {%- do exceptions.raise_compiler_error(\"Can't generate alias for unknown secondary calculation: \" ~ calc_type ~ \". calc_config: \" ~ calc_config) %}  \n    {%- endif %}\n\n    {{- calc_sql }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.588114}, "macro.metrics.perform_secondary_calculation": {"unique_id": "macro.metrics.perform_secondary_calculation", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\perform_secondary_calculation.sql", "original_file_path": "macros\\secondary_calculations\\perform_secondary_calculation.sql", "name": "perform_secondary_calculation", "macro_sql": "{% macro perform_secondary_calculation(metric_name, dimensions, calc_config) %}\n\n    {{ return(adapter.dispatch('perform_secondary_calculation', 'metrics')(metric_name, dimensions, calc_config)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__perform_secondary_calculation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.591083}, "macro.metrics.default__perform_secondary_calculation": {"unique_id": "macro.metrics.default__perform_secondary_calculation", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\perform_secondary_calculation.sql", "original_file_path": "macros\\secondary_calculations\\perform_secondary_calculation.sql", "name": "default__perform_secondary_calculation", "macro_sql": "{% macro default__perform_secondary_calculation(metric_name, dimensions, calc_config) %}\n    {%- set calc_type = calc_config.calculation %}\n    {%- set calc_sql = '' %}\n    \n    {%- if calc_type == 'period_over_period' %}\n        {%- set calc_sql = adapter.dispatch('secondary_calculation_period_over_period', 'metrics')(metric_name, dimensions, calc_config) %}\n   \n    {%- elif calc_type == 'rolling' %}\n        {%- set calc_sql = adapter.dispatch('secondary_calculation_rolling', 'metrics')(metric_name, dimensions, calc_config) %}\n    \n    {%- elif calc_type == 'period_to_date' %}\n        {%- set calc_sql = adapter.dispatch('secondary_calculation_period_to_date', 'metrics')(metric_name, dimensions, calc_config) %}\n    \n    {%- else %}\n        {%- do exceptions.raise_compiler_error(\"Unknown secondary calculation: \" ~ calc_type ~ \". calc_config: \" ~ calc_config) %}  \n    {%- endif %}\n\n    {{- calc_sql }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__secondary_calculation_period_over_period", "macro.metrics.default__secondary_calculation_rolling", "macro.metrics.default__secondary_calculation_period_to_date"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.591083}, "macro.metrics.default__secondary_calculation_period_over_period": {"unique_id": "macro.metrics.default__secondary_calculation_period_over_period", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "name": "default__secondary_calculation_period_over_period", "macro_sql": "{% macro default__secondary_calculation_period_over_period(metric_name, dimensions, calc_config) %}\n    {% set calc_sql %}\n        lag(\n            {{- metric_name }}, {{ calc_config.interval -}}\n        ) over (\n            {% if dimensions -%}\n                partition by {{ dimensions | join(\", \") }} \n            {% endif -%}\n            order by period\n        )\n    {% endset %}\n    \n\n    {% if calc_config.comparison_strategy == 'difference' %}\n        {% do return (adapter.dispatch('metric_comparison_strategy_difference', 'metrics')(metric_name, calc_sql)) %}\n    \n    {% elif calc_config.comparison_strategy == 'ratio' %}\n        {% do return (adapter.dispatch('metric_comparison_strategy_ratio', 'metrics')(metric_name, calc_sql)) %}\n    \n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Bad comparison_strategy for period_over_period: \" ~ calc_config.comparison_strategy ~ \". calc_config: \" ~ calc_config) %}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__metric_comparison_strategy_difference", "macro.metrics.default__metric_comparison_strategy_ratio"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5942762}, "macro.metrics.default__metric_comparison_strategy_difference": {"unique_id": "macro.metrics.default__metric_comparison_strategy_difference", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "name": "default__metric_comparison_strategy_difference", "macro_sql": "{% macro default__metric_comparison_strategy_difference(metric_name, calc_sql) %}\n    coalesce({{ metric_name }}, 0) - coalesce({{ calc_sql }}, 0)\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5942762}, "macro.metrics.default__metric_comparison_strategy_ratio": {"unique_id": "macro.metrics.default__metric_comparison_strategy_ratio", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "name": "default__metric_comparison_strategy_ratio", "macro_sql": "{% macro default__metric_comparison_strategy_ratio(metric_name, calc_sql) %}\n    cast(coalesce({{ metric_name }}, 0) / nullif({{ calc_sql }}, 0) as {{ dbt_utils.type_float() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5942762}, "macro.metrics.period_over_period": {"unique_id": "macro.metrics.period_over_period", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_over_period.sql", "name": "period_over_period", "macro_sql": "{% macro period_over_period(comparison_strategy, interval, alias) %}\n\n    {% set missing_args = [] %}\n    {% if not comparison_strategy %}\n        {% set _ = missing_args.append(\"comparison_strategy\") %}\n    {% endif %}\n    {% if not interval %} \n        {% set _ = missing_args.append(\"interval\") %}\n    {% endif %}\n    {% if missing_args | length > 0 %}\n        {% do exceptions.raise_compiler_error( missing_args | join(\", \") ~ ' not provided to period_over_period') %}\n    {% endif %}\n\n    {% do return ({\n        \"calculation\": \"period_over_period\",\n        \"comparison_strategy\": comparison_strategy,\n        \"interval\": interval,\n        \"alias\": alias\n        })\n    %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.5942762}, "macro.metrics.default__secondary_calculation_period_to_date": {"unique_id": "macro.metrics.default__secondary_calculation_period_to_date", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_to_date.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_to_date.sql", "name": "default__secondary_calculation_period_to_date", "macro_sql": "{% macro default__secondary_calculation_period_to_date(metric_name, dimensions, calc_config) %}\n    {%- set calc_sql %}\n        {{- adapter.dispatch('aggregate_primary_metric', 'metrics')(calc_config.aggregate, metric_name) -}}\n        over (\n            partition by date_{{ calc_config.period }}\n            {% if dimensions -%}\n                , {{ dimensions | join(\", \") }}\n            {%- endif %}\n            order by period\n            rows between unbounded preceding and current row\n        )\n    {%- endset %}\n\n    {%- do return (calc_sql) %}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.aggregate_primary_metric", "macro.metrics.default__aggregate_primary_metric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6005235}, "macro.metrics.period_to_date": {"unique_id": "macro.metrics.period_to_date", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_period_to_date.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_period_to_date.sql", "name": "period_to_date", "macro_sql": "{% macro period_to_date(aggregate, period, alias) %}\n\n    {% set missing_args = [] %}\n    {% if not aggregate %} \n        {% set _ = missing_args.append(\"aggregate\") %}\n    {% endif %}\n    {% if not period %}\n        {% set _ = missing_args.append(\"period\") %}\n    {% endif %}\n    {% if missing_args | length > 0 %}\n        {% do exceptions.raise_compiler_error( missing_args | join(\", \") ~ ' not provided to period_to_date') %}\n    {% endif %}\n\n    {% do return ({\n        \"calculation\": \"period_to_date\",\n        \"aggregate\": aggregate,\n        \"period\": period,\n        \"alias\": alias\n        })\n    %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6005235}, "macro.metrics.default__secondary_calculation_rolling": {"unique_id": "macro.metrics.default__secondary_calculation_rolling", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_rolling.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_rolling.sql", "name": "default__secondary_calculation_rolling", "macro_sql": "{% macro default__secondary_calculation_rolling(metric_name, dimensions, calc_config) %}\n    {% set calc_sql %}\n        {{ adapter.dispatch('aggregate_primary_metric', 'metrics')(calc_config.aggregate, metric_name) }}\n        over (\n            {% if dimensions -%}\n                partition by {{ dimensions | join(\", \") }} \n            {% endif -%}\n            order by period\n            rows between {{ calc_config.interval - 1 }} preceding and current row\n        )\n    {% endset %}\n\n    {% do return (calc_sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.aggregate_primary_metric", "macro.metrics.default__aggregate_primary_metric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6005235}, "macro.metrics.rolling": {"unique_id": "macro.metrics.rolling", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\secondary_calculation_rolling.sql", "original_file_path": "macros\\secondary_calculations\\secondary_calculation_rolling.sql", "name": "rolling", "macro_sql": "{% macro rolling(aggregate, interval, alias) %}\n\n    {% set missing_args = [] %}\n    {% if not aggregate %} \n        {% set _ = missing_args.append(\"aggregate\") %}\n    {% endif %}\n    {% if not interval %}\n        {% set _ = missing_args.append(\"interval\") %}\n    {% endif %}\n    {% if missing_args | length > 0 %}\n        {% do exceptions.raise_compiler_error( missing_args | join(\", \") ~ ' not provided to period_over_period') %}\n    {% endif %}\n\n    {% do return ({\n        \"calculation\": \"rolling\",\n        \"aggregate\": aggregate,\n        \"interval\": interval,\n        \"alias\": alias\n        })\n    %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6005235}, "macro.metrics.validate_aggregate_coherence": {"unique_id": "macro.metrics.validate_aggregate_coherence", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "original_file_path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "name": "validate_aggregate_coherence", "macro_sql": "{% macro validate_aggregate_coherence(metric_aggregate, calculation_aggregate) %}\n    {% set allowlist = metrics.get_metric_allowlist()[metric_aggregate] %}\n\n    {% if (calculation_aggregate not in allowlist) %}\n        {% do exceptions.raise_compiler_error(\"Can't calculate secondary aggregate \" ~ calculation_aggregate ~ \" when metric's aggregation is \" ~ metric_aggregate ~ \". Allowed options are \" ~ allowlist ~ \".\") %}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.get_metric_allowlist"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.607886}, "macro.metrics.get_metric_allowlist": {"unique_id": "macro.metrics.get_metric_allowlist", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "original_file_path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "name": "get_metric_allowlist", "macro_sql": "{% macro get_metric_allowlist() %}\n    {{ return(adapter.dispatch('get_metric_allowlist', 'metrics')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__get_metric_allowlist"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.607886}, "macro.metrics.default__get_metric_allowlist": {"unique_id": "macro.metrics.default__get_metric_allowlist", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "original_file_path": "macros\\secondary_calculations\\validate_aggregate_coherence.sql", "name": "default__get_metric_allowlist", "macro_sql": "{% macro default__get_metric_allowlist() %}\n    {# Keys are the primary aggregation, values are the permitted aggregations to run in secondary calculations. #}\n    {% do return ({\n        \"average\": ['min', 'max'],\n        \"count\": ['min', 'max', 'sum', 'average'],\n        \"count_distinct\": ['min', 'max', 'sum', 'average'],\n        \"sum\": ['min', 'max', 'sum', 'average'],\n        \"max\": ['min', 'max', 'sum', 'average'],\n        \"min\": ['min', 'max', 'sum', 'average'],\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6089313}, "macro.metrics.validate_grain_order": {"unique_id": "macro.metrics.validate_grain_order", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_grain_order.sql", "original_file_path": "macros\\secondary_calculations\\validate_grain_order.sql", "name": "validate_grain_order", "macro_sql": "{% macro validate_grain_order(metric_grain, calculation_grain) %}\n    {% set grains = metrics.get_grain_order() %}\n    \n    {% if metric_grain not in grains or calculation_grain not in grains %}\n        {% set comma = joiner(\", \") %}\n        {% do exceptions.raise_compiler_error(\"Unknown grains: [\" ~ (comma() ~ metric_grain if metric_grain not in grains) ~ (comma() ~ calculation_grain if calculation_grain not in grains) ~ \"]\") %}\n    {% endif %}\n\n    {% set metric_grain_index = grains.index(metric_grain) %}\n    {% set calculation_grain_index = grains.index(calculation_grain) %}\n\n    {% if (calculation_grain_index < metric_grain_index) %}\n        {% do exceptions.raise_compiler_error(\"Can't calculate secondary metric at \" ~ calculation_grain ~\"-level when metric is at \" ~ metric_grain ~ \"-level\") %}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.get_grain_order"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6100528}, "macro.metrics.get_grain_order": {"unique_id": "macro.metrics.get_grain_order", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_grain_order.sql", "original_file_path": "macros\\secondary_calculations\\validate_grain_order.sql", "name": "get_grain_order", "macro_sql": "{% macro get_grain_order() %}\n    {{ return(adapter.dispatch('get_grain_order', 'metrics')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.metrics.default__get_grain_order"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6100528}, "macro.metrics.default__get_grain_order": {"unique_id": "macro.metrics.default__get_grain_order", "package_name": "metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\metrics", "path": "macros\\secondary_calculations\\validate_grain_order.sql", "original_file_path": "macros\\secondary_calculations\\validate_grain_order.sql", "name": "default__get_grain_order", "macro_sql": "{% macro default__get_grain_order() %}\n    {% do return (['day', 'week', 'month', 'quarter', 'year']) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1657023778.6100528}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "C:\\Users\\Aryan Verma\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\dbt\\include\\global_project", "path": "overview.md", "original_file_path": "docs\\overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}, "intercom_source._fivetran_synced": {"unique_id": "intercom_source._fivetran_synced", "package_name": "intercom_source", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics\\dbt_packages\\intercom_source", "path": "docs.md", "original_file_path": "models\\docs.md", "name": "_fivetran_synced", "block_contents": "The time when a record was last updated by Fivetran."}}, "exposures": {}, "metrics": {"metric.intercom_metrics.intercom__monthly_ticket_volume": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_ticket_volume"], "unique_id": "metric.intercom_metrics.intercom__monthly_ticket_volume", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_ticket_volume", "description": "Number of intercom tickets generated monthly", "label": "Intercom Monthly Ticket Volume", "type": "count_distinct", "sql": "conversation_id", "timestamp": "CREATED_AT", "filters": [], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.7880166}, "metric.intercom_metrics.intercom__monthly_closed_tickets": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_closed_tickets"], "unique_id": "metric.intercom_metrics.intercom__monthly_closed_tickets", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_closed_tickets", "description": "Number of tickets closed monthly", "label": "Intercom Monthly Closed Tickets", "type": "count", "sql": "state", "timestamp": "created_at", "filters": [{"field": "state", "operator": "=", "value": "'closed'"}], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8020642}, "metric.intercom_metrics.intercom__monthly_open_tickets": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_open_tickets"], "unique_id": "metric.intercom_metrics.intercom__monthly_open_tickets", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_open_tickets", "description": "Number of monthly open tickets", "label": "Intercom Monthly Open Tickets", "type": "count", "sql": "state", "timestamp": "created_at", "filters": [{"field": "state", "operator": "=", "value": "'open'"}], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8020642}, "metric.intercom_metrics.intercom__monthly_resolution_rate": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_resolution_rate"], "unique_id": "metric.intercom_metrics.intercom__monthly_resolution_rate", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_resolution_rate", "description": "Percentage of tickets closed monthly", "label": "Intercom Monthly Resolution Rate", "type": "average", "sql": "is_conversation_closed", "timestamp": "created_at", "filters": [], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8020642}, "metric.intercom_metrics.intercom__monthly_csat_score": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_csat_score"], "unique_id": "metric.intercom_metrics.intercom__monthly_csat_score", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_csat_score", "description": "Percentage of positive ratings defining customer satisfaction score", "label": "Intercom Monthly CSAT Score", "type": "average", "sql": "is_conversation_rating_positive", "timestamp": "created_at", "filters": [], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8177361}, "metric.intercom_metrics.intercom__monthly_customer_initiated_conversations": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_customer_initiated_conversations"], "unique_id": "metric.intercom_metrics.intercom__monthly_customer_initiated_conversations", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__monthly_customer_initiated_conversations", "description": "Number of conversations customer have initiated monthly", "label": "Intercom Monthly Customer Initiated Conversations", "type": "count_distinct", "sql": "conversation_id", "timestamp": "created_at", "filters": [{"field": "source_delivered_as", "operator": "=", "value": "'customer_initiated'"}], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8177361}, "metric.intercom_metrics.intercom__monthly_average_ticket_volume": {"fqn": ["intercom_metrics", "metrics", "intercom__monthly_average_ticket_volume"], "unique_id": "metric.intercom_metrics.intercom__monthly_average_ticket_volume", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__monthly_ticket_volume')", "name": "intercom__monthly_average_ticket_volume", "description": "Average number of tickets recieved every month", "label": "Intercom Monthly Average Ticket Volume", "type": "average", "sql": "intercom__monthly_ticket_volume", "timestamp": "period", "filters": [], "time_grains": ["year"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__monthly_ticket_volume"]}, "refs": [["intercom__monthly_ticket_volume"]], "created_at": 1657023779.8177361}, "metric.intercom_metrics.intercom__average_resolution_time_in_hours": {"fqn": ["intercom_metrics", "metrics", "intercom__average_resolution_time_in_hours"], "unique_id": "metric.intercom_metrics.intercom__average_resolution_time_in_hours", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__average_resolution_time_in_hours", "description": "Average time taken to resolve ticket monthly", "label": "Intercom Average Resolution Time in Hours", "type": "average", "sql": "reply_time_in_hours", "timestamp": "created_at", "filters": [{"field": "source_delivered_as", "operator": "=", "value": "'customer_initiated'"}, {"field": "state", "operator": "=", "value": "'closed'"}], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8177361}, "metric.intercom_metrics.intercom__average_response_time_in_hours": {"fqn": ["intercom_metrics", "metrics", "intercom__average_response_time_in_hours"], "unique_id": "metric.intercom_metrics.intercom__average_response_time_in_hours", "package_name": "intercom_metrics", "root_path": "C:\\Users\\Aryan Verma\\Documents\\Houseware\\dbt-venv\\dbt_intercom_metrics", "path": "metrics\\metrics.yml", "original_file_path": "models\\metrics\\metrics.yml", "model": "ref('intercom__main_conversations')", "name": "intercom__average_response_time_in_hours", "description": "Average time taken to respond to a ticket every month", "label": "Intercom Average Response Time in Hours", "type": "average", "sql": "reply_time_in_hours", "timestamp": "created_at", "filters": [{"field": "source_delivered_as", "operator": "=", "value": "'customer_initiated'"}], "time_grains": ["month"], "dimensions": [], "resource_type": "metric", "meta": {}, "tags": [], "sources": [], "depends_on": {"macros": [], "nodes": ["model.intercom_metrics.intercom__main_conversations"]}, "refs": [["intercom__main_conversations"]], "created_at": 1657023779.8333743}}, "selectors": {}, "disabled": {}, "parent_map": {"model.intercom_metrics.intercom__main_conversations": ["model.intercom_source.stg_intercom__conversation_history"], "model.intercom_metrics.intercom__average_resolution_time_in_hours": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__average_response_time_in_hours": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_average_ticket_volume": ["model.intercom_metrics.intercom__monthly_ticket_volume", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_closed_tickets": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_csat_score": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_customer_initiated_conversations": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_open_tickets": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_resolution_rate": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_metrics.intercom__monthly_ticket_volume": ["model.intercom_metrics.intercom__main_conversations", "model.metrics.dbt_metrics_default_calendar"], "model.intercom_source.stg_intercom__admin": ["model.intercom_source.stg_intercom__admin_tmp", "model.intercom_source.stg_intercom__admin_tmp"], "model.intercom_source.stg_intercom__company_history": ["model.intercom_source.stg_intercom__company_history_tmp", "model.intercom_source.stg_intercom__company_history_tmp"], "model.intercom_source.stg_intercom__company_tag_history": ["model.intercom_source.stg_intercom__company_tag_history_tmp", "model.intercom_source.stg_intercom__company_tag_history_tmp"], "model.intercom_source.stg_intercom__contact_company_history": ["model.intercom_source.stg_intercom__contact_company_history_tmp", "model.intercom_source.stg_intercom__contact_company_history_tmp"], "model.intercom_source.stg_intercom__contact_history": ["model.intercom_source.stg_intercom__contact_history_tmp", "model.intercom_source.stg_intercom__contact_history_tmp"], "model.intercom_source.stg_intercom__contact_tag_history": ["model.intercom_source.stg_intercom__contact_tag_history_tmp", "model.intercom_source.stg_intercom__contact_tag_history_tmp"], "model.intercom_source.stg_intercom__conversation_contact_history": ["model.intercom_source.stg_intercom__conversation_contact_history_tmp", "model.intercom_source.stg_intercom__conversation_contact_history_tmp"], "model.intercom_source.stg_intercom__conversation_history": ["model.intercom_source.stg_intercom__conversation_history_tmp", "model.intercom_source.stg_intercom__conversation_history_tmp"], "model.intercom_source.stg_intercom__conversation_part_history": ["model.intercom_source.stg_intercom__conversation_part_history_tmp", "model.intercom_source.stg_intercom__conversation_part_history_tmp"], "model.intercom_source.stg_intercom__conversation_tag_history": ["model.intercom_source.stg_intercom__conversation_tag_history_tmp", "model.intercom_source.stg_intercom__conversation_tag_history_tmp"], "model.intercom_source.stg_intercom__tag": ["model.intercom_source.stg_intercom__tag_tmp", "model.intercom_source.stg_intercom__tag_tmp"], "model.intercom_source.stg_intercom__team": ["model.intercom_source.stg_intercom__team_tmp", "model.intercom_source.stg_intercom__team_tmp"], "model.intercom_source.stg_intercom__team_admin": ["model.intercom_source.stg_intercom__team_admin_tmp", "model.intercom_source.stg_intercom__team_admin_tmp"], "model.intercom_source.stg_intercom__admin_tmp": ["source.intercom_source.intercom.admin"], "model.intercom_source.stg_intercom__company_history_tmp": ["source.intercom_source.intercom.company_history"], "model.intercom_source.stg_intercom__company_tag_history_tmp": ["source.intercom_source.intercom.company_tag_history"], "model.intercom_source.stg_intercom__contact_company_history_tmp": ["source.intercom_source.intercom.contact_company_history"], "model.intercom_source.stg_intercom__contact_history_tmp": ["source.intercom_source.intercom.contact_history"], "model.intercom_source.stg_intercom__contact_tag_history_tmp": ["source.intercom_source.intercom.contact_tag_history"], "model.intercom_source.stg_intercom__conversation_contact_history_tmp": ["source.intercom_source.intercom.conversation_contact_history"], "model.intercom_source.stg_intercom__conversation_history_tmp": ["source.intercom_source.intercom.conversation_history"], "model.intercom_source.stg_intercom__conversation_part_history_tmp": ["source.intercom_source.intercom.conversation_part_history"], "model.intercom_source.stg_intercom__conversation_tag_history_tmp": ["source.intercom_source.intercom.conversation_tag_history"], "model.intercom_source.stg_intercom__tag_tmp": ["source.intercom_source.intercom.tag"], "model.intercom_source.stg_intercom__team_admin_tmp": ["source.intercom_source.intercom.team_admin"], "model.intercom_source.stg_intercom__team_tmp": ["source.intercom_source.intercom.team"], "model.metrics.dbt_metrics_default_calendar": [], "test.intercom_source.not_null_stg_intercom__admin_admin_id.8630313ad7": ["model.intercom_source.stg_intercom__admin"], "test.intercom_source.unique_stg_intercom__admin_admin_id.10ac4663c1": ["model.intercom_source.stg_intercom__admin"], "test.intercom_source.not_null_stg_intercom__company_history_company_id.29e68d8641": ["model.intercom_source.stg_intercom__company_history"], "test.intercom_source.unique_stg_intercom__company_history_company_id.5978446e98": ["model.intercom_source.stg_intercom__company_history"], "test.intercom_source.not_null_stg_intercom__company_tag_history_company_id.7ce26b3077": ["model.intercom_source.stg_intercom__company_tag_history"], "test.intercom_source.not_null_stg_intercom__company_tag_history_tag_id.a71b043180": ["model.intercom_source.stg_intercom__company_tag_history"], "test.intercom_source.not_null_stg_intercom__contact_company_history_company_id.ba3e617037": ["model.intercom_source.stg_intercom__contact_company_history"], "test.intercom_source.not_null_stg_intercom__contact_company_history_contact_id.5e389a0d84": ["model.intercom_source.stg_intercom__contact_company_history"], "test.intercom_source.not_null_stg_intercom__contact_history_contact_id.433f831acf": ["model.intercom_source.stg_intercom__contact_history"], "test.intercom_source.not_null_stg_intercom__contact_tag_history_contact_id.80f3693f49": ["model.intercom_source.stg_intercom__contact_tag_history"], "test.intercom_source.not_null_stg_intercom__contact_tag_history_tag_id.24a4c9df63": ["model.intercom_source.stg_intercom__contact_tag_history"], "test.intercom_source.not_null_stg_intercom__conversation_contact_history_contact_id.faa2dd69f0": ["model.intercom_source.stg_intercom__conversation_contact_history"], "test.intercom_source.not_null_stg_intercom__conversation_contact_history_conversation_id.6619b609cf": ["model.intercom_source.stg_intercom__conversation_contact_history"], "test.intercom_source.not_null_stg_intercom__conversation_history_conversation_id.947be5d87e": ["model.intercom_source.stg_intercom__conversation_history"], "test.intercom_source.not_null_stg_intercom__conversation_part_history_conversation_part_id.53df1b68d4": ["model.intercom_source.stg_intercom__conversation_part_history"], "test.intercom_source.not_null_stg_intercom__conversation_tag_history_conversation_id.2b897a1922": ["model.intercom_source.stg_intercom__conversation_tag_history"], "test.intercom_source.not_null_stg_intercom__conversation_tag_history_tag_id.11ffc3e16e": ["model.intercom_source.stg_intercom__conversation_tag_history"], "test.intercom_source.not_null_stg_intercom__team_admin_team_id.11bddbf17b": ["model.intercom_source.stg_intercom__team_admin"], "test.intercom_source.not_null_stg_intercom__team_team_id.f6f47bb6ae": ["model.intercom_source.stg_intercom__team"], "test.intercom_source.unique_stg_intercom__team_team_id.41ec840e13": ["model.intercom_source.stg_intercom__team"], "source.intercom_source.intercom.admin": [], "source.intercom_source.intercom.company_history": [], "source.intercom_source.intercom.company_tag_history": [], "source.intercom_source.intercom.contact_company_history": [], "source.intercom_source.intercom.contact_history": [], "source.intercom_source.intercom.contact_tag_history": [], "source.intercom_source.intercom.conversation_contact_history": [], "source.intercom_source.intercom.conversation_history": [], "source.intercom_source.intercom.conversation_part_history": [], "source.intercom_source.intercom.conversation_tag_history": [], "source.intercom_source.intercom.tag": [], "source.intercom_source.intercom.team_admin": [], "source.intercom_source.intercom.team": [], "metric.intercom_metrics.intercom__monthly_ticket_volume": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_closed_tickets": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_open_tickets": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_resolution_rate": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_csat_score": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_customer_initiated_conversations": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__monthly_average_ticket_volume": ["model.intercom_metrics.intercom__monthly_ticket_volume"], "metric.intercom_metrics.intercom__average_resolution_time_in_hours": ["model.intercom_metrics.intercom__main_conversations"], "metric.intercom_metrics.intercom__average_response_time_in_hours": ["model.intercom_metrics.intercom__main_conversations"]}, "child_map": {"model.intercom_metrics.intercom__main_conversations": ["metric.intercom_metrics.intercom__average_resolution_time_in_hours", "metric.intercom_metrics.intercom__average_response_time_in_hours", "metric.intercom_metrics.intercom__monthly_closed_tickets", "metric.intercom_metrics.intercom__monthly_csat_score", "metric.intercom_metrics.intercom__monthly_customer_initiated_conversations", "metric.intercom_metrics.intercom__monthly_open_tickets", "metric.intercom_metrics.intercom__monthly_resolution_rate", "metric.intercom_metrics.intercom__monthly_ticket_volume", "model.intercom_metrics.intercom__average_resolution_time_in_hours", "model.intercom_metrics.intercom__average_response_time_in_hours", "model.intercom_metrics.intercom__monthly_closed_tickets", "model.intercom_metrics.intercom__monthly_csat_score", "model.intercom_metrics.intercom__monthly_customer_initiated_conversations", "model.intercom_metrics.intercom__monthly_open_tickets", "model.intercom_metrics.intercom__monthly_resolution_rate", "model.intercom_metrics.intercom__monthly_ticket_volume"], "model.intercom_metrics.intercom__average_resolution_time_in_hours": [], "model.intercom_metrics.intercom__average_response_time_in_hours": [], "model.intercom_metrics.intercom__monthly_average_ticket_volume": [], "model.intercom_metrics.intercom__monthly_closed_tickets": [], "model.intercom_metrics.intercom__monthly_csat_score": [], "model.intercom_metrics.intercom__monthly_customer_initiated_conversations": [], "model.intercom_metrics.intercom__monthly_open_tickets": [], "model.intercom_metrics.intercom__monthly_resolution_rate": [], "model.intercom_metrics.intercom__monthly_ticket_volume": ["metric.intercom_metrics.intercom__monthly_average_ticket_volume", "model.intercom_metrics.intercom__monthly_average_ticket_volume"], "model.intercom_source.stg_intercom__admin": ["test.intercom_source.not_null_stg_intercom__admin_admin_id.8630313ad7", "test.intercom_source.unique_stg_intercom__admin_admin_id.10ac4663c1"], "model.intercom_source.stg_intercom__company_history": ["test.intercom_source.not_null_stg_intercom__company_history_company_id.29e68d8641", "test.intercom_source.unique_stg_intercom__company_history_company_id.5978446e98"], "model.intercom_source.stg_intercom__company_tag_history": ["test.intercom_source.not_null_stg_intercom__company_tag_history_company_id.7ce26b3077", "test.intercom_source.not_null_stg_intercom__company_tag_history_tag_id.a71b043180"], "model.intercom_source.stg_intercom__contact_company_history": ["test.intercom_source.not_null_stg_intercom__contact_company_history_company_id.ba3e617037", "test.intercom_source.not_null_stg_intercom__contact_company_history_contact_id.5e389a0d84"], "model.intercom_source.stg_intercom__contact_history": ["test.intercom_source.not_null_stg_intercom__contact_history_contact_id.433f831acf"], "model.intercom_source.stg_intercom__contact_tag_history": ["test.intercom_source.not_null_stg_intercom__contact_tag_history_contact_id.80f3693f49", "test.intercom_source.not_null_stg_intercom__contact_tag_history_tag_id.24a4c9df63"], "model.intercom_source.stg_intercom__conversation_contact_history": ["test.intercom_source.not_null_stg_intercom__conversation_contact_history_contact_id.faa2dd69f0", "test.intercom_source.not_null_stg_intercom__conversation_contact_history_conversation_id.6619b609cf"], "model.intercom_source.stg_intercom__conversation_history": ["model.intercom_metrics.intercom__main_conversations", "test.intercom_source.not_null_stg_intercom__conversation_history_conversation_id.947be5d87e"], "model.intercom_source.stg_intercom__conversation_part_history": ["test.intercom_source.not_null_stg_intercom__conversation_part_history_conversation_part_id.53df1b68d4"], "model.intercom_source.stg_intercom__conversation_tag_history": ["test.intercom_source.not_null_stg_intercom__conversation_tag_history_conversation_id.2b897a1922", "test.intercom_source.not_null_stg_intercom__conversation_tag_history_tag_id.11ffc3e16e"], "model.intercom_source.stg_intercom__tag": [], "model.intercom_source.stg_intercom__team": ["test.intercom_source.not_null_stg_intercom__team_team_id.f6f47bb6ae", "test.intercom_source.unique_stg_intercom__team_team_id.41ec840e13"], "model.intercom_source.stg_intercom__team_admin": ["test.intercom_source.not_null_stg_intercom__team_admin_team_id.11bddbf17b"], "model.intercom_source.stg_intercom__admin_tmp": ["model.intercom_source.stg_intercom__admin", "model.intercom_source.stg_intercom__admin"], "model.intercom_source.stg_intercom__company_history_tmp": ["model.intercom_source.stg_intercom__company_history", "model.intercom_source.stg_intercom__company_history"], "model.intercom_source.stg_intercom__company_tag_history_tmp": ["model.intercom_source.stg_intercom__company_tag_history", "model.intercom_source.stg_intercom__company_tag_history"], "model.intercom_source.stg_intercom__contact_company_history_tmp": ["model.intercom_source.stg_intercom__contact_company_history", "model.intercom_source.stg_intercom__contact_company_history"], "model.intercom_source.stg_intercom__contact_history_tmp": ["model.intercom_source.stg_intercom__contact_history", "model.intercom_source.stg_intercom__contact_history"], "model.intercom_source.stg_intercom__contact_tag_history_tmp": ["model.intercom_source.stg_intercom__contact_tag_history", "model.intercom_source.stg_intercom__contact_tag_history"], "model.intercom_source.stg_intercom__conversation_contact_history_tmp": ["model.intercom_source.stg_intercom__conversation_contact_history", "model.intercom_source.stg_intercom__conversation_contact_history"], "model.intercom_source.stg_intercom__conversation_history_tmp": ["model.intercom_source.stg_intercom__conversation_history", "model.intercom_source.stg_intercom__conversation_history"], "model.intercom_source.stg_intercom__conversation_part_history_tmp": ["model.intercom_source.stg_intercom__conversation_part_history", "model.intercom_source.stg_intercom__conversation_part_history"], "model.intercom_source.stg_intercom__conversation_tag_history_tmp": ["model.intercom_source.stg_intercom__conversation_tag_history", "model.intercom_source.stg_intercom__conversation_tag_history"], "model.intercom_source.stg_intercom__tag_tmp": ["model.intercom_source.stg_intercom__tag", "model.intercom_source.stg_intercom__tag"], "model.intercom_source.stg_intercom__team_admin_tmp": ["model.intercom_source.stg_intercom__team_admin", "model.intercom_source.stg_intercom__team_admin"], "model.intercom_source.stg_intercom__team_tmp": ["model.intercom_source.stg_intercom__team", "model.intercom_source.stg_intercom__team"], "model.metrics.dbt_metrics_default_calendar": ["model.intercom_metrics.intercom__average_resolution_time_in_hours", "model.intercom_metrics.intercom__average_response_time_in_hours", "model.intercom_metrics.intercom__monthly_average_ticket_volume", "model.intercom_metrics.intercom__monthly_closed_tickets", "model.intercom_metrics.intercom__monthly_csat_score", "model.intercom_metrics.intercom__monthly_customer_initiated_conversations", "model.intercom_metrics.intercom__monthly_open_tickets", "model.intercom_metrics.intercom__monthly_resolution_rate", "model.intercom_metrics.intercom__monthly_ticket_volume"], "test.intercom_source.not_null_stg_intercom__admin_admin_id.8630313ad7": [], "test.intercom_source.unique_stg_intercom__admin_admin_id.10ac4663c1": [], "test.intercom_source.not_null_stg_intercom__company_history_company_id.29e68d8641": [], "test.intercom_source.unique_stg_intercom__company_history_company_id.5978446e98": [], "test.intercom_source.not_null_stg_intercom__company_tag_history_company_id.7ce26b3077": [], "test.intercom_source.not_null_stg_intercom__company_tag_history_tag_id.a71b043180": [], "test.intercom_source.not_null_stg_intercom__contact_company_history_company_id.ba3e617037": [], "test.intercom_source.not_null_stg_intercom__contact_company_history_contact_id.5e389a0d84": [], "test.intercom_source.not_null_stg_intercom__contact_history_contact_id.433f831acf": [], "test.intercom_source.not_null_stg_intercom__contact_tag_history_contact_id.80f3693f49": [], "test.intercom_source.not_null_stg_intercom__contact_tag_history_tag_id.24a4c9df63": [], "test.intercom_source.not_null_stg_intercom__conversation_contact_history_contact_id.faa2dd69f0": [], "test.intercom_source.not_null_stg_intercom__conversation_contact_history_conversation_id.6619b609cf": [], "test.intercom_source.not_null_stg_intercom__conversation_history_conversation_id.947be5d87e": [], "test.intercom_source.not_null_stg_intercom__conversation_part_history_conversation_part_id.53df1b68d4": [], "test.intercom_source.not_null_stg_intercom__conversation_tag_history_conversation_id.2b897a1922": [], "test.intercom_source.not_null_stg_intercom__conversation_tag_history_tag_id.11ffc3e16e": [], "test.intercom_source.not_null_stg_intercom__team_admin_team_id.11bddbf17b": [], "test.intercom_source.not_null_stg_intercom__team_team_id.f6f47bb6ae": [], "test.intercom_source.unique_stg_intercom__team_team_id.41ec840e13": [], "source.intercom_source.intercom.admin": ["model.intercom_source.stg_intercom__admin_tmp"], "source.intercom_source.intercom.company_history": ["model.intercom_source.stg_intercom__company_history_tmp"], "source.intercom_source.intercom.company_tag_history": ["model.intercom_source.stg_intercom__company_tag_history_tmp"], "source.intercom_source.intercom.contact_company_history": ["model.intercom_source.stg_intercom__contact_company_history_tmp"], "source.intercom_source.intercom.contact_history": ["model.intercom_source.stg_intercom__contact_history_tmp"], "source.intercom_source.intercom.contact_tag_history": ["model.intercom_source.stg_intercom__contact_tag_history_tmp"], "source.intercom_source.intercom.conversation_contact_history": ["model.intercom_source.stg_intercom__conversation_contact_history_tmp"], "source.intercom_source.intercom.conversation_history": ["model.intercom_source.stg_intercom__conversation_history_tmp"], "source.intercom_source.intercom.conversation_part_history": ["model.intercom_source.stg_intercom__conversation_part_history_tmp"], "source.intercom_source.intercom.conversation_tag_history": ["model.intercom_source.stg_intercom__conversation_tag_history_tmp"], "source.intercom_source.intercom.tag": ["model.intercom_source.stg_intercom__tag_tmp"], "source.intercom_source.intercom.team_admin": ["model.intercom_source.stg_intercom__team_admin_tmp"], "source.intercom_source.intercom.team": ["model.intercom_source.stg_intercom__team_tmp"], "metric.intercom_metrics.intercom__monthly_ticket_volume": [], "metric.intercom_metrics.intercom__monthly_closed_tickets": [], "metric.intercom_metrics.intercom__monthly_open_tickets": [], "metric.intercom_metrics.intercom__monthly_resolution_rate": [], "metric.intercom_metrics.intercom__monthly_csat_score": [], "metric.intercom_metrics.intercom__monthly_customer_initiated_conversations": [], "metric.intercom_metrics.intercom__monthly_average_ticket_volume": [], "metric.intercom_metrics.intercom__average_resolution_time_in_hours": [], "metric.intercom_metrics.intercom__average_response_time_in_hours": []}}